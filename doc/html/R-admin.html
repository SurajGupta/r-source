<html lang="en">
<head>
<title>R Installation and Administration</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="description" content="R Installation and Administration">
<meta name="generator" content="makeinfo 4.11">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
body {margin-left: 5%; margin-right: 5%;}

H1{             background: white;
                color: rgb(25%, 25%, 25%);
                font-family: monospace;
                font-size: xx-large;
                text-align: center }

H2{             background: white;
                color: rgb(40%, 40%, 40%);
                font-family: monospace;
                font-size: x-large;
                text-align: center }

H3{             background: white;
                color: rgb(40%, 40%, 40%);
                font-family: monospace;
                font-size: large }

H4{             background: white;
                color: rgb(40%, 40%, 40%);
                font-family: monospace }

span.samp{font-family: monospace}
span.command{font-family: monospace}
span.option{font-family: monospace}
span.file{font-family: monospace}
span.env{font-family: monospace}
--></style>
</head>
<body>
<h1 class="settitle">R Installation and Administration</h1>
   <div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">R Installation and Administration</a>
<li><a name="toc_Obtaining-R" href="#Obtaining-R">1 Obtaining R</a>
<ul>
<li><a href="#Getting-and-unpacking-the-sources">1.1 Getting and unpacking the sources</a>
<li><a href="#Getting-patched-and-development-versions">1.2 Getting patched and development versions</a>
<ul>
<li><a href="#Using-Subversion-and-rsync">1.2.1 Using Subversion and rsync</a>
</li></ul>
</li></ul>
<li><a name="toc_Installing-R-under-Unix_002dalikes" href="#Installing-R-under-Unix_002dalikes">2 Installing R under Unix-alikes</a>
<ul>
<li><a href="#Simple-compilation">2.1 Simple compilation</a>
<li><a href="#Making-the-manuals">2.2 Making the manuals</a>
<li><a href="#Installation">2.3 Installation</a>
<li><a href="#Uninstallation">2.4 Uninstallation</a>
<li><a href="#Sub_002darchitectures">2.5 Sub-architectures</a>
<ul>
<li><a href="#Multilib">2.5.1 Multilib</a>
</li></ul>
<li><a href="#Testing-a-Unix-Installation">2.6 Testing an Installation</a>
</li></ul>
<li><a name="toc_Installing-R-under-Windows" href="#Installing-R-under-Windows">3 Installing R under Windows</a>
<ul>
<li><a href="#Building-from-source">3.1 Building from source</a>
<ul>
<li><a href="#Getting-the-tools">3.1.1 Getting the tools</a>
<li><a href="#Getting-the-source-files">3.1.2 Getting the source files</a>
<li><a href="#Building-the-core-files">3.1.3 Building the core files</a>
<li><a href="#Building-the-bitmap-files">3.1.4 Building the bitmap files</a>
<li><a href="#Checking-the-build">3.1.5 Checking the build</a>
<li><a href="#Building-the-manuals">3.1.6 Building the manuals</a>
<li><a href="#Building-the-Inno-Setup-installer">3.1.7 Building the Inno Setup installer</a>
<li><a href="#Building-the-MSI-installer">3.1.8 Building the MSI installer</a>
<li><a href="#Cross_002dbuilding-on-Linux">3.1.9 Cross-building on Linux</a>
</li></ul>
<li><a href="#Testing-a-Windows-Installation">3.2 Testing an Installation</a>
</li></ul>
<li><a name="toc_Installing-R-under-Mac-OS-X" href="#Installing-R-under-Mac-OS-X">4 Installing R under Mac OS X</a>
<ul>
<li><a href="#Building-from-source-on-Mac-OS-X">4.1 Building from source on Mac OS X</a>
</li></ul>
<li><a name="toc_Running-R" href="#Running-R">5 Running R</a>
<li><a name="toc_Add_002don-packages" href="#Add_002don-packages">6 Add-on packages</a>
<ul>
<li><a href="#Default-packages">6.1 Default packages</a>
<li><a href="#Managing-libraries">6.2 Managing libraries</a>
<li><a href="#Installing-packages">6.3 Installing packages</a>
<ul>
<li><a href="#Windows-packages">6.3.1 Windows</a>
<li><a href="#Mac-OS-X-packages">6.3.2 Mac OS X</a>
<li><a href="#Customizing-package-compilation">6.3.3 Customizing package compilation</a>
</li></ul>
<li><a href="#Updating-packages">6.4 Updating packages</a>
<li><a href="#Removing-packages">6.5 Removing packages</a>
<li><a href="#Setting-up-a-package-repository">6.6 Setting up a package repository</a>
</li></ul>
<li><a name="toc_Internationalization" href="#Internationalization">7 Internationalization and Localization</a>
<ul>
<li><a href="#Locales">7.1 Locales</a>
<ul>
<li><a href="#Locales-under-Linux">7.1.1 Locales under Linux</a>
<li><a href="#Locales-under-Windows">7.1.2 Locales under Windows</a>
<li><a href="#Locales-under-Mac-OS-X">7.1.3 Locales under Mac OS X</a>
</li></ul>
<li><a href="#Localization-of-messages">7.2 Localization of messages</a>
</li></ul>
<li><a name="toc_Choosing-between-32_002d-and-64_002dbit-builds" href="#Choosing-between-32_002d-and-64_002dbit-builds">8 Choosing between 32- and 64-bit builds</a>
<ul>
<li><a href="#Windows">8.1 Windows</a>
</li></ul>
<li><a name="toc_The-standalone-Rmath-library" href="#The-standalone-Rmath-library">9 The standalone Rmath library</a>
<ul>
<li><a href="#Unix-standalone">9.1 Unix</a>
<li><a href="#Windows-standalone">9.2 Windows</a>
</li></ul>
<li><a name="toc_Essential-and-useful-other-programs-under-Unix" href="#Essential-and-useful-other-programs-under-Unix">Appendix A Essential and useful other programs under Unix</a>
<ul>
<li><a href="#Essential-programs">A.1 Essential programs</a>
<li><a href="#Useful-libraries-and-programs">A.2 Useful libraries and programs</a>
<ul>
<li><a href="#Tcl_002fTk">A.2.1 Tcl/Tk</a>
<li><a href="#Java-support">A.2.2 Java support</a>
</li></ul>
<li><a href="#Linear-algebra">A.3 Linear algebra</a>
<ul>
<li><a href="#BLAS">A.3.1 BLAS</a>
<ul>
<li><a href="#ATLAS">A.3.1.1 ATLAS</a>
<li><a href="#ACML">A.3.1.2 ACML</a>
<li><a href="#Goto-BLAS">A.3.1.3 Goto BLAS</a>
<li><a href="#MKL">A.3.1.4 Intel MKL</a>
<li><a href="#Shared-BLAS">A.3.1.5 Shared BLAS</a>
</li></ul>
<li><a href="#LAPACK">A.3.2 LAPACK</a>
<li><a href="#Caveats">A.3.3 Caveats</a>
</li></ul>
</li></ul>
<li><a name="toc_Configuration-on-Unix" href="#Configuration-on-Unix">Appendix B Configuration on Unix</a>
<ul>
<li><a href="#Configuration-options">B.1 Configuration options</a>
<li><a href="#Internationalization-support">B.2 Internationalization support</a>
<li><a href="#Configuration-variables">B.3 Configuration variables</a>
<ul>
<li><a href="#Setting-paper-size">B.3.1 Setting paper size</a>
<li><a href="#Setting-the-browser">B.3.2 Setting the browser</a>
<li><a href="#Compilation-flags">B.3.3 Compilation flags</a>
<li><a href="#Making-manuals">B.3.4 Making manuals</a>
</li></ul>
<li><a href="#Setting-the-shell">B.4 Setting the shell</a>
<li><a href="#Using-make">B.5 Using make</a>
<li><a href="#Using-FORTRAN">B.6 Using FORTRAN</a>
<ul>
<li><a href="#Using-gfortran">B.6.1 Using gfortran</a>
</li></ul>
<li><a href="#Compile-and-load-flags">B.7 Compile and load flags</a>
</li></ul>
<li><a name="toc_Platform-notes" href="#Platform-notes">Appendix C Platform notes</a>
<ul>
<li><a href="#X11-issues">C.1 X11 issues</a>
<li><a href="#Linux">C.2 Linux</a>
<ul>
<li><a href="#Intel-compilers">C.2.1 Intel compilers</a>
<li><a href="#PGI-compilers">C.2.2 PGI compilers</a>
<li><a href="#SunStudio-compilers">C.2.3 SunStudio compilers</a>
</li></ul>
<li><a href="#Mac-OS-X">C.3 Mac OS X</a>
<ul>
<li><a href="#64_002dbit-builds">C.3.1 64-bit builds</a>
</li></ul>
<li><a href="#Solaris">C.4 Solaris</a>
<ul>
<li><a href="#Solaris-10-and-Open-Solaris">C.4.1 Solaris 10 and Open Solaris</a>
<li><a href="#Sparc-Solaris-9-and-earlier">C.4.2 Sparc Solaris 9 and earlier</a>
</li></ul>
<li><a href="#HP_002dUX">C.5 HP-UX</a>
<li><a href="#IRIX">C.6 IRIX</a>
<li><a href="#Alpha_002fOSF1">C.7 Alpha/OSF1</a>
<li><a href="#Alpha_002fFreeBSD">C.8 Alpha/FreeBSD</a>
<li><a href="#AIX">C.9 AIX</a>
<li><a href="#Cygwin">C.10 Cygwin</a>
<li><a href="#New-platforms">C.11 New platforms</a>
</li></ul>
<li><a name="toc_Enabling-search-in-HTML-help" href="#Enabling-search-in-HTML-help">Appendix D Enabling search in <acronym>HTML</acronym> help</a>
<ul>
<li><a href="#Java-Virtual-Machines-on-Linux">D.1 Java Virtual Machines on Linux</a>
<li><a href="#Java-Virtual-Machines-on-Unix">D.2 Java Virtual Machines on Unix</a>
<li><a href="#Java-Virtual-Machines-on-Windows">D.3 Java Virtual Machines on Windows</a>
<li><a href="#Java-Virtual-Machines-on-Mac-OS-X">D.4 Java Virtual Machines on Mac OS X</a>
</li></ul>
<li><a name="toc_The-Windows-toolset" href="#The-Windows-toolset">Appendix E The Windows toolset</a>
<ul>
<li><a href="#Perl">E.1 Perl</a>
<li><a href="#The-Microsoft-HTML-Help-Workshop">E.2 The Microsoft <acronym>HTML</acronym> Help Workshop</a>
<li><a href="#LaTeX">E.3 LaTeX</a>
<li><a href="#The-Inno-Setup-installer">E.4 The Inno Setup installer</a>
<li><a href="#The-command-line-tools">E.5 The command line tools</a>
<li><a href="#The-MinGW-compilers">E.6 The MinGW compilers</a>
</li></ul>
<li><a name="toc_Function-and-variable-index" href="#Function-and-variable-index">Function and variable index</a>
<li><a name="toc_Concept-index" href="#Concept-index">Concept index</a>
<li><a name="toc_Environment-variable-index" href="#Environment-variable-index">Environment variable index</a>
</li></ul>
</div>



<!-- @end ifnothtml -->
<p><a name="Top"></a>

<h2 class="unnumbered">R Installation and Administration</h2>

<p>This is a guide to installation and administration for R.

   <p>The current version of this document is 2.9.1 (2009-06-26).

   <p>ISBN 3-900051-09-7

<p><a name="Obtaining-R"></a>

<h2 class="chapter">1 Obtaining R</h2>

<p><a name="index-Obtaining-R-1"></a>
Sources, binaries and documentation for R can be obtained via
<acronym>CRAN</acronym>, the &ldquo;Comprehensive R Archive Network&rdquo; whose current
members are listed at <a href="http://cran.r-project.org/mirrors.html">http://cran.r-project.org/mirrors.html</a>.

<p><a name="Getting-and-unpacking-the-sources"></a>

<h3 class="section">1.1 Getting and unpacking the sources</h3>

<p><a name="index-Sources-for-R-2"></a>
The simplest way is to download the most recent
<samp><span class="file">R-</span><var>x</var><span class="file">.</span><var>y</var><span class="file">.</span><var>z</var><span class="file">.tar.gz</span></samp> file, and unpack it with

<pre class="example">     tar xvfz R-<var>x</var>.<var>y</var>.<var>z</var>.tar.gz
</pre>
   <p class="noindent">on systems that have <acronym>GNU</acronym> <samp><span class="command">tar</span></samp> installed.  On other
systems you need at least to have the <samp><span class="command">gzip</span></samp> program installed. 
Then you can use

<pre class="example">     gzip -dc R-<var>x</var>.<var>y</var>.<var>z</var>.tar.gz | tar xvf -
</pre>
   <p>The pathname of the directory into which the sources are unpacked should
not contain spaces, as <samp><span class="command">make</span></samp> (specifically <acronym>GNU</acronym>
<samp><span class="command">make</span></samp> 3.81) does not expect spaces.

   <p>If you want the build to be usable by a group of users, set <code>umask</code>
before unpacking so that the files will be readable by the target group
(e.g., <code>umask 022</code> to be usable by all users).  (Keep this
setting of <code>umask</code> whilst building and installing.)

<p><a name="Getting-patched-and-development-versions"></a>

<h3 class="section">1.2 Getting patched and development versions</h3>

<p>A patched version of the current release, &lsquo;<samp><span class="samp">r-patched</span></samp>&rsquo;, and the
current development version, &lsquo;<samp><span class="samp">r-devel</span></samp>&rsquo;, are available as daily
tarballs and via access to the R Subversion repository.  (For the two
weeks prior to the release of a minor (2.x.0) version, &lsquo;<samp><span class="samp">r-patched</span></samp>&rsquo;
will refer to beta/release candidates of the upcoming release, the
patched version of the current release being available only via
Subversion.)

   <p>The tarballs are available from
<a href="ftp://ftp.stat.math.ethz.ch/pub/Software/R/">ftp://ftp.stat.math.ethz.ch/pub/Software/R/</a>.  Download either
<samp><span class="file">R-patched.tar.gz</span></samp> or <samp><span class="file">R-devel.tar.gz</span></samp> (or the <samp><span class="file">.tar.bz2</span></samp>
versions) and unpack as described in the previous section.  They are
built in exactly the same way as distributions of R releases.

<p><a name="Using-Subversion-and-rsync"></a>

<h4 class="subsection">1.2.1 Using Subversion and rsync</h4>

<p><a name="index-Subversion-3"></a>
Sources are also available via <a href="https://svn.R-project.org/R/">https://svn.R-project.org/R/</a>, the
R Subversion repository.  If you have a Subversion client (see
<a href="http://subversion.tigris.org/">http://subversion.tigris.org/</a>), you can check out and update the
current r-devel from <a href="https://svn.r-project.org/R/trunk/">https://svn.r-project.org/R/trunk/</a> and the
current r-patched from
&lsquo;<samp><span class="samp">https://svn.r-project.org/R/branches/R-</span><var>x</var><span class="samp">-</span><var>y</var><span class="samp">-branch/</span></samp>&rsquo;
(where <var>x</var> and <var>y</var> are the major and minor number of the current
released version of R).  E.g., use

<pre class="example">     svn checkout https://svn.r-project.org/R/trunk/ <var>path</var>
</pre>
   <p class="noindent">to check out &lsquo;<samp><span class="samp">r-devel</span></samp>&rsquo; into directory <var>path</var>.  The alpha, beta
and RC versions of an upcoming <var>x.y.0</var> release are available from
&lsquo;<samp><span class="samp">https://svn.r-project.org/R/branches/R-</span><var>x</var><span class="samp">-</span><var>y</var><span class="samp">-branch/</span></samp>&rsquo; in
the four-week period prior to the release.

   <p>Note that &lsquo;<samp><span class="samp">https:</span></samp>&rsquo; is required, and that the SSL certificate for
the Subversion server of the R project is

<pre class="example">     Certificate information:
      - Hostname: svn.r-project.org
      - Valid: from Jul 16 08:10:01 2004 GMT until Jul 14 08:10:01 2014 GMT
      - Issuer: Department of Mathematics, ETH Zurich, Zurich, Switzerland, CH
      - Fingerprint: c9:5d:eb:f9:f2:56:d1:04:ba:44:61:f8:64:6b:d9:33:3f:93:6e:ad
</pre>
   <p class="noindent">(currently, there is no &ldquo;trusted certificate&rdquo;).  You can accept this
certificate permanently and will not be asked about it anymore.

   <p>Note that retrieving the sources by e.g. <samp><span class="command">wget -r</span></samp> or
<samp><span class="command">svn export</span></samp> from that URL will not work: the Subversion
information is needed to build R.

   <p>The Subversion repository does not contain the current sources for the
recommended packages, which can be obtained by <samp><span class="command">rsync</span></samp> or
downloaded from <acronym>CRAN</acronym>.  To use <code>rsync</code> to install the
appropriate sources for the recommended packages, run
<code>./tools/rsync-recommended</code> from the top-level of the R sources.

   <p>If downloading manually from <acronym>CRAN</acronym>, do ensure that you have the
correct versions of the recommended packages: if the number in the file
<samp><span class="file">VERSION</span></samp> is &lsquo;<samp><var>x</var><span class="samp">.</span><var>y</var><span class="samp">.</span><var>z</var></samp>&rsquo; you need to download
the contents of &lsquo;<samp><span class="samp">http://CRAN.R-project.org/src/contrib/</span><var>dir</var></samp>&rsquo;,
where <var>dir</var> is &lsquo;<samp><var>x</var><span class="samp">.</span><var>y</var><span class="samp">.</span><var>z</var><span class="samp">/Recommended</span></samp>&rsquo; for
r-devel or <samp><var>x</var><span class="file">.</span><var>y</var><span class="file">-patched/Recommended</span></samp> for r-patched,
respectively, to directory <samp><span class="file">src/library/Recommended</span></samp> in the sources
you have unpacked.  After downloading manually you need to execute
<samp><span class="command">tools/link-recommended</span></samp> from the top level of the sources to
make the requisite links in <samp><span class="file">src/library/Recommended</span></samp>.  A suitable
incantation from the top level of the R sources using <samp><span class="command">wget</span></samp>
might be

<pre class="example">     wget -r -l1 --no-parent -A\*.gz -nd -P src/library/Recommended \
       http://CRAN.R-project.org/src/contrib/<var>dir</var>
     ./tools/link-recommended
</pre>
   <p><a name="Installing-R-under-Unix-alikes"></a>
<a name="Installing-R-under-Unix_002dalikes"></a>

<h2 class="chapter">2 Installing R under Unix-alikes</h2>

<p><a name="index-Installing-under-Unix_002dalikes-4"></a>
R will configure and build under a number of common Unix and
Unix-alike platforms including &lsquo;<samp><var>cpu</var><span class="samp">-*-linux-gnu</span></samp>&rsquo; for the
&lsquo;<samp><span class="samp">alpha</span></samp>&rsquo;, &lsquo;<samp><span class="samp">arm</span></samp>&rsquo;, &lsquo;<samp><span class="samp">hppa</span></samp>&rsquo;, &lsquo;<samp><span class="samp">ix86</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">ia64</span></samp>&rsquo;, &lsquo;<samp><span class="samp">m68k</span></samp>&rsquo;, &lsquo;<samp><span class="samp">mips</span></samp>&rsquo;, &lsquo;<samp><span class="samp">mipsel</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">powerpc</span></samp>&rsquo;, &lsquo;<samp><span class="samp">s390</span></samp>&rsquo;, &lsquo;<samp><span class="samp">sparc</span></samp>&rsquo;, and &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo;
CPUs,
<!-- (see e.g.@:  @uref{http://buildd.debian.org/build.php?&pkg=r-base}), -->
<!-- Actually, see http://packages.debian.org/unstable/math/r-base-core as -->
<!-- the build daemon is not used for all platforms; note also that Debian -->
<!-- has x86_64 <=> amd, ix86 <=> i386. -->
&lsquo;<samp><span class="samp">powerpc-apple-darwin</span></samp>&rsquo;, &lsquo;<samp><span class="samp">i386-apple-darwin</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">x86_64-apple-darwin</span></samp>&rsquo;, &lsquo;<samp><span class="samp">x86_64-sun-solaris</span></samp>&rsquo;, and
&lsquo;<samp><span class="samp">powerpc-ibm-aix6*</span></samp>&rsquo; as well as probably (it is tested less
frequently on these platforms) &lsquo;<samp><span class="samp">i386-*-freebsd</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">x86_64-*-freebsd</span></samp>&rsquo;, &lsquo;<samp><span class="samp">i386-*-netbsd</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">i386-*-openbsd</span></samp>&rsquo;, &lsquo;<samp><span class="samp">i386-sun-solaris</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">sparc-sun-solaris</span></samp>&rsquo;, &lsquo;<samp><span class="samp">mips-sgi-irix</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">alpha-dec-osf*</span></samp>&rsquo;.

   <p><a name="index-Linux-5"></a><a name="index-Mac-OS-X-6"></a>In addition, binary distributions are available for some common Linux
distributions and for Mac OS X.  See the <acronym>FAQ</acronym> for current
details.  These are installed in platform-specific ways, so for the rest
of this chapter we consider only building from the sources.

<p><a name="Simple-compilation"></a>

<h3 class="section">2.1 Simple compilation</h3>

<p>First review the essential and useful tools and libraries in
<a href="#Essential-and-useful-other-programs-under-Unix">Essential and useful other programs under Unix</a>, and install those you
<a name="index-TMPDIR-7"></a>want or need.  Ensure that the environment variable <samp><span class="env">TMPDIR</span></samp> is
either unset (and <samp><span class="file">/tmp</span></samp> exists and can be written in and executed
from) or points to a valid temporary directory.

   <p><a name="index-R_005fHOME-8"></a>Choose a place to install the R tree (R is not just a binary, but
has additional data sets, help files, font metrics etc).  Let us call
this place <var>R_HOME</var>.  Untar the source code.  This should create
directories <samp><span class="file">src</span></samp>, <samp><span class="file">doc</span></samp>, and several more.  (At this point
North American readers should consult <a href="#Setting-paper-size">Setting paper size</a>.)  Issue
the following commands:

   <p><a name="index-configure-9"></a>
<pre class="example">     ./configure
     make
</pre>
   <p class="noindent">(See <a href="#Using-make">Using make</a> if your make is not called &lsquo;<samp><span class="samp">make</span></samp>&rsquo;.)

   <p>Then check the built system works correctly by

<pre class="example">     make check
</pre>
   <p class="noindent">Failures are not necessarily problems as they might be caused by missing
functionality,<a rel="footnote" href="#fn-1" name="fnd-1"><sup>1</sup></a> but you
should look carefully at any reported discrepancies.  (Some non-fatal
errors are expected in locales that do not support Latin-1, in
particular in true <code>C</code> locales and non-UTF-8 non-European locales.) 
A failure in <samp><span class="file">tests/ok-errors.R</span></samp> may indicate inadequate resource
limits (see <a href="#Running-R">Running R</a>).

   <p>More comprehensive testing can be done by

<pre class="example">     make check-devel
</pre>
   <p class="noindent">or

<pre class="example">     make check-all
</pre>
   <p class="noindent">see <samp><span class="file">tests/README</span></samp>.

   <p>If the command <samp><span class="command">configure</span></samp> and <samp><span class="command">make</span></samp> commands execute
successfully, the R binary will be copied to
<samp><var>R_HOME</var><span class="file">/bin/exec/R</span></samp>.  In addition, a shell-script front-end
called <samp><span class="file">R</span></samp> will be created and copied to <samp><var>R_HOME</var><span class="file">/bin</span></samp>. 
You can copy this script to a place where users can invoke it, for
example to <samp><span class="file">/usr/local/bin/R</span></samp>.  You could also copy the man page
<samp><span class="file">R.1</span></samp> to a place where your <samp><span class="command">man</span></samp> reader finds it, such as
<samp><span class="file">/usr/local/man/man1</span></samp>.  If you want to install the complete R
tree to, e.g., <samp><span class="file">/usr/local/lib/R</span></samp>, see <a href="#Installation">Installation</a>.  Note:
you do not <em>need</em> to install R: you can run it from where it was
built.

   <p>You do not necessarily have to build R in the top-level source
directory (say, <samp><var>TOP_SRCDIR</var></samp>).  To build in
<samp><var>BUILDDIR</var></samp>, run

   <p><a name="index-configure-10"></a>
<pre class="example">     cd <var>BUILDDIR</var>
     <var>TOP_SRCDIR</var>/configure
     make
</pre>
   <p class="noindent">and so on, as described further below.  This has the advantage of
always keeping your source tree &ldquo;clean&rdquo; and is particularly
recommended when you work with a version of R from Subversion. 
(You may need <acronym>GNU</acronym> <samp><span class="command">make</span></samp> to allow this, and the
pathname of the build directory should not contain spaces.)

   <p><a name="index-Help-pages-11"></a>Make will also build plain text help pages as well as <acronym>HTML</acronym> and
LaTeX versions of the R object documentation (the three kinds can
also be generated separately using <code>make help</code>, <code>make html</code>
and <code>make latex</code>).

   <p>For those obtaining R <em>via</em> Subversion, one additional step is
necessary:
<a name="index-Vignettes-12"></a><a name="index-Subversion-13"></a>
<pre class="example">     make vignettes
</pre>
   <p class="noindent">which makes the <strong>grid</strong> vignettes (which are contained in the
tarballs):  it takes several minutes.

   <p>Now <code>rehash</code> if necessary, type <kbd>R</kbd>, and read the R manuals
and the R <acronym>FAQ</acronym> (files <samp><span class="file">FAQ</span></samp> or
<samp><span class="file">doc/manual/R-FAQ.html</span></samp>, or
<a href="http://CRAN.R-project.org/doc/FAQ/R-FAQ.html">http://CRAN.R-project.org/doc/FAQ/R-FAQ.html</a> which always
has the latest version).

<p><a name="Making-the-manuals"></a>

<h3 class="section">2.2 Making the manuals</h3>

<p><a name="index-Manuals-14"></a>
There is a set of manuals that can be built from the sources,

     <dl>
<dt>&lsquo;<samp><span class="samp">refman</span></samp>&rsquo;<dd>Printed versions of the help pages for the most commonly used packages. 
<br><dt>&lsquo;<samp><span class="samp">fullrefman</span></samp>&rsquo;<dd>Printed versions of all the help pages. 
<br><dt>&lsquo;<samp><span class="samp">R-FAQ</span></samp>&rsquo;<dd>R <acronym>FAQ</acronym>
<br><dt>&lsquo;<samp><span class="samp">R-intro</span></samp>&rsquo;<dd>&ldquo;An Introduction to R&rdquo;. 
<br><dt>&lsquo;<samp><span class="samp">R-data</span></samp>&rsquo;<dd>&ldquo;R Data Import/Export&rdquo;. 
<br><dt>&lsquo;<samp><span class="samp">R-admin</span></samp>&rsquo;<dd>&ldquo;R Installation and Administration&rdquo;, this manual. 
<br><dt>&lsquo;<samp><span class="samp">R-exts</span></samp>&rsquo;<dd>&ldquo;Writing R Extensions&rdquo;. 
<br><dt>&lsquo;<samp><span class="samp">R-lang</span></samp>&rsquo;<dd>&ldquo;The R Language Definition&rdquo;. 
</dl>

<p class="noindent">To make these (except &lsquo;<samp><span class="samp">fullrefman</span></samp>&rsquo;), use

<pre class="example">     make dvi      <span class="roman">to create DVI versions</span>
     make pdf      <span class="roman">to create PDF versions</span>
     make info     <span class="roman">to create info files (not &lsquo;</span><samp><span class="samp">refman</span></samp><span class="roman">&rsquo;).</span>
</pre>
   <p>You will not be able to build any of these unless you have
<samp><span class="command">makeinfo</span></samp> version 4.7 or later installed, and for DVI or PDF
you must have <samp><span class="command">texi2dvi</span></samp> and <samp><span class="file">texinfo.tex</span></samp> installed (which
are part of the GNU <strong>texinfo</strong> distribution but are, especially
<samp><span class="file">texinfo.tex</span></samp>, often made part of the TeX package in
re-distributions).

   <p>The DVI versions can be previewed and printed using standard programs
such as <samp><span class="command">xdvi</span></samp> and <samp><span class="command">dvips</span></samp>.  The PDF versions can be
viewed using any recent PDF viewer: they have hyperlinks that can be
followed.  The info files are suitable for reading online with Emacs or
the standalone <acronym>GNU</acronym> Info.  The DVI and PDF versions will be
created using the papersize selected at configuration (default ISO a4):
this can be overridden by setting <samp><span class="env">R_PAPERSIZE</span></samp>
<a name="index-R_005fPAPERSIZE-15"></a>on the <samp><span class="command">make</span></samp> command line, or setting <samp><span class="env">R_PAPERSIZE</span></samp> in the
environment and using <samp><span class="command">make -e</span></samp>.  (If re-making the manuals for
a different papersize, you should first delete the file
<samp><span class="file">doc/manual/version.texi</span></samp>.)

   <p>There are some issues with making the reference manual, and in
particular with the PDF version <samp><span class="file">refman.pdf</span></samp>.  The help files
contain both ISO Latin1 characters (e.g. in <samp><span class="file">text.Rd</span></samp>) and
upright quotes, neither of which are contained in the standard LaTeX
Computer Modern fonts.  We have provided four alternatives:

     <dl>
<dt><code>times</code><dd>(The default for PDF.) Using standard PostScript fonts.  This works
well both for on-screen viewing and for printing. 
The one disadvantage is that the Usage and Examples sections may come
out rather wide.

     <br><dt><code>lm</code><dd>Using the <em>Latin Modern</em> fonts.  These are not often installed as
part of a TeX distribution, but can obtained from
<a href="http://www.ctan.org/tex-archive/fonts/ps-type1/lm/">http://www.ctan.org/tex-archive/fonts/ps-type1/lm/</a> and
mirrors.  This uses fonts rather similar to Computer Modern, but is not
so good on-screen as <code>times</code>.

     <br><dt><code>cm-super</code><dd>Using type-1 versions of the Computer Modern fonts by Vladimir Volovich. 
This is a large installation, obtainable from
<a href="http://www.ctan.org/tex-archive/fonts/ps-type1/cm-super/">http://www.ctan.org/tex-archive/fonts/ps-type1/cm-super/</a>
and its mirrors.  These type-1 fonts have poor hinting and so are
nowhere near so readable on-screen as the other three options.

     <br><dt><code>ae</code><dd>(The default for DVI.)  A package to use composites of Computer Modern
fonts.  This works well most of the time, and its PDF is more readable
on-screen than the previous two options.  There are three fonts for
which it will need to use bitmapped fonts, <samp><span class="file">tctt0900.600pk</span></samp>,
<samp><span class="file">tctt1000.600pk</span></samp> and <samp><span class="file">tcrm1000.600pk</span></samp>.  Unfortunately, if
those files are not available, Acrobat Reader will substitute
completely incorrect glyphs so you need to examine the logs carefully. 
</dl>

   <p>The default can be overridden by setting the environment variables
<a name="index-R_005fRD4DVI-16"></a><a name="index-R_005fRD4PDF-17"></a><samp><span class="env">R_RD4PDF</span></samp> and <samp><span class="env">R_RD4DVI</span></samp>.  (On Unix, these will be picked up
at install time.)  The default value for <samp><span class="env">R_RD4PDF</span></samp> is
&lsquo;<samp><span class="samp">times,hyper</span></samp>&rsquo;: omit &lsquo;<samp><span class="samp">hyper</span></samp>&rsquo; if you do not want hyperlinks,
e.g. for printing.  The default for <samp><span class="env">R_RD4DVI</span></samp> is &lsquo;<samp><span class="samp">ae</span></samp>&rsquo;.

<p><a name="Installation"></a>

<h3 class="section">2.3 Installation</h3>

<p><a name="index-Installation-18"></a>
To ensure that the installed tree is usable by the right group of users,
set <code>umask</code> appropriately (perhaps to &lsquo;<samp><span class="samp">022</span></samp>&rsquo;) before unpacking
the sources and throughout the build process.

   <p>After

   <p><a name="index-configure-19"></a>
<pre class="example">     ./configure
     make
     make check
</pre>
   <p class="noindent">(or, when building outside the source,
<var>TOP_SRCDIR</var><code>/configure</code>, etc) have been completed
successfully, you can install the complete R tree to your system by
typing

<pre class="example">     make install
</pre>
   <p class="noindent">This will install to the following directories:

     <dl>
<dt><samp><var>prefix</var><span class="file">/bin</span></samp> or <samp><var>bindir</var></samp><dd>the front-end shell script and other scripts and executables
<br><dt><samp><var>prefix</var><span class="file">/man/man1</span></samp> or <samp><var>mandir</var><span class="file">/man1</span></samp><dd>the man page
<br><dt><samp><var>prefix</var><span class="file">/</span><var>LIBnn</var><span class="file">/R</span></samp> or <samp><var>libdir</var><span class="file">/R</span></samp><dd>all the rest (libraries, on-line help system, <small class="dots">...</small>).  Here
<var>LIBnn</var> is usually &lsquo;<samp><span class="samp">lib</span></samp>&rsquo;, but may be &lsquo;<samp><span class="samp">lib64</span></samp>&rsquo; on some
64-bit Linux systems.  This is known as the R home directory. 
</dl>

<p class="noindent">where <var>prefix</var> is determined during configuration (typically
<samp><span class="file">/usr/local</span></samp>) and can be set by running <samp><span class="command">configure</span></samp> with
the option <samp><span class="option">--prefix</span></samp>, as in

   <p><a name="index-configure-20"></a>
<pre class="example">     ./configure --prefix=/where/you/want/R/to/go
</pre>
   <p class="noindent">This causes <samp><span class="command">make install</span></samp> to install the R executable to
<samp><span class="file">/where/you/want/R/to/go/bin</span></samp>, and so on.  The prefix of the
installation directories can be seen in the status message that is
displayed at the end of <samp><span class="command">configure</span></samp>.  You can install into
another directory tree by using

<pre class="example">     make prefix=/path/to/here install
</pre>
   <p class="noindent">at least with GNU <samp><span class="command">make</span></samp> (but not e.g. Solaris 8's <samp><span class="command">make</span></samp>).

   <p>More precise control is available at configure time via options: see
<samp><span class="command">configure --help</span></samp> for details.  (However, many of them are
currently unused.)

   <p>Configure options <samp><span class="option">--bindir</span></samp> and <samp><span class="option">--mandir</span></samp> are supported
and govern where a copy of the <samp><span class="command">R</span></samp> script and the <samp><span class="command">man</span></samp>
page are installed.

   <p>The configure option <samp><span class="option">--libdir</span></samp> controls where the main R
files are installed: the default is &lsquo;<samp><var>eprefix</var><span class="samp">/</span><var>LIBnn</var></samp>&rsquo;,
where <var>eprefix</var> is the prefix used for installing
architecture-dependent files, defaults to <var>prefix</var>, and can be set
via the configure option <samp><span class="option">--exec-prefix</span></samp>.

   <p>Each of <code>bindir</code>, <code>mandir</code> and <code>libdir</code> can also be
specified on the <samp><span class="command">make install</span></samp> command line (at least for GNU
<samp><span class="command">make</span></samp>).

   <p>The <samp><span class="command">configure</span></samp> or <samp><span class="command">make</span></samp> variables <code>rdocdir</code> and
<code>rsharedir</code> can be used to install the system-independent
<samp><span class="file">doc</span></samp> and <samp><span class="file">share</span></samp> directories to somewhere other than
<code>libdir</code>.  The C header files can be installed to the value of
<code>rincludedir</code>: note that as the headers are not installed into a
subdirectory you probably want something like
<code>rincludedir=/usr/local/include/R-2.9.1</code>.

   <p>If you want the R home to be something other than
<samp><var>libdir</var><span class="file">/R</span></samp>, use <samp><span class="option">rhome</span></samp>: for example

<pre class="example">     make install rhome=/usr/local/lib64/R-2.6.0
</pre>
   <p class="noindent">will use a version-specific R home on a Linux 64-bit system.

   <p>If you have made R as a shared/dynamic library you can install it in
your system's library directory by

<pre class="example">     make prefix=/path/to/here install-libR
</pre>
   <p class="noindent">where <code>prefix</code> is optional, and <code>libdir</code> will give more
precise control.

<pre class="example">     make install-strip
</pre>
   <p class="noindent">will install stripped executables, and on platforms where this is
supported, stripped libraries in directories <samp><span class="file">lib</span></samp> and
<samp><span class="file">modules</span></samp> and in the standard packages.

   <p><a name="index-Manuals_002c-installing-21"></a>
To install DVI, info and PDF versions of the manuals, use one or more of

<pre class="example">     make install-dvi
     make install-info
     make install-pdf
</pre>
   <p class="noindent">Once again, it is optional to specify <code>prefix</code>, <code>libdir</code> or
<code>rhome</code> (the DVI and PDF manuals are installed under the R home
directory).

   <p>More precise control is possible.  For info, the setting used is that of
<code>infodir</code> (default &lsquo;<samp><var>prefix</var><span class="samp">/info</span></samp>&rsquo;, set by configure
option <samp><span class="option">--infodir</span></samp>).  The DVI and PDF files are installed into
the R <samp><span class="file">doc</span></samp> tree, set by the <samp><span class="command">make</span></samp> variable
<code>rdocdir</code>.

   <p>A staged installation is possible, that it is installing R into a
temporary directory in order to move the installed tree to its final
destination.  In this case <code>prefix</code> (and so on) should reflect the
final destination, and <samp><span class="env">DESTDIR</span></samp> should be used: see
<a href="http://www.gnu.org/prep/standards/html_node/DESTDIR.html">http://www.gnu.org/prep/standards/html_node/DESTDIR.html</a>.

   <p>You can optionally install the run-time tests that are part of
<samp><span class="command">make check-all</span></samp> by

<pre class="example">     make install-tests
</pre>
   <p class="noindent">which populates a <samp><span class="file">tests</span></samp> directory in the installation.

<p><a name="Uninstallation"></a>

<h3 class="section">2.4 Uninstallation</h3>

<p>You can uninstall R by

<pre class="example">     make uninstall
</pre>
   <p class="noindent">specifying <code>prefix</code> etc in the same way as specified for
installation.

   <p>This will also uninstall any installed manuals.  There are specific
targets to uninstall DVI, info and PDF manuals in
<samp><span class="file">doc/manual/Makefile</span></samp>.

   <p>Target <code>uninstall-tests</code> will uninstall any installed tests, as
well as removing the directory <samp><span class="file">tests</span></samp> containing the test results.

<p><a name="Sub-architectures"></a>
<a name="Sub_002darchitectures"></a>

<h3 class="section">2.5 Sub-architectures</h3>

<p>Some platforms can support closely related builds of R which can
share all but the executables and dynamic objects.  Examples include
builds under Solaris for different chips (in particular, 32- and 64-bit
builds), 64- and 32- bit builds on &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Linux and different
CPUs (&lsquo;<samp><span class="samp">ppc</span></samp>&rsquo;, &lsquo;<samp><span class="samp">ppc64</span></samp>&rsquo;, &lsquo;<samp><span class="samp">i386</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo;) under Mac OS &gt;= 10.4.

   <p>R supports the idea of architecture-specific builds, specified by
adding &lsquo;<samp><span class="samp">r_arch=</span><var>name</var></samp>&rsquo; to the <samp><span class="command">configure</span></samp> line.  Here
<var>name</var> can be anything non-empty, and is used to name subdirectories
of <samp><span class="file">lib</span></samp>, <samp><span class="file">etc</span></samp>, <samp><span class="file">include</span></samp> and <samp><span class="file">libs</span></samp>.  Example
names from other systems are the use of <samp><span class="file">sparcv9</span></samp> on Sparc Solaris
and <samp><span class="file">32</span></samp> by <code>gcc</code> on &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Linux.

   <p>If you have two or more such builds you can install them over each other
(and for 32/64-bit builds on one architecture, one build can be done
without &lsquo;<samp><span class="samp">r_arch</span></samp>&rsquo;).  The space savings can be considerable: on
&lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Linux a basic install (without debugging symbols) took
63Mb, and adding a 32-bit build added 6Mb.  If you have installed
multiple builds you can select which build to run by

<pre class="example">     R --arch=<var>name</var>
</pre>
   <p class="noindent">and just running &lsquo;<samp><span class="samp">R</span></samp>&rsquo; will run the last build that was installed.

   <p><code>R CMD INSTALL</code> will detect if more than one build is installed and
try to install packages with the appropriate library objects for each. 
This will not be done if the package has an executable <code>configure</code>
script or a <samp><span class="file">src/Makefile</span></samp> file.  In such cases you can install for
extra builds by

<pre class="example">     R --arch=<var>name</var> CMD INSTALL --libs-only <var>pkg(s)</var>
</pre>
   <p>If you want to mix sub-architectures compiled on different platforms
(for example &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Linux and &lsquo;<samp><span class="samp">i686</span></samp>&rsquo; Linux), it is
wise to use explicit names for each, and you may also need to set
<samp><span class="option">libdir</span></samp> to ensure that they install into the same place.

   <p>When sub-architectures are used the version of <samp><span class="command">Rscript</span></samp> in
e.g. <samp><span class="file">/usr/bin</span></samp> will be the last installed, but
architecture-specific versions will be available in e.g. 
<samp><span class="file">/usr/lib64/R/bin/exec</span><var>R_ARCH</var></samp>.  Normally all installed
architectures will run on the platform so the architecture of
<samp><span class="command">Rscript</span></samp> does not matter.

   <p>When running post-install tests with sub-architectures, use

<pre class="example">     R --arch=<var>name</var> CMD make check[-devel|all]
</pre>
   <p class="noindent">to select a sub-architecture to check.

<p><a name="Multilib"></a>

<h4 class="subsection">2.5.1 Multilib</h4>

<p>On Linux, there is an alternative mechanism for mixing 32-bit and
64-bit libraries known as <em>multilib</em>. If a Linux distribution supports
multilib, then parallel builds of R may be installed in the
sub-directories <samp><span class="file">lib</span></samp> (32-bit) and <samp><span class="file">lib64</span></samp> (64-bit).  The
build to be run may then be chosen using the <samp><span class="command">setarch</span></samp>
command. For example, a 32-bit build may be chosen by

<pre class="example">     setarch i686 R
</pre>
   <p>The <samp><span class="command">setarch</span></samp> command is only operational if both 32-bit and
64-bit builds are installed. If there is only one installation of R,
then this will always be run regardless of the architecture specified
by the <samp><span class="command">setarch</span></samp> command.

   <p>There can be problems with installing packages on the non-native
architecture.  It is a good idea to run e.g. <code>setarch i686 R</code> for
sessions in which packages are to be installed, even if that is the only
version of R installed (since this tells the package installation
code the architecture needed).

   <p>At present there is a potential problem with packages using Java, as
the post-install for a &lsquo;<samp><span class="samp">i386</span></samp>&rsquo; RPM on &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Linux
reconfigures Java and will find the &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Java.  If you know
where a 32-bit Java is installed you may be able to run (as root)

<pre class="example">     export JAVA_HOME=&lt;path to jre directory of 32-bit Java&gt;
     setarch i686 R CMD javareconf
</pre>
   <p class="noindent">to get a suitable setting.

   <p>When this mechanism is used, the version of <samp><span class="command">Rscript</span></samp> in
e.g. <samp><span class="file">/usr/bin</span></samp> will be the last installed, but an
architecture-specific version will be available in
e.g. <samp><span class="file">/usr/lib64/R/bin</span></samp>.  Normally all installed architectures
will run on the platform so the architecture of <samp><span class="command">Rscript</span></samp> does
not matter.

<p><a name="Testing-a-Unix-Installation"></a>

<h3 class="section">2.6 Testing an Installation</h3>

<p>Full testing is possible only if the test files have been installed with

<pre class="example">     make install-tests
</pre>
   <p class="noindent">which populates a <samp><span class="file">tests</span></samp> directory in the installation.

   <p>If this has been done, two testing routes are available. 
The first is to move to the home directory of the R installation
(as given by <code>R.home()</code>) and run

<pre class="example">     cd tests
     ## followed by one of
     ../bin/R CMD make check
     ../bin/R CMD make check-devel
     ../bin/R CMD make check-all
</pre>
   <p class="noindent">and other useful targets are <code>test-BasePackages</code> and
<code>test-Recommended</code> to the run tests of the standard and
recommmended packages (if installed) respectively.

   <p>This re-runs all the tests relevant to the installed R (including for
example code in the package vignettes), but not for example the ones
checking the example code in the manuals nor making the standalone Rmath
library.  This can occasionally be useful when the operating environment
has been changed, for example by OS updates or by substituting the BLAS
(see <a href="#Shared-BLAS">Shared BLAS</a>).

   <p>Alternatively, the installed R can be run, preferably with
<samp><span class="option">--vanilla</span></samp>.  Then

<pre class="example">     library("tools")
     testInstalledBasic("both")
     testInstalledPackages("base")
     testInstallPackages("recommended")
</pre>
   <p class="noindent">runs the basic tests and then all the tests on the standard and
recommended packages.  These tests can be run from anywhere: they write
their results in the <samp><span class="file">tests</span></samp> folder of the R home directory. 
They run slightly fewer tests than the first approach: in particular
they do not test Internet access.

   <p>It is possible to test the installed packages (but not the
package-specific tests) by <code>testInstallPackages</code> even if
<samp><span class="command">make install-tests</span></samp> was not run.

<p><a name="Installing-R-under-Windows"></a>

<h2 class="chapter">3 Installing R under Windows</h2>

<p><a name="index-Installing-under-Windows-22"></a>
The <samp><span class="file">bin/windows</span></samp> directory of a <acronym>CRAN</acronym> site contains
binaries for a base distribution and a large number of add-on packages
from <acronym>CRAN</acronym> to run on Windows 2000 or later on ix86 CPUs
(including AMD64/EM64T chips and Windows x64).

   <p>Your file system must allow long file names (as is likely except
perhaps for some network-mounted systems).

   <p>Installation is <em>via</em> the installer <samp><span class="file">R-2.9.1-win32.exe</span></samp>. 
Just double-click on the icon and follow the instructions.  You can
uninstall R from the Control Panel.  (Note that you will probably
(depending on the Windows language settings) be asked to choose a
language for installation, and that choice applies to both installation
and un-installation but not to running R itself.)

   <p>See the <a href="http://CRAN.R-project.org/bin/windows/base/rw-FAQ.html">R Windows <acronym>FAQ</acronym></a> for more details on the binary installer.

<p><a name="Building-from-source"></a>

<h3 class="section">3.1 Building from source</h3>

<p><a name="Getting-the-tools"></a>

<h4 class="subsection">3.1.1 Getting the tools</h4>

<p>If you want to build R from the sources, you will first need to
collect, install and test an extensive set of tools.  See <a href="#The-Windows-toolset">The Windows toolset</a> (and perhaps updates in
<a href="http://www.murdoch-sutherland.com/Rtools/">http://www.murdoch-sutherland.com/Rtools/</a>) for details.

   <p>The <samp><span class="file">Rtools.exe</span></samp> executable installer described in <a href="#The-Windows-toolset">The Windows toolset</a> also includes some additions to the R source as
noted below. You should run it first, to obtain a working <code>tar</code>
and other necessities.  Choose a &ldquo;Full installation&rdquo;, and install
the extra files into your intended R source directory, e.g. 
<samp><span class="file">C:/R</span></samp>. The directory name <em>should not contain spaces</em>. We
will call this directory <var>R_HOME</var> below.

   <p>To avoid warnings you may need to set the environment variable
<samp><span class="env">CYGWIN</span></samp> to &lsquo;<samp><span class="samp">nodosfilewarning</span></samp>&rsquo;.

<p><a name="Getting-the-source-files"></a>

<h4 class="subsection">3.1.2 Getting the source files</h4>

<p>You need to collect the following sets of files:
     <ul>
<li>Get the R source code <samp><span class="file">R-2.9.1.tar.gz</span></samp> from
<acronym>CRAN</acronym>.  Open a command window (or another shell) at
directory <var>R_HOME</var>, and run

     <pre class="example">          tar zxvf R-2.9.1.tar.gz
</pre>
     <p class="noindent">to create the source tree in <var>R_HOME</var>.  <strong>Beware</strong>: do use
<samp><span class="command">tar</span></samp> to extract the sources rather than tools such as WinZip
that do not understand about symbolic links.

     <p>It is also possible to obtain the source code using Subversion; see
<a href="#Obtaining-R">Obtaining R</a> for details.

     <li>If you are not using a tarball you need to obtain copies of the
recommended packages from <acronym>CRAN</acronym>.  Put the <samp><span class="file">.tar.gz</span></samp> files
in <samp><var>R_HOME</var><span class="file">/src/library/Recommended</span></samp> and run <code>make
link-recommended</code>.  If you have an Internet
connection, you can do this automatically using

     <pre class="example">          make rsync-recommended
</pre>
     <li>Optionally, you can install a version of ATLAS
(<a href="http://math-atlas.sourceforge.net/">http://math-atlas.sourceforge.net/</a>) tuned to your system for
fast linear algebra routines. Pre-built <samp><span class="file">Rblas.dll</span></samp> for various
CPUs are available in the <samp><span class="file">windows/contrib/ATLAS</span></samp> area on
<acronym>CRAN</acronym>.  If you are building R from source, there are macros
<code>USE_ATLAS</code> and <code>ATLAS_PATH</code> in the file <samp><span class="file">MkRules</span></samp>.  Set
<code>USE_ATLAS = YES</code> and <code>ATLAS_PATH</code> to where the ATLAS
libraries are located.  You will need to make the libraries
yourself<a rel="footnote" href="#fn-2" name="fnd-2"><sup>2</sup></a>: none of the binaries we have seen are compiled for the
correct compiler.  Since R has its own &lsquo;<samp><span class="samp">xerbla</span></samp>&rsquo; it is necessary
to delete that in ATLAS by

     <pre class="example">          ar d /path/to/libf77blas.a xerbla.o
</pre>
     <p>There used to be support for AMD's AMD Core Math Library (ACML) and
Kazushige Goto's BLAS, but neither is currently available for use with
the compilers used.

   </ul>

   <p>The following additional items are normally installed by
<samp><span class="file">Rtools.exe</span></samp>.  If instead you choose to do a completely manual
build you will also need

     <ul>
<!-- @item -->
<!-- Get @file{iconv.dll} from -->
<!-- @uref{http://www.stats.ox.ac.uk/pub/Rtools/iconv.dll} and put it in -->
<!-- @file{@var{R_HOME}/@/src/@/gnuwin32/@/unicode}. -->

     <li>The Tcl/Tk support files are in a zip file at
<a href="http://www.stats.ox.ac.uk/pub/Rtools/">http://www.stats.ox.ac.uk/pub/Rtools/</a>: unzip this in
<var>R_HOME</var>, and it will add directory tree <samp><var>R_HOME</var><span class="file">/Tcl</span></samp>.

     <li>You need <code>libpng</code> and <code>jpeg</code> sources (available, e.g., from
<a href="http://www.libpng.org/">http://www.libpng.org/</a>,
<a href="ftp://ftp.uu.net/graphics/">ftp://ftp.uu.net/graphics/</a>[png,jpeg],
<a href="http://www.libtiff.org/">http://www.libtiff.org/</a>).  You will need files
<samp><span class="file">libpng-1.2.18.tar.gz</span></samp>, <samp><span class="file">jpegsrc.v6b.tar.gz</span></samp>,
<samp><span class="file">tiff-3.8.0.tar.gz</span></samp> or later.

     <p>Working in the directory <samp><var>R_HOME</var><span class="file">/src/gnuwin32/bitmap</span></samp>,
install the <code>libpng</code> and <code>jpeg</code> sources in sub-directories. 
The <code>libpng</code> sub-directory must be named <samp><span class="file">libpng</span></samp> (as required
by the <code>libpng</code> documentation).  The <code>jpeg</code> sub-directory for
version 6b is named <samp><span class="file">jpeg-6b</span></samp>; if you use a different version, edit
<samp><span class="file">Makefile</span></samp> and change the definition of <code>JPEGDIR</code>.

     <p>Example:

     <pre class="example">          &gt; tar xzvf libpng-1.2.20.tar.gz
          &gt; mv libpng-1.2.20 libpng
          &gt; tar xzvf jpegsrc.v6b.tar.gz
          &gt; tar xzvf tiff-3.8.2.tar.gz
          &gt; mv tiff-3.8.2/libtiff .
          &gt; rm -rf libtiff-3.8.2
</pre>
     </ul>

<p><a name="Building-the-core-files"></a>

<h4 class="subsection">3.1.3 Building the core files</h4>

<p>You may need to compile under a case-honouring file system: we found
that a <samp><span class="command">samba</span></samp>-mounted file system (which maps all file names to
lower case) did not work.

   <p>Open a command window at <samp><var>R_HOME</var><span class="file">/src/gnuwin32</span></samp>.  Edit
<samp><span class="file">MkRules</span></samp> to set the appropriate paths as needed and to set the
type(s) of help that you want built.  <strong>Beware</strong>: <samp><span class="file">MkRules</span></samp>
contains tabs and some editors (e.g., WinEdt) silently remove them. 
Then run

<pre class="example">     make all recommended
</pre>
   <p class="noindent">and sit back and wait while the basic compile takes place.

   <p>Notes:
     <ul>
<li>The file <samp><span class="file">bin/Rchtml.dll</span></samp> is only built if CHM help is specified in
<samp><span class="file">MkRules</span></samp>. Its source is in the help directory, and you need the
<acronym>HTML</acronym> Help Workshop files to build it.  You can just copy this from a
binary distribution.

     <li>We have had reports that earlier versions of anti-virus software locking
up the machine, but not for several years.  However, aggressive
anti-virus checking such as the on-access scanning of Sophos can slow
the build down several-fold.

     <li>By default Doug Lea's <code>malloc</code> in the file
<samp><var>R_HOME</var><span class="file">/src/gnuwin32/malloc.c</span></samp> is used for R's internal memory
allocations.  You can opt out of this by commenting the line
<code>LEA_MALLOC=YES</code> in <samp><span class="file">MkRules</span></samp>, in which case the
<code>malloc</code> in <samp><span class="file">msvcrt.dll</span></samp> is used.  This does work but
imposes a considerable performance penalty.

     <li>You can run a parallel make by e.g.

     <pre class="example">          make -j4 all
          make recommended
</pre>
     <p class="noindent">but this is only likely to be worthwhile on a multi-core machine with
ample memory.  Note that this may sometimes stop and have to be
restarted.

   </ul>

<p><a name="Building-the-bitmap-files"></a>

<h4 class="subsection">3.1.4 Building the bitmap files</h4>

<p><a name="index-Rbitmap_002edll-23"></a>
The file <samp><var>R_HOME</var><span class="file">/bin/Rbitmap.dll</span></samp> is not built
automatically.

   <p>Running <code>make</code> in <samp><var>R_HOME</var><span class="file">/src/gnuwin32/bitmap</span></samp>
or <code>make bitmapdll</code> in <samp><var>R_HOME</var><span class="file">/src/gnuwin32</span></samp>
should build <samp><span class="file">Rbitmap.dll</span></samp> and install it in <samp><var>R_HOME</var><span class="file">/bin</span></samp>.

<p><a name="Checking-the-build"></a>

<h4 class="subsection">3.1.5 Checking the build</h4>

<p>You can test a build by running <code>make check</code>.  You may need to set
<a name="index-TMPDIR-24"></a><samp><span class="env">TMPDIR</span></samp> to the absolute path to a suitable temporary directory: the
default is &lsquo;<samp><span class="samp">c:/TEMP</span></samp>&rsquo;.  (Use forward slashes and do not use a path
including spaces.  It will be ignored if not set to a directory.)

   <p>The recommended packages can be  checked by

<pre class="example">     make check-recommended
</pre>
   <p>Other levels of checking are

<pre class="example">     make check-devel
</pre>
   <p class="noindent">for a more thorough check of the R functionality, and

<pre class="example">     make check-all
</pre>
   <p class="noindent">for <code>check-devel</code> and <code>check-recommended</code>.

<p><a name="Building-the-manuals"></a>

<h4 class="subsection">3.1.6 Building the manuals</h4>

<p>The PDF manuals can be made by

<pre class="example">     make manuals
</pre>
   <p class="noindent">If you want to make the info versions (not the Reference Manual), use

<pre class="example">     cd ../../doc/manual
     make -f Makefile.win info
</pre>
   <p class="noindent">To make DVI versions of the manuals use

<pre class="example">     cd ../../doc/manual
     make -f Makefile.win dvi
</pre>
   <p class="noindent">(all assuming you have <samp><span class="command">tex</span></samp> and <samp><span class="command">latex</span></samp> installed and
in your path).

   <p>See the <a href="#Making-the-manuals">Making the manuals</a> section in the Unix section for
setting options such as the paper size.

<p><a name="Building-the-Inno-Setup-installer"></a>

<h4 class="subsection">3.1.7 Building the Inno Setup installer</h4>

<p>You need to have the files for a complete R build, including bitmap and
Tcl/Tk support and the manuals, as well as the recommended packages and
Inno Setup (see <a href="#The-Inno-Setup-installer">The Inno Setup installer</a>).

   <p>Once everything is set up

<pre class="example">     make distribution
     make check-all
</pre>
   <p class="noindent">will make all the pieces and the installers and put them in the
<samp><span class="file">gnuwin32/cran</span></samp> subdirectory, then check the build.  This works by
building all the parts in the sequence:

<pre class="example">     Rpwd.exe <span class="roman">(a utility needed in the build)</span>
     rbuild <span class="roman">(the executables, the <acronym>FAQ</acronym> docs etc.)</span>
     rpackage <span class="roman">(the base packages)</span>
     htmldocs <span class="roman">(the <acronym>HTML</acronym> documentation)</span>
     bitmapdll <span class="roman">(the bitmap support files)</span>
     recommended <span class="roman">(the recommended packages)</span>
     vignettes <span class="roman">(the vignettes in package </span><strong>grid</strong><span class="roman">:</span>
     	  <span class="roman"> only needed if building from svn checkout)</span>
     manuals <span class="roman">(the PDF manuals)</span>
     rinstaller <span class="roman">(the install program)</span>
     crandir <span class="roman">(the <acronym>CRAN</acronym> distribution directory)</span>
</pre>
   <p>The parts can be made individually if a full build is not needed, but
earlier parts must be built before later ones.  (The <samp><span class="file">Makefile</span></samp>
doesn't enforce this dependency&mdash;some build targets force a lot of
computation even if all files are up to date.)  The first four targets
are the default build if just &lsquo;<samp><span class="samp">make</span></samp>&rsquo; is run.

   <p>If you want to customize the installation by adding extra packages,
replace <code>make rinstaller</code> by something like

<pre class="example">     make rinstaller EXTRA_PKGS='pkg1 pkg2 pkg3'
</pre>
   <p>An alternative way to customize the installer starting with a binary
distribution is to first make a full installation of R from the standard
installer (that is, select &lsquo;<samp><span class="samp">Full Installation</span></samp>&rsquo; from the
&lsquo;<samp><span class="samp">Select Components</span></samp>&rsquo; screen), then add packages and make other
customizations to that installation.  Then in
<samp><span class="file">src/gnuwin32/installer</span></samp> run

<pre class="example">     make myR IMAGEDIR=rootdir
</pre>
   <p class="noindent">where <samp><span class="file">rootdir</span></samp> is the path to the root of the customized
installation (forward slashes and no spaces, please).

   <p>Both methods create an executable with the standard name,
<samp><span class="file">R-2.9.1-win32.exe</span></samp>, so please rename it to indicate that
it is customized.  If you intend to <em>distribute</em> a customized
installer please do check that license requirements are met &ndash; note that
the installer will (unless modified) state that the contents are
distributed under GPL-2 and this has a requirement for supplying the
sources (including the R sources even if you started with a binary
distribution of R).

   <p>The defaults for the startup parameters may also be customized.  For example

<pre class="example">     make myR IMAGEDIR=rootdir MDISDI=1
</pre>
   <p class="noindent">will create an installer that defaults to installing R to run in SDI
mode.  See <samp><span class="file">src/gnuwin32/installer/Makefile</span></samp> for the names and
values that can be set.

<p><a name="Building-the-MSI-installer"></a>

<h4 class="subsection">3.1.8 Building the MSI installer</h4>

<p>It is also possible to build an installer for use with Microsoft
Installer.  This is intended for use by sysadmins doing automated
installs, and is not recommended for casual use.

   <p>It makes use of the Windows Installer XML (WiX) toolkit (wersion 2.0)
available from <a href="http://wix.sourceforge.net/">http://wix.sourceforge.net/</a>.  (This needs the .NET
1.1 framework installed: it ran on a vanilla Windows XP SP2
machine. Unfortunately the file format has been changed within the same
version: currently our code works with releases 2.0.4221.0 and
2.0.5805.0 &ndash; the latter is now said to be `production/stable' so
hopefully there will be no more format changes.)  Once WiX is installed,
set the path to its home directory in <samp><span class="file">MkRules</span></samp>.

   <p>You need to have the files for a complete R build, including bitmap and
Tcl/Tk support and the manuals, as well as the recommended packages. 
Then

<pre class="example">     cd installer
     make msi
</pre>
   <p class="noindent">which will results in a file of about 40Mb with a name like
<samp><span class="file">R-2.6.0-win32.msi</span></samp>.  This can be double-clicked to be installed,
but those who need it will know what to do with it.

   <p>Thanks to David del Campo (Dept of Statistics, University of Oxford)
for suggesting WiX and building a prototype installer.

<p><a name="Cross-building-on-Linux"></a>
<a name="Cross_002dbuilding-on-Linux"></a>

<h4 class="subsection">3.1.9 Cross-building on Linux</h4>

<p>Support for cross-building has been withdrawn as from R 2.9.0.

<p><a name="Testing-a-Windows-Installation"></a>

<h3 class="section">3.2 Testing an Installation</h3>

<p>The Windows installer contains a set of test files used when building
R.  These are an optional part of the installation, and if it is
desired to run tests on the installation these should be selected as
well as the help source files (perhaps most easily by doing a `Full
Installation').

   <p>The <code>Rtools</code> are not needed to run these tests. but more
comprehensive analysis of errors will be given if <samp><span class="command">diff</span></samp> is in
the path.

   <p>Once this has been done, launch either <code>Rgui</code> or <code>Rterm</code>,
preferably with <samp><span class="option">--vanilla</span></samp>.  Then

<pre class="example">     library("tools")
     testInstalledBasic("both")
     testInstalledPackages("base")
     testInstallPackages("recommended")
</pre>
   <p class="noindent">runs the basic tests and then all the tests on the standard and
recommended packages.  These tests can be run from anywhere: they write
their results in the <samp><span class="file">tests</span></samp> folder of the R home directory (as
given by <code>R.home()</code>).

<p><a name="Installing-R-under-Mac-OS-X"></a>

<h2 class="chapter">4 Installing R under Mac OS X</h2>

<p><a name="index-Mac-OS-X-25"></a>
The <samp><span class="file">bin/macosx</span></samp> directory of a <acronym>CRAN</acronym> site contains
binaries for Mac OS X for a base distribution and a large number of
add-on packages from <acronym>CRAN</acronym> to run on Mac OS X version 10.4.4 or
higher.

   <p>The simplest way is to use <samp><span class="file">R-2.9.1.dmg</span></samp>.  Just
double-click on the icon and the disk image file will be mounted. Read
the <samp><span class="file">ReadMe.txt</span></samp> inside the disk image and follow the instructions.

   <p>See the <a href="http://CRAN.R-project.org/bin/macosx/RMacOSX-FAQ.html">R for Mac OS X <acronym>FAQ</acronym></a> for more details.

<p><a name="Building-from-source-on-Mac-OS-X"></a>

<h3 class="section">4.1 Building from source on Mac OS X</h3>

<p>If you want to build this port from the sources, you can read the above
mentioned <a href="http://CRAN.R-project.org/bin/macosx/RMacOSX-FAQ.html">R for Mac OS X <acronym>FAQ</acronym></a> for full details.  You will need to collect
and install some tools as explained in the document.  Then you have to
expand the R sources and configure R appropriately, for example

<pre class="example">     tar zxvf R-2.9.1.tar.gz
     cd R-2.9.1
     ./configure --with-blas='-framework vecLib' --with-lapack --with-ICU \
       --with-aqua --enable-R-framework
     make
</pre>
   <p class="noindent">and then sit back and wait.  The first two options are the default (and
strongly recommended), and with some toolsets have been essential. 
Selecting <samp><span class="option">--with-ICU</span></samp> replaces Apple's <code>wcscoll</code> with
one<a rel="footnote" href="#fn-3" name="fnd-3"><sup>3</sup></a> that works correctly in UTF-8
locales, and is the default as from R 2.9.0.

   <p>The second line of options is also default on Mac OS X, but needed only
if you want to build R for use with <code>R.app</code> Console, and imply
<samp><span class="option">--enable-R-shlib</span></samp> to build R as a shared/dynamic library. 
These options configure R to be built and installed as a framework
called <samp><span class="file">R.framework</span></samp>.  The default path for <samp><span class="file">R.framework</span></samp> is
<samp><span class="file">/Library/Frameworks</span></samp> but this can be changed at configure time by
specifying the flag <samp><span class="option">--enable-R-framework[=</span><var>DIR</var><span class="option">]</span></samp> or at
install time as

<pre class="example">     make prefix=/where/you/want/R.framework/to/go install
</pre>
   <p class="noindent">(the <samp><span class="file">R.framework</span></samp> directory should not be included in the path).

   <p>For compatibility with the CRAN distribution you may need to specify
<samp><span class="option">--with-included-gettext</span></samp> to avoid linking against a
&lsquo;<samp><span class="samp">libintl</span></samp>&rsquo; dynamic library you may have available, for example in
<samp><span class="file">/usr/local/lib</span></samp>.

   <p>Note that building the <samp><span class="file">R.app</span></samp> GUI console is a separate project:
see the FAQ for details.

<p><a name="Running-R"></a>

<h2 class="chapter">5 Running R</h2>

<p>How to start R and what command-line options are available is discussed
in <a href="R-intro.html#Invoking-R">Invoking R</a>.

   <p>You should ensure that the shell has set adequate resource limits: R
expects a stack size of at least 8MB and to be able to open at least 256
file descriptors.  (Any modern OS will have default limits at least as
large as these, but apparently NetBSD does not.)

   <p>R makes use of a number of environment variables, the default values
of many of which are set in file <samp><var>R_HOME</var><span class="file">/etc/Renviron</span></samp> (there
are none set by default on Windows and hence no such file).  These are
set at <samp><span class="command">configure</span></samp> time, and you would not normally want to
change them &ndash; a possible exception is <samp><span class="env">R_PAPERSIZE</span></samp> (see <a href="#Setting-paper-size">Setting paper size</a>).  The paper size will be deduced from the &lsquo;<samp><span class="samp">LC_PAPER</span></samp>&rsquo;
locale category if it exists and <samp><span class="env">R_PAPERSIZE</span></samp> is unset, and this
will normally produce the right choice from &lsquo;<samp><span class="samp">a4</span></samp>&rsquo; and &lsquo;<samp><span class="samp">letter</span></samp>&rsquo;
on modern Unix-alikes (but can always be overridden by setting
<samp><span class="env">R_PAPERSIZE</span></samp>).

   <p>Various environment variables can be set to determine where R creates
its per-session temporary directory.  The environment variables
<samp><span class="env">TMPDIR</span></samp>, <samp><span class="env">TMP</span></samp> and <samp><span class="env">TEMP</span></samp> are searched in turn and the
first one which is set and points to a writable area is used.  If none
do, the final default is <samp><span class="file">/tmp</span></samp> on Unix-alikes and the value of
<samp><span class="env">R_USER</span></samp> on Windows.

   <p>Some Unix-alike systems are set up to remove files and directories
periodically from <samp><span class="file">/tmp</span></samp>, for example by a <samp><span class="command">cron</span></samp> job
<a name="index-TMPDIR-26"></a>running <samp><span class="command">tmpwatch</span></samp>.  Set <samp><span class="env">TMPDIR</span></samp> to another directory
before running long-running jobs on such a system.

   <p>Note that <samp><span class="env">TMPDIR</span></samp> will be used to execute <samp><span class="command">configure</span></samp>
scripts when installing packages, so if <code>/tmp</code> has been mounted as
&lsquo;<samp><span class="samp">noexec</span></samp>&rsquo;, <samp><span class="env">TMPDIR</span></samp> needs to be set to a directory from which
execution is allowed.

<p><a name="Add-on-packages"></a>
<a name="Add_002don-packages"></a>

<h2 class="chapter">6 Add-on packages</h2>

<p><a name="index-Packages-27"></a><a name="index-Libraries-28"></a>

   <p>It is helpful to use the correct terminology.  A <em>package</em> is
loaded from a <em>library</em> by the function <code>library()</code>.  Thus a
library is a directory containing installed packages; the main library
is <samp><var>R_HOME</var><span class="file">/library</span></samp>, but others can be used, for example by
<a name="index-R_005fLIBS-29"></a>setting the environment variable <samp><span class="env">R_LIBS</span></samp> or using the R function
<code>.libPaths()</code>.

<p><a name="Default-packages"></a>

<h3 class="section">6.1 Default packages</h3>

<p><a name="index-Packages_002c-default-30"></a>
The set of packages loaded on startup is by default

<pre class="example">     &gt; getOption("defaultPackages")
     [1] "datasets"  "utils"     "grDevices" "graphics"  "stats"     "methods"
</pre>
   <p class="noindent">(plus, of course, <strong>base</strong>) and this can be changed by setting the
option in startup code (e.g. in <samp><span class="file">~/.Rprofile</span></samp>).  It is initially
<a name="index-R_005fDEFAULT_005fPACKAGES-31"></a>set to the value of the environment variable <samp><span class="env">R_DEFAULT_PACKAGES</span></samp> if
set (as a comma-separated list).  Setting <samp><span class="env">R_DEFAULT_PACKAGES=NULL</span></samp>
ensures that only package <strong>base</strong> is loaded.

   <p>Changing the set of default packages is normally used to reduce the set
for speed when scripting: in particular not using <strong>methods</strong> will
reduce the start-up time by a factor of two or more (and this is done by
<samp><span class="command">Rscript</span></samp>).  But it can also be used to customize R, e.g. 
for class use.

<p><a name="Managing-libraries"></a>

<h3 class="section">6.2 Managing libraries</h3>

<p><a name="index-Libraries_002c-managing-32"></a>
R packages are installed into <em>libraries</em>, which are
directories in the file system containing a subdirectory for each
package installed there.

   <p>R comes with a single library, <samp><var>R_HOME</var><span class="file">/library</span></samp> which is
the value of the R object &lsquo;<samp><span class="samp">.Library</span></samp>&rsquo; containing the standard and
recommended<a rel="footnote" href="#fn-4" name="fnd-4"><sup>4</sup></a>  packages. 
Both sites and users can create others and make use of them (or not) in
an R session.  At the lowest level &lsquo;<samp><span class="samp">.libPaths()</span></samp>&rsquo; can be used to
add paths to the collection of libraries or to report the current
collection.

   <p><a name="index-Libraries_002c-site-33"></a><a name="index-Site-libraries-34"></a>R will automatically make use of a site-specific library
<samp><var>R_HOME</var><span class="file">/site-library</span></samp> if this exists (it does not in a
vanilla R installation).  This location can be overridden by
setting<a rel="footnote" href="#fn-5" name="fnd-5"><sup>5</sup></a> &lsquo;<samp><span class="samp">.Library.site</span></samp>&rsquo; in
<samp><var>R_HOME</var><span class="file">/etc/Rprofile.site</span></samp>, or (not recommended) by setting
the
<a name="index-R_005fLIBS_005fSITE-35"></a>environment variable <samp><span class="env">R_LIBS_SITE</span></samp>.  Like &lsquo;<samp><span class="samp">.Library</span></samp>&rsquo;, the
site libraries are always included by &lsquo;<samp><span class="samp">.libPaths()</span></samp>&rsquo;.

   <p><a name="index-Libraries_002c-user-36"></a><a name="index-User-libraries-37"></a><a name="index-R_005fLIBS_005fUSER-38"></a>Users can have one or more libraries, normally specified by the
environment variable <samp><span class="env">R_LIBS_USER</span></samp>.  This has a default value (use
&lsquo;<samp><span class="samp">Sys.getenv("R_LIBS_USER")</span></samp>&rsquo; within an R session to see what it
is), but only is used if the corresponding directory actually exists
(which by default it will not).

   <p>Both <samp><span class="env">R_LIBS_USER</span></samp> and <samp><span class="env">R_LIBS_SITE</span></samp> can specify multiple
library paths, separated by colons (semicolons on Windows).

<p><a name="Installing-packages"></a>

<h3 class="section">6.3 Installing packages</h3>

<p><a name="index-Packages_002c-installing-39"></a>

   <p>Packages may be distributed in source form or compiled binary form. 
Installing source packages requires that compilers and tools (including
Perl 5.8.0 or later) be installed.  Binary packages are
platform-specific and generally need no special tools to install, but
see the documentation for your platform for details.

   <p>Note that you need to specify implicitly or explicitly the library to
which the package is to be installed.  This is only an issue if you have
more than one library, of course.

   <p>If installing packages to be used by other users, ensure that the system
<code>umask</code> is set to give sufficient permissions (see also
<code>Sys.umask</code> in R).

   <p>For most users it suffices to call
&lsquo;<samp><span class="samp">install.packages(</span><var>pkgname</var><span class="samp">)</span></samp>&rsquo; or its GUI equivalent if the
intention is to install a <acronym>CRAN</acronym> package and internet access is
available.<a rel="footnote" href="#fn-6" name="fnd-6"><sup>6</sup></a>  On most systems &lsquo;<samp><span class="samp">install.packages()</span></samp>&rsquo;
will allow packages to be selected from a list box.

   <p>To install packages from source in Unix use

<pre class="example">     R CMD INSTALL -l /path/to/library <var>pkg1</var> <var>pkg2</var> ...
</pre>
   <p class="noindent">The part &lsquo;<samp><span class="samp">-l /path/to/library</span></samp>&rsquo; can be omitted, in which case the
<a name="index-R_005fLIBS-40"></a>first library in <samp><span class="env">R_LIBS</span></samp> is used if set, otherwise the main library
<samp><var>R_HOME</var><span class="file">/library</span></samp> is used.  (<samp><span class="env">R_LIBS</span></samp> is looked for in the
environment: note that <samp><span class="file">.Renviron</span></samp> is not read by <samp><span class="command">R CMD</span></samp>.) 
<a name="index-TMPDIR-41"></a>Ensure that the environment variable <samp><span class="env">TMPDIR</span></samp> is either unset (and
<samp><span class="file">/tmp</span></samp> exists and can be written in and executed from) or points to
a valid temporary directory.

   <p>There are a number of options available: use <code>R CMD INSTALL --help</code>
to see the current list.

   <p><a name="index-install_002epackages-42"></a>Alternatively, packages can be downloaded and installed from within
R.  First set the option <code>CRAN</code> to your nearest <acronym>CRAN</acronym>
mirror using <samp><span class="command">chooseCRANmirror()</span></samp>.  Then download
and install packages <strong>pkg1</strong> and <strong>pkg2</strong> by

<pre class="example">     &gt; install.packages(c("pkg1", "pkg2"))
</pre>
   <p class="noindent">The essential dependencies of the specified packages will also be fetched. 
Unless the library is specified (argument <code>lib</code>) the first library
in the library search path is used: if this is not writable, R will
ask the user (in an interactive session) if the default user library
should be created, and if allowed to will install the packages there.

   <p>If you want to fetch a package and all those it depends on that are
not already installed, use e.g.

<pre class="example">     &gt; install.packages("Rcmdr", dependencies = TRUE)
</pre>
   <p><code>install.packages</code> can install a source package from a local
<samp><span class="file">.tar.gz</span></samp> file by setting argument <code>repos</code> to <code>NULL</code>:
this will be selected automatically if the name given is a single
<samp><span class="file">.tar.gz</span></samp> file.

   <p><code>install.packages</code> can look in several repositories, specified as a
character vector by the argument <code>repos</code>: these can include a
<acronym>CRAN</acronym> mirror, Bioconductor, Omegahat, local archives, local
files, <small class="dots">...</small>).  Function <code>setRepositories()</code> can select amongst
those the R installation is aware of.

<p><a name="Windows-packages"></a>

<h4 class="subsection">6.3.1 Windows</h4>

<p>What <code>install.packages</code> does by default is different on Unix-alikes
(except Mac OS X) and Windows.  On Unix-alikes it consults the list of
available <em>source</em> packages on <acronym>CRAN</acronym> (or other
repository/ies), downloads the latest version of the package sources,
and installs them (via <code>R CMD INSTALL</code>).  On Windows it looks (by
default) at the list of <em>binary</em> versions of packages available for
your version of R and downloads the latest versions (if any),
although optionally it will also download and install a source package
by setting the <code>type</code> argument.

   <p>On Windows <code>install.packages</code> can also install a binary package
from a local <samp><span class="file">zip</span></samp> file by setting argument <code>repos</code> to
<code>NULL</code>.   <code>Rgui.exe</code> has a menu <code>Packages</code> with a GUI
interface to <code>install.packages</code>, <code>update.packages</code> and
<code>library</code>.

   <p><samp><span class="command">R CMD INSTALL</span></samp> works in Windows to install source packages if
you have the source-code package files (option &ldquo;Source Package
Installation Files&rdquo; in the installer) and toolset (see <a href="#The-Windows-toolset">The Windows toolset</a>) installed.  Installation of binary packages must be done by
<code>install.packages</code>.   <samp><span class="command">R CMD INSTALL --help</span></samp> will tell you
the current options under Windows (which differ from those on a
Unix-alike): in particular there is a choice of the types of
documentation to be installed.

   <p>If you have only a source package that is known to work with current
R and just want a binary Windows build of it, you could make use of
the building service offered at <a href="http://win-builder.r-project.org/">http://win-builder.r-project.org/</a>.

<p><a name="Mac-OS-X-packages"></a>

<h4 class="subsection">6.3.2 Mac OS X</h4>

<p>On Mac OS X <code>install.packages</code> works as it does on other Unix-like
systems, but there is an additional type <code>mac.binary</code> (the default
in the CRAN distribution) that can be passed to <code>install.packages</code>
in order to download and install binary packages from a suitable
repository, and is the default for CRAN builds of R.  These Macintosh
binary package files have the extension &lsquo;<samp><span class="samp">tgz</span></samp>&rsquo;.  The R GUI
provides for installation of either binary or source packages, from
<acronym>CRAN</acronym> or local files.

<p><a name="Customizing-package-compilation"></a>

<h4 class="subsection">6.3.3 Customizing package compilation</h4>

<p>The R system and package-specific compilation flags can be overridden or
added to by setting the appropriate Make variables in the personal file
<samp><var>HOME</var><span class="file">/.R/Makevars-</span><var>R_PLATFORM</var></samp> (but
<samp><var>HOME</var><span class="file">/.R/Makevars.win</span></samp> on Windows), or if that does not
exist, <samp><var>HOME</var><span class="file">/.R/Makevars</span></samp>, where &lsquo;<samp><span class="samp">R_PLATFORM</span></samp>&rsquo; is the
platform for which R was built, as available in the <code>platform</code>
component of the R variable <code>R.version</code>.

   <p>Package developers are encouraged to use this mechanism to enable a
reasonable amount of diagnostic messaging (&ldquo;warnings&rdquo;) when compiling,
such as e.g. <samp><span class="option">-Wall -pedantic</span></samp> for tools from GCC, the Gnu
Compiler Collection.

   <p>Note that this mechanism can also be used when it necessary to change
the optimization level for a particular package.  For example

<pre class="example">     ## <span class="roman">for C code</span>
     CFLAGS=-g -O
     ## <span class="roman">for C++ code</span>
     CXXFLAGS=-g -O
     ## <span class="roman">for Fortran code</span>
     FFLAGS=-g -O
     ## <span class="roman">for Fortran 95 code</span>
     FCFLAGS=-g -O
</pre>
   <p><a name="Updating-packages"></a>

<h3 class="section">6.4 Updating packages</h3>

<p><a name="index-update_002epackages-43"></a><a name="index-Packages_002c-updating-44"></a>
The command <code>update.packages()</code> is the simplest way to ensure that
all the packages on your system are up to date.  Set the <code>repos</code>
argument as in the previous section.  The <code>update.packages()</code>
downloads the list of available packages and their current versions,
compares it with those installed and offers to fetch and install any
that have later versions on the repositories.

   <p>An alternative interface to keeping packages up-to-date is provided by
the command <code>packageStatus()</code>, which returns an object with
information on all installed packages and packages available at multiple
repositories.  The <code>print</code> and <code>summary</code> methods give an
overview of installed and available packages, the <code>upgrade</code> method
offers to fetch and install the latest versions of outdated packages.

<p><a name="Removing-packages"></a>

<h3 class="section">6.5 Removing packages</h3>

<p><a name="index-remove_002epackages-45"></a><a name="index-Packages_002c-removing-46"></a>
Packages can be removed in a number of ways.  From a command prompt they
can be removed by

<pre class="example">     R CMD REMOVE -l /path/to/library <var>pkg1</var> <var>pkg2</var> ...
</pre>
   <p>From a running R process they can be removed by

<pre class="example">     &gt; remove.packages(c("pkg1", "pkg2"),
                       lib = file.path("path", "to", "library"))
</pre>
   <p>Finally, in most installations one can just remove the package directory
from the library (but for a package from a bundle, be sure to remove the
whole bundle).

<p><a name="Setting-up-a-package-repository"></a>

<h3 class="section">6.6 Setting up a package repository</h3>

<p><a name="index-Repositories-47"></a>
Utilities such as <code>install.packages</code> can be pointed at any
CRAN-style repository, and R users may want to set up their own.  The
`base' of a repository is a URL such as
<a href="http://www.omegahat.org/R/">http://www.omegahat.org/R/</a>: this must be an URL scheme that
<code>download.packages</code> supports (which also includes &lsquo;<samp><span class="samp">ftp://</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">file://</span></samp>&rsquo;).  Under that base URL there should be directory trees
for one or more of the following types of package distributions:

     <ul>
<li><code>"source"</code>: located at <samp><span class="file">src/contrib</span></samp> and containing
<samp><span class="file">.tar.gz</span></samp> files.

     <li><code>"win.binary"</code>: located at <samp><span class="file">bin/windows/contrib/</span><var>x.y</var></samp> for
R versions <var>x.y.z</var> and containing <samp><span class="file">.zip</span></samp> files.

     <li><code>"mac.binary"</code>: located at
<samp><span class="file">bin/macosx/universal/contrib/</span><var>x.y</var></samp> for R versions <var>x.y.z</var>
and containing <samp><span class="file">.tgz</span></samp> files. If the repository contains only
packages for a specific architecture, the package distribution type
can be set to <code>"mac.binary.xxx"</code> where <var>xxx</var> specifies the
architecture, replacing <code>universal</code> by <var>xxx</var> in the path
above. 
</ul>

   <p>Each terminal directory must also contain a <samp><span class="file">PACKAGES</span></samp> file.  This
can be a concatenation of the <samp><span class="file">DESCRIPTION</span></samp> files of the packages
separated by blank lines (provided there are no bundles), but only a few
of the fields are needed.  The simplest way to set up such a file is to
use function <code>write_PACKAGES</code> in the <strong>tools</strong> package, and its
help explains which fields are needed.  Optionally there can also be
a <samp><span class="file">PACKAGES.gz</span></samp> file, a <samp><span class="command">gzip</span></samp>-compressed version of
<samp><span class="file">PACKAGES</span></samp>&mdash;as this will be downloaded in preference to
<samp><span class="file">PACKAGES</span></samp> it should be included for large repositories.

   <p>To add your repository to the list offered by <code>setRepositories()</code>,
see the help file for that function.

   <p>A repository can contain subdirectories, when the descriptions in the
<samp><span class="file">PACKAGES</span></samp> file of packages in subdirectories must include a line
of the form

<pre class="example">     Path: <var>path/to/subdirectory</var>
</pre>
   <p><a name="Internationalization"></a>

<h2 class="chapter">7 Internationalization and Localization</h2>

<p><a name="index-Internationalization-48"></a><a name="index-Localization-49"></a>
<em>Internationalization</em> refers to the process of enabling support
for many human languages, and <em>localization</em> to adapting to a
specific country and language.

   <p>Historically R worked in the ISO Latin-1 8-bit character set and so
covered English and most Western European languages (if not necessarily
their currency symbols).  Since R 2.1.0 it has supported (where
possible) multi-byte character sets such as UTF-8 and others used in
Chinese, Japanese and Korean.

   <p>Full internationalization of the character sets is enabled unless R
is built under Unix-alikes using <samp><span class="command">configure</span></samp> option
<samp><span class="option">--disable-mbcs</span></samp> provided the OS can support it:
see <a href="#Configuration-on-Unix">Configuration on Unix</a>.  Under Windows, support for Windows' own
MBCS is always included.

   <p>All builds of R support all single-byte character sets that the
underlying OS can handle.  These are interpreted according to the
<a name="index-Locale-50"></a>current <code>locale</code>, a sufficiently complicated topic to merit a
separate section.  Fully internationalized builds can also handle most
multi-byte locales, in which a single character is represented by one,
two or more consecutive bytes: examples of such locales are those using
UTF-8 (becoming standard under Linux but non-existent under Windows) and
those for Chinese, Japanese and Korean.

   <p>The other aspect of the internationalization is support of the
translation of messages.  This is enabled in almost all builds of R.

<p><a name="Locales"></a>

<h3 class="section">7.1 Locales</h3>

<p><a name="index-Locale-51"></a>
A <em>locale</em> is a description of the local environment of the user,
including the preferred language, the encoding of characters, the
currency used and its conventions, and so on.  Aspects of the locale are
accessed by the R functions <code>Sys.getlocale</code> and
<code>Sys.localeconv</code>.

   <p>The system of naming locales is OS-specific.  There is quite wide
agreement on schemes, but not on the details of their implementation.  A
locale needs to specify
     <ul>
<li>A human language.  These are generally specified by a lower-case
two-character abbreviation following ISO 639 (see e.g. 
<a href="http://en.wikipedia.org/wiki/ISO_639-1">http://en.wikipedia.org/wiki/ISO_639-1</a>).

     <li>A `territory', used mainly to specify the currency. These are generally
specified by an upper-case two-character abbreviation following ISO 3166
(see e.g. <a href="http://en.wikipedia.org/wiki/ISO_3166">http://en.wikipedia.org/wiki/ISO_3166</a>).  Sometimes
the combination of language and territory is used to specify the
encoding, for example to distinguish between traditional and simplified
Chinese.

     <li>A charset encoding, which determines both how a byte stream should be
divided into characters, and which characters the subsequences of bytes
represent.

     <li>Optionally, a modifier, for example to indicate that Austria is to be
considered pre- or post-Euro. 
</ul>

   <p>R is principally concerned with the first (for translations) and
third.  Note that the charset may be deducible from the language, as
some OSes offer only one charset per language, and most OSes have only
one charset each for many languages.  Note too the remark above about
Chinese.

<p><a name="Locales-under-Linux"></a>

<h4 class="subsection">7.1.1 Locales under Linux</h4>

<p>Modern Linux uses the XPG locale specifications which have the form
&lsquo;<samp><span class="samp">en_GB</span></samp>&rsquo;, &lsquo;<samp><span class="samp">en_GB.utf8</span></samp>&rsquo;, &lsquo;<samp><span class="samp">aa_ER.utf8@saaho</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">de_AT.iso885915@euro</span></samp>&rsquo;, the components being in the order listed
above.  (See <samp><span class="command">man locale</span></samp> and <samp><span class="command">locale -a</span></samp> for more
details.)  Similar schemes (but often in different cases) are used by
most Unix-alikes: some use &lsquo;<samp><span class="samp">.UTF-8</span></samp>&rsquo; rather than &lsquo;<samp><span class="samp">.utf8</span></samp>&rsquo;.

<p><a name="Locales-under-Windows"></a>

<h4 class="subsection">7.1.2 Locales under Windows</h4>

<p>Windows also uses locales, but specified in a rather less concise way. 
Most users will encounter locales only via drop-down menus, but more
information and lists can be found at
<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vccore98/html/_crt_language_and_country_strings.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vccore98/html/_crt_language_and_country_strings.asp</a>.

   <p>It offers only one encoding per language.

<p><a name="Locales-under-Mac-OS-X"></a>

<h4 class="subsection">7.1.3 Locales under Mac OS X</h4>

<p>Mac OS X supports locales in its own particular way, but the R GUI tries
to make this easier for users. See
<a href="http://developer.apple.com/documentation/MacOSX/Conceptual/BPInternational/">http://developer.apple.com/documentation/MacOSX/Conceptual/BPInternational/</a>
for how users can set their locales.  As with Windows, end users will
generally only see lists of languages/territories.  Users of R in a
terminal may need to set the locale to something like &lsquo;<samp><span class="samp">en_GB.UTF-8</span></samp>&rsquo;
if it defaults to &lsquo;<samp><span class="samp">C</span></samp>&rsquo;.

   <p>Internally Mac OS X uses a form similar to Linux but without
specifying the encoding (which is <code>UTF-8</code>).  It is based on ICU
locales (<a href="http://icu.sourceforge.net/userguide/locale.html">http://icu.sourceforge.net/userguide/locale.html</a>) and
not POSIX ones.

<p><a name="Localization-of-messages"></a>

<h3 class="section">7.2 Localization of messages</h3>

<p>The preferred language for messages is by default taken from the locale. 
This can be overridden first by the setting of the environment variable
<a name="index-LANGUAGE-52"></a><a name="index-LC_005fALL-53"></a><a name="index-LC_005fMESSAGES-54"></a><a name="index-LANG-55"></a><samp><span class="env">LANGUAGE</span></samp> and then<a rel="footnote" href="#fn-7" name="fnd-7"><sup>7</sup></a>
by the environment variables <samp><span class="env">LC_ALL</span></samp>, <samp><span class="env">LC_MESSAGES</span></samp> and
<samp><span class="env">LANG</span></samp>. (The last three are normally used to set the locale and so
should not be needed, but the first is only used to select the language
for messages.)  The code tries hard to map locales to languages, but on
some systems (notably Windows) the locale names needed for the
environment variable <samp><span class="env">LC_ALL</span></samp> do not all correspond to XPG language
names and so <samp><span class="env">LANGUAGE</span></samp> may need to be set.  (One example is
&lsquo;<samp><span class="samp">LC_ALL=es</span></samp>&rsquo; on Windows which sets the locale to Estonian and the
language to Spanish.)

   <p>It is usually possible to change the language once R is running
<em>via</em> (not Windows) <code>Sys.setlocale("LC_MESSAGES",
"new_locale")</code>, or by setting an environment variable such as
<samp><span class="env">LANGUAGE</span></samp>, <em>provided</em><a rel="footnote" href="#fn-8" name="fnd-8"><sup>8</sup></a> the language you are changing to can be output in the current
character set.

   <p>Messages are divided into <em>domains</em>, and translations may be
available for some or all messages in a domain.  R makes use of the
following domains.

     <ul>
<li>Domain <code>R</code> for basic C-level error messages.

     <li>Domain <code>R-</code><var>pkg</var> for the R <code>stop</code>, <code>warning</code> and
<code>message</code> messages in each package, including <code>R-base</code> for the
<strong>base</strong> package.

     <li>Domain <var>pkg</var> for the C-level messages in each package.

     <li>Domain <code>RGui</code> for the menus etc of the R for Windows GUI front-end.

   </ul>

   <p>Dividing up the messages in this way allows R to be extensible: as
packages are loaded, their message translation catalogues can be loaded
too.

   <p>Translations are looked for by domain according to the currently
specified language, as specifically as possible, so for example an
Austrian (&lsquo;<samp><span class="samp">de_AT</span></samp>&rsquo;) translation catalogue will be used in preference
to a generic German one (&lsquo;<samp><span class="samp">de</span></samp>&rsquo;) for an Austrian user.  However, if a
specific translation catalogue exists but does not contain a
translation, the less specific catalogues are consulted.  For example,
R has catalogues for &lsquo;<samp><span class="samp">en_GB</span></samp>&rsquo; that translate the Americanisms
(e.g., &lsquo;<samp><span class="samp">gray</span></samp>&rsquo;) in the standard messages into English.  Two other
examples: there are catalogues for &lsquo;<samp><span class="samp">es</span></samp>&rsquo;, which is Spanish as
written in Spain and these will by default also be used in
Spanish-speaking Latin American countries, and also for &lsquo;<samp><span class="samp">pt_BR</span></samp>&rsquo;,
which are used for Brazilian locales but not for locales specifying
Portugal.

   <p>Translations in the right language but the wrong charset be made use of
by on-the-fly re-encoding (on almost all systems).  The <samp><span class="env">LANGUAGE</span></samp>
variable (only) can be a colon-separated list, for example &lsquo;<samp><span class="samp">se:de</span></samp>&rsquo;,
giving a set of languages in decreasing order of preference.  One
special value is &lsquo;<samp><span class="samp">en@quot</span></samp>&rsquo;, which can be used in a UTF-8 locale to
have English/American error messages with pairs of quotes translated to
Unicode directional quotes.

   <p>If no suitable translation catalogue is found or a particular message is
not translated in any suitable catalogue, `English'<a rel="footnote" href="#fn-9" name="fnd-9"><sup>9</sup></a> is used.

   <p>See <a href="http://developer.r-project.org/Translations.html">http://developer.r-project.org/Translations.html</a> for how to
prepare and install translation catalogues.

<p><a name="Choosing-between-32--and-64-bit-builds"></a>
<a name="Choosing-between-32_002d-and-64_002dbit-builds"></a>

<h2 class="chapter">8 Choosing between 32- and 64-bit builds</h2>

<p>Many current CPUs have both 32- and 64-bit sets of instructions: this
has long been true for UltraSparc and more recently for MIPS, PPC and
&lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; (AMD Opteron and Athlon64, Intel Xeon and
Pentium/'Core' supporting EM64T).  Many OSes running on such CPUs offer
the choice of building a 32-bit or a 64-bit version of R (and details
are given below under specific OSes).  For most a 32-bit version is the
default, but for some (e.g., &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Linux) 64-bit is.

   <p>All current versions of R use 32-bit integers and
<acronym>IEC</acronym>&nbsp;60559<a rel="footnote" href="#fn-10" name="fnd-10"><sup>10</sup></a> double-precision reals, and so compute to
the same precision<a rel="footnote" href="#fn-11" name="fnd-11"><sup>11</sup></a> and with the same limits on the sizes of
numerical quantities.  The principal difference is in the size of the
pointers.

   <p>64-bit builds have both advantages and disadvantages:
     <ul>
<li>The total virtual memory space made available to a 32-bit
process<a rel="footnote" href="#fn-12" name="fnd-12"><sup>12</sup></a> is limited to 4GB, and on most OSes to 3GB (or even
2GB).  The limits for 64-bit processes are much larger.

     <p>R allocates memory for large objects as needed, and removes any
unused ones at garbage collection.  When the sizes of objects become an
appreciable fraction of the address limit, fragmentation of the address
space becomes an issue and there may be no hole available that is the
size requested.  This can cause more frequent garbage collection or the
inability to allocate large objects.  As a guide, this will become an
issue with objects more than 10% of the size of the address space
(around 300Mb) or when the total size of objects in use is around one
third (around 1Gb).

     <li>32-bit OSes by default limit file sizes to 2GB.  This can often be
worked around: and <samp><span class="command">configure</span></samp> selects suitable defines if this
is possible.  (We have also largely worked around that limit on
Windows.)  64-bit builds have much larger limits.

     <li>Because the pointers are larger, R's basic structure (the cons cell)
is larger (normally twice the size).  This means that R objects take
more space and (usually) more time to manipulate.  So 64-bit versions of
R will typically run slower than 32-bit versions.  (On Sparc Solaris
the difference was 15-20%, on Linux on Opteron around 10%.  The pattern
is not universal, as on Intel Core 2 Duo the vanilla 64-bit version is
around 10% faster on both Linux and Mac OS X &mdash; this can be reduced by
tuning the compile to that chip.) 
</ul>

   <p>So, for speed you may want to use a 32-bit build, but to handle large
datasets (and perhaps large files) a 64-bit build.  You can build both
and install them in the same place: See <a href="#Sub_002darchitectures">Sub-architectures</a>.

   <p>Even on 64-bit builds of R there are limits on the size of R
objects (see <code>help("Memory-limits")</code>, some of which stem from the
use of 32-bit integers (especially in FORTRAN code).  On all versions of
R, the maximum length (number of elements) of a vector is
2^31-1, about 2 billion, and on 64-bit systems the size of a
block of memory allocated is limited to 2^34-1 bytes (8GB).  It
is anticipated these will be raised eventually but routine use of 8GB
objects is (when this was written in 2005) several years off.

<p><a name="Windows"></a>

<h3 class="section">8.1 Windows</h3>

<p>Currently the Windows build of R from <acronym>CRAN</acronym> is a 32-bit
executable.  This runs happily on Windows 64 on AMD64 and EM64T, but is
limited to an address space of 2 to 4GB (see the `R for Windows FAQ' for
details).  It will not be possible fro the R project to provide a
native version for Windows 64 until suitable non-commercial compilers
are available, and currently (early 2009) the experimental version of
MinGW for 64-bit Windows is not yet good enough to build a working R. 
Commercial 64-bit compilers have been used, and R can be be built
with such compilers with minimal changes to the sources (and
constructing suitable project files).

<p><a name="The-standalone-Rmath-library"></a>

<h2 class="chapter">9 The standalone Rmath library</h2>

<p>The routines supporting the distribution and
special<a rel="footnote" href="#fn-13" name="fnd-13"><sup>13</sup></a> functions in R
and a few others are declared in C header file <samp><span class="file">Rmath.h</span></samp>.  These
can be compiled into a standalone library for linking to other
applications.  (Note that they are not a separate library when R is
built, and the standalone version differs in several ways.)

   <p>The makefiles and other sources needed are in directory
<samp><span class="file">src/nmath/standalone</span></samp>, so the following instructions assume that
is the current working directory (in the build directory tree on Unix if
that is separate from the sources).

   <p><samp><span class="file">Rmath.h</span></samp> contains &lsquo;<samp><span class="samp">R_VERSION_STRING</span></samp>&rsquo;, which is a character
string containing the current R version, for example <code>"2.6.0"</code>.

   <p>There is full access to R's handling of <code>NaN</code>s, <code>Inf</code> and
<code>-Inf</code> via special versions of the macros and functions

<pre class="example">         ISNAN, R_FINITE, R_log, R_pow and R_pow_di
</pre>
   <p class="noindent">and (extern) constants <code>R_PosInf</code>, <code>R_NegInf</code> and <code>NA_REAL</code>.

   <p>There is no support for R's notion of missing values, in particular
not for <code>NA_INTEGER</code> nor the distinction between <code>NA</code> and
<code>NaN</code> for doubles.

   <p>A little care is needed to use the random-number routines. You will
need to supply the uniform random number generator

<pre class="example">         double unif_rand(void)
</pre>
   <p class="noindent">or use the one supplied (and with a shared library or DLL you will
have to use the one supplied, which is the Marsaglia-multicarry with
an entry point

<pre class="example">         set_seed(unsigned int, unsigned int)
</pre>
   <p class="noindent">to set its seeds).

   <p>The facilties to change the normal random number generator are
available through the constant N01_kind. This takes values
from the enumeration type

<pre class="example">     typedef enum {
         BUGGY_KINDERMAN_RAMAGE,
         AHRENS_DIETER,
         BOX_MULLER,
         USER_NORM,
         INVERSION,
         KINDERMAN_RAMAGE
     } N01type;
</pre>
   <p class="noindent">(and &lsquo;<samp><span class="samp">USER_NORM</span></samp>&rsquo; is not available).

<p><a name="Unix-standalone"></a>

<h3 class="section">9.1 Unix</h3>

<p>If R has not already be made in the directory tree,
<samp><span class="command">configure</span></samp> must tbe run as described in the main build
instructions.

   <p>Then

<pre class="example">     make
</pre>
   <p class="noindent">will make standalone libraries <samp><span class="file">libRmath.a</span></samp> and <samp><span class="file">libRmath.so</span></samp>. 
&lsquo;<samp><span class="samp">make static</span></samp>&rsquo; and <code>make shared</code> will create just one of them.

   <p><strong>NB:</strong> certain compilers are unable to do compile-time IEEE-754
arithmetic and so cannot compile <samp><span class="file">mlutils.c</span></samp> and several other
files.  The known example is old versions of Sun's <code>cc</code> (e.g. 
Forte 6 and 7).

   <p>To use the routines in your own C or C++ programs, include

<pre class="example">     #define MATHLIB_STANDALONE
     #include &lt;Rmath.h&gt;
</pre>
   <p class="noindent">and link against &lsquo;<samp><span class="samp">-lRmath</span></samp>&rsquo; (and &lsquo;<samp><span class="samp">-lm</span></samp>&rsquo; if needed on your OS). 
The example file <samp><span class="file">test.c</span></samp> does nothing useful, but is provided to
test the process (via <samp><span class="command">make test</span></samp>.  Note that you will probably
not be able to run it unless you add the directory containing
<samp><span class="file">libRmath.so</span></samp> to the <samp><span class="env">LD_LIBRARY_PATH</span></samp> environment variable.

   <p>The targets

<pre class="example">     make install
     make uninstall
</pre>
   <p class="noindent">will (un)install the header <samp><span class="file">Rmath.h</span></samp> and shared and static
libraries (if built).  Both <code>prefix=</code> and <samp><span class="env">DESTDIR</span></samp> are
supported, together with more precise control as described for the main
build.

   <p>&lsquo;<samp><span class="samp">make install</span></samp>&rsquo; installs a file for <samp><span class="command">pkg-config</span></samp> to use by
e.g.

<pre class="example">     $(CC) `pkg-config --cflags libRmath` -c test.c
     $(CC) `pkg-config --libs libRmath` test.o -o test
</pre>
   <p>On some systems &lsquo;<samp><span class="samp">make install-strip</span></samp>&rsquo; will install a stripped shared
library.

<p><a name="Windows-standalone"></a>

<h3 class="section">9.2 Windows</h3>

<p>You need to set up almost all the tools to make R and then run (in a
Unix-like shell)

<pre class="example">     (cd ../../include; make -f Makefile.win config.h Rconfig.h Rmath.h)
     make -f Makefile.win
</pre>
   <p class="noindent">For <samp><span class="file">cmd.exe</span></samp> use

<pre class="example">     cd ../../include
     make -f Makefile.win config.h Rconfig.h Rmath.h
     cd ../nmath/standalone
     make -f Makefile.win
</pre>
   <p>This creates a static library <samp><span class="file">libRmath.a</span></samp> and a DLL
<samp><span class="file">Rmath.dll</span></samp>.  If you want an import library <samp><span class="file">libRmath.dll.a</span></samp>
(you don't need one), use

<pre class="example">     make -f Makefile.win shared implib
</pre>
   <p>To use the routines in your own C or C++ programs using MinGW, include

<pre class="example">     #define MATHLIB_STANDALONE
     #include &lt;Rmath.h&gt;
</pre>
   <p class="noindent">and link against &lsquo;<samp><span class="samp">-lRmath</span></samp>&rsquo;.  This will use the first found of
<samp><span class="file">libRmath.dll.a</span></samp>, <samp><span class="file">libRmath.a</span></samp> and <samp><span class="file">Rmath.dll</span></samp> in that
order, so the result depends on which files are present.  You should be
able to force static or dynamic linking  <em>via</em>

<pre class="example">     -Wl,-Bstatic -lRmath -Wl,dynamic
     -Wl,-Bdynamic -lRmath
</pre>
   <p class="noindent">or by linking to explicit files (as in the &lsquo;<samp><span class="samp">test</span></samp>&rsquo; target in
<samp><span class="file">Makefile.win</span></samp>: this makes two executables, <samp><span class="file">test.exe</span></samp> which
is dynamically linked, and <code>test-static</code>, which is statically
linked).

   <p>It is possible to link to <samp><span class="file">Rmath.dll</span></samp> using other compilers, either
directly or via an import library: if you make a MinGW import library as
above, you will create a file <samp><span class="file">Rmath.def</span></samp> which can be used
(possibly after editing) to create an import library for other systems
such as Visual C++.

   <p>If you make use of dynamic linking you should use

<pre class="example">     #define MATHLIB_STANDALONE
     #define RMATH_DLL
     #include &lt;Rmath.h&gt;
</pre>
   <p class="noindent">to ensure that the constants like <code>NA_REAL</code> are linked correctly. 
(Auto-import will probably work with MinGW, but it is better to be
sure. This is likely to also work with VC++, Borland and similar
compilers.)

<p><a name="Essential-and-useful-other-programs-under-Unix"></a>

<h2 class="appendix">Appendix A Essential and useful other programs under Unix</h2>

<p>This appendix gives details of programs you will need to build R on
Unix-like platforms, or which will be used by R if found by
<samp><span class="command">configure</span></samp>.

   <p>Remember that some package management systems (such as <acronym>RPM</acronym> and
deb) make a distinction between the user version of a package and the
development version.  The latter usually has the same name but with the
extension &lsquo;<samp><span class="samp">-devel</span></samp>&rsquo; or &lsquo;<samp><span class="samp">-dev</span></samp>&rsquo;: you need both versions
installed.

<p><a name="Essential-programs"></a>

<h3 class="section">A.1 Essential programs</h3>

<p>You need a means of compiling C and FORTRAN 77 (see <a href="#Using-FORTRAN">Using FORTRAN</a>).  Some add-on packages also need a C++ compiler.  Your C
compiler should be <acronym>IEC</acronym>&nbsp;60059<a rel="footnote" href="#fn-14" name="fnd-14"><sup>14</sup></a>, POSIX 1003.1 and C99-compliant if at all
possible.  R tries to choose suitable flags for the C compilers it
knows about, but you may have to set <code>CC</code> or <code>CFLAGS</code>
suitably.  For recent versions of <samp><span class="command">gcc</span></samp> with <code>glibc</code> this
means including <samp><span class="option">-std=gnu99</span></samp><a rel="footnote" href="#fn-15" name="fnd-15"><sup>15</sup></a>.  If the compiler is detected as
<samp><span class="command">gcc</span></samp>, <samp><span class="option">-std=gnu99</span></samp> will be appended to <code>CC</code> unless
it conflicts with a setting of <code>CFLAGS</code>.

   <p>Unless you do not want to view graphs on-screen you need &lsquo;<samp><span class="samp">X11</span></samp>&rsquo;
installed, including its headers and client libraries. For recent Fedora
distributions it means (at least) &lsquo;<samp><span class="samp">libX11</span></samp>&rsquo;, &lsquo;<samp><span class="samp">libX11-devel</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">libXt</span></samp>&rsquo; and &lsquo;<samp><span class="samp">libXt-devel</span></samp>&rsquo;.  On Debian we recommend the
meta-package &lsquo;<samp><span class="samp">xorg-dev</span></samp>&rsquo;.  If you really do not want these you will
need to explicitly configure R without X11, using
<samp><span class="option">--with-x=no</span></samp>.

   <p>The command-line editing depends on the <code>readline</code> library
available from any <acronym>GNU</acronym> mirror: version 4.2 or later is
needed for all the features to be enabled.  Otherwise you will need to
configure with <samp><span class="option">--with-readline=no</span></samp> (or equivalent).

   <p>The use of multi-byte characters, conversion between encodings
(including for translated messages) and the R <code>iconv</code> function
depend on having the system <code>iconv</code> function: this is part of
recent versions of <code>glibc</code> and many Unixes.  You can also install
<acronym>GNU</acronym> <code>libiconv</code> (which is not the same as that in
<code>glibc</code>), possibly as a plug-in replacement: see
<a href="http://www.gnu.org/software/libiconv/">http://www.gnu.org/software/libiconv/</a>.  Note that the R
usage requires <code>iconv</code> to be able to translate between
<code>"latin1"</code> and <code>"UTF-8"</code>, to recognize <code>""</code> as the
current encoding and to translate to and from the Unicode wide-character
formats <code>"UCS-[24][BL]E"</code> &mdash; this is not true of most commercial
Unixes.  This is regarded as essential from R 2.5.0: if you do not
have it will need to configure with <samp><span class="option">--without-iconv</span></samp> (or
equivalent), and <samp><span class="command">make check</span></samp> (and other checks) are likely to
fail.

   <p>Perl version 5.8.0 or later, available via
<a href="http://www.perl.com/CPAN/">http://www.perl.com/CPAN/</a>, is essential.

   <p>You will not be able to build most of the manuals unless you have
<samp><span class="command">makeinfo</span></samp> version 4.7 or later installed, and if not some of
the <acronym>HTML</acronym> manuals will be linked to <acronym>CRAN</acronym>.  (Version 4.6 is
known to create incorrect <acronym>HTML</acronym> files.)  To make DVI or PDF versions
of the manuals you will also need <samp><span class="file">texinfo.tex</span></samp> installed (which is
part of the GNU &lsquo;<samp><span class="samp">texinfo</span></samp>&rsquo; distribution but is often made part of
the TeX package in re-distributions) as well as <samp><span class="command">texi2dvi</span></samp>
(part of the GNU <strong>texinfo</strong> distribution).

   <p><a name="index-Vignettes-56"></a>The DVI and PDF documentation and building vignettes needs <samp><span class="command">tex</span></samp>
and <samp><span class="command">latex</span></samp>, or <samp><span class="command">pdftex</span></samp> and <samp><span class="command">pdflatex</span></samp>.

   <p>If you want to build from the R Subversion repository you need both
<samp><span class="command">makeinfo</span></samp> and <samp><span class="command">pdflatex</span></samp>. 
<a name="index-Subversion-57"></a>

<p><a name="Useful-libraries-and-programs"></a>

<h3 class="section">A.2 Useful libraries and programs</h3>

<p>The ability to use translated messages makes use of <code>gettext</code> and
most likely needs <acronym>GNU</acronym> <code>gettext</code>: you do need this to work
with new translations, but otherwise the version contained in the R
sources will be used if no suitable external <code>gettext</code> is found.

   <p>The `modern' version of <code>X11</code>, <code>jpeg()</code>, <code>png()</code> and
<code>tiff()</code> uses the <code>cairo</code> and (optionally) <code>Pango</code>
libraries.  Cairo version 1.0 or later is required<a rel="footnote" href="#fn-16" name="fnd-16"><sup>16</sup></a>, and some features require 1.2 or later (and may not
work before 1.4).  Pango needs to be at least version 1.10, and 1.12 is
the earliest version we have tested.  (For Fedora users we believe the
<code>pango-devel</code> RPM and its dependencies suffice.)  R checks for
<samp><span class="command">pkg-config</span></samp>, and uses that to check first that the
&lsquo;<samp><span class="samp">pangocairo</span></samp>&rsquo; package is installed (and if not, &lsquo;<samp><span class="samp">cairo</span></samp>&rsquo;) and if
additional flags are needed for the &lsquo;<samp><span class="samp">cairo-xlib</span></samp>&rsquo; package, then if
suitable code can be compiled.  These tests will fail if
<samp><span class="command">pkg-config</span></samp> is not installed, and are likely to fail if
<code>cairo</code> was built statically (unusual).  Most systems with
<code>Gtk+</code> 2.8 or later installed will have suitable libraries, but
some (e.g. Solaris 10) may need <code>cairo</code> added separately.  Mac OS
X comes with none of these libraries, but <code>cairo</code> support has been
added to the binary distribution: <code>pkg-config</code> is still needed and
can be compiled from the sources.

   <p>For the best font experience with these devices you need suitable fonts
installed: Linux users will want the <code>urw-fonts</code> package.  Another
useful set of fonts is the `liberation' truetype fonts available at
<a href="https://www.redhat.com/promo/fonts/">https://www.redhat.com/promo/fonts/</a>, which cover the Latin,
Greek and Cyrillic alphabets plus a fair range of signs.  These share
metrics with Arial, Times New Roman and Courier New, and contain fonts
rather similar to the first two
(<a href="http://en.wikipedia.org/wiki/Liberation_fonts">http://en.wikipedia.org/wiki/Liberation_fonts</a>).

   <p>The bitmapped graphics devices <code>jpeg()</code>, <code>png()</code> and
<code>tiff()</code> need the appropriate headers and libraries installed:
<code>jpeg</code> (version 6b or later) or <code>libpng</code> (version 1.2.3 or
later) and <code>zlib</code> (version 1.1.3 or later) or <code>libtiff</code> (any
recent version &ndash; 3.8.2 was tested) respectively.

   <p>The <code>bitmap</code> and <code>dev2bitmap</code> devices and also
<code>embedFonts()</code> use ghostscript
(<a href="http://www.cs.wisc.edu/~ghost">http://www.cs.wisc.edu/~ghost</a>).

   <p>If you have them installed (including the appropriate headers and of
recent enough versions), <code>zlib</code>, <code>libbz2</code> and PCRE will be
used if specified by <samp><span class="option">--with-system-zlib</span></samp>,
<samp><span class="option">--with-system-bzlib</span></samp> or <samp><span class="option">--with-system-pcre</span></samp>: otherwise
versions in the R sources will be compiled in.  As the latter suffice
and are tested with R you should not need to change this.  In
particular, the version of <code>zlib</code> 1.2.3 in the R sources has
enhancements to work with large file systems on 32-bit platforms.

   <p>Use of the X11 clipboard selection requires the <code>Xmu</code> headers and
libraries.  These are normally part of an X11 installation (e.g. the
Debian meta-package &lsquo;<samp><span class="samp">xorg-dev</span></samp>&rsquo;), but some distributions have split
this into smaller parts, so for example recent versions of Fedora
require the &lsquo;<samp><span class="samp">libXmu</span></samp>&rsquo; and &lsquo;<samp><span class="samp">libXmu-devel</span></samp>&rsquo; RPMs.

   <p>Some systems (notably Mac OS X and at least some FreeBSD systems) have
inadequate support for collation in multibyte locales.  It is possible
to replace the OS's collation support by that from ICU (International
Components for Unicode, <a href="http://www.icu-project.org/">http://www.icu-project.org/</a>), and this
provides much more precise control over collation on all systems.  ICU
is available as sources and as binary distributions for (at least) most
Linux distributions, Solaris 9/10, AIX and Windows, usually as
<code>libicu</code> or <code>icu4c</code>.  It will be used by default where
available (including on Mac OS X &gt;= 10.4).

<p><a name="Tcl%2fTk"></a>
<a name="Tcl_002fTk"></a>

<h4 class="subsection">A.2.1 Tcl/Tk</h4>

<p>The <strong>tcltk</strong> package needs Tcl/Tk &gt;= 8.3 installed: the sources are
available at <a href="http://www.tcl.tk/">http://www.tcl.tk/</a>.  To specify the locations of the
Tcl/Tk files you may need the configuration options

     <dl>
<dt><samp><span class="option">--with-tcltk</span></samp><dd>use Tcl/Tk, or specify its library directory
<br><dt><samp><span class="option">--with-tcl-config=</span><var>TCL_CONFIG</var></samp><dd>specify location of <samp><span class="file">tclConfig.sh</span></samp>
<br><dt><samp><span class="option">--with-tk-config=</span><var>TK_CONFIG</var></samp><dd>specify location of <samp><span class="file">tkConfig.sh</span></samp>
</dl>

<p class="noindent">or use the configure variables <code>TCLTK_LIBS</code> and
<code>TCLTK_CPPFLAGS</code> to specify the flags needed for linking against
the Tcl and Tk libraries and for finding the <samp><span class="file">tcl.h</span></samp> and
<samp><span class="file">tk.h</span></samp> headers, respectively.  If you have both 32- and 64-bit
versions of Tcl/Tk installed, setting the paths to the correct config
files may be necessary to avoid confusion between them.

   <p>Versions of Tcl/Tk from 8.3.x to 8.5.6 have been used successfully.

<p><a name="Java-support"></a>

<h4 class="subsection">A.2.2 Java support</h4>

<p><samp><span class="command">configure</span></samp> looks for Java support on the host system, and if it
finds it sets some settings which are useful for Java-using packages. 
<a name="index-JAVA_005fHOME-58"></a><samp><span class="env">JAVA_HOME</span></samp> can be set during the <samp><span class="command">configure</span></samp> run to point
to a specific JRE/JDK.

   <p>Principal amongst these are some library paths to the Java libraries and
JVM, which are stored in environment variable
<samp><span class="env">R_JAVA_LD_LIBRARY_PATH</span></samp> in file <samp><var>R_HOME</var><span class="file">/etc/ldpaths</span></samp> (or
a sub-architecture-specific version).  A typical setting for Sun Java is

<pre class="smallexample">     /usr/java/jdk1.5.0_06/jre/lib/amd64/server:/usr/java/jdk1.5.0_06/jre/lib/amd64
</pre>
   <p>Note that this unfortunately depends on the exact version of the JRE/JDK
installed, and so will need updating if the Java installation is
updated.  This can be done by running <code>R CMD javareconf</code>. The
script re-runs Java detection in a manner similar to that of the
<code>configure</code> script and updates settings in both <samp><span class="file">Makeconf</span></samp> and
<samp><var>R_HOME</var><span class="file">/etc/ldpaths</span></samp>. See <code>R CMD javareconf --help</code> for
details.

   <p>Another alternative of overriding those setting is to  set
<a name="index-R_005fJAVA_005fLD_005fLIBRARY_005fPATH-59"></a><samp><span class="env">R_JAVA_LD_LIBRARY_PATH</span></samp> (e.g. in <samp><span class="file">~/.Renviron</span></samp>), or use
<samp><span class="file">/etc/ld.so.conf</span></samp> to specify the Java runtime library paths to
the system. Other settings are recorded in <samp><span class="file">etc/Makeconf</span></samp> (or a
sub-architecture-specific version), e.g.

<pre class="smallexample">     JAVA = /usr/bin/java
     JAVAC = /usr/bin/javac
     JAVA_HOME = /usr/java/jdk1.5.0_06/jre
     JAVA_LD_LIBRARY_PATH = $(JAVA_HOME)/lib/amd64/server:$(JAVA_HOME)/lib/amd64:\
     $(JAVA_HOME)/../lib/amd64:/usr/local/lib64
     JAVA_LIBS = -L$(JAVA_HOME)/lib/amd64/server -L$(JAVA_HOME)/lib/amd64
                 -L$(JAVA_HOME)/../lib/amd64 -L/usr/local/lib64 -ljvm
</pre>
   <p class="noindent">where &lsquo;<samp><span class="samp">JAVA_LIBS</span></samp>&rsquo; contains flags necessary to link JNI programs. 
Some of the above variables can be queried using <code>R CMD config</code>.

<p><a name="Linear-algebra"></a>

<h3 class="section">A.3 Linear algebra</h3>

<p><a name="index-BLAS-library-60"></a>

<p><a name="BLAS"></a>

<h4 class="subsection">A.3.1 BLAS</h4>

<p>The linear algebra routines in R can make use of enhanced BLAS (Basic
Linear Algebra Subprograms,
<a href="http://www.netlib.org/blas/faq.html">http://www.netlib.org/blas/faq.html</a>) routines.  However,
these have to be explicitly requested at configure time: R provides
an internal BLAS which is well-tested and will be adequate for most uses
of R.

   <p>You can specify a particular BLAS library <em>via</em> a value for the
configuration option <samp><span class="option">--with-blas</span></samp> and not to use an external
BLAS library by <samp><span class="option">--without-blas</span></samp> (the default).  If
<samp><span class="option">--with-blas</span></samp> is given with no, its value is taken from the
<a name="index-BLAS_005fLIBS-61"></a>environment variable <samp><span class="env">BLAS_LIBS</span></samp>, set for example in
<samp><span class="file">config.site</span></samp>.  If neither the option nor the environment variable
supply a value, a search is made for a suitable BLAS.  If the value is
not obviously a linker command (starting with a dash or giving the path
to a library), it is prefixed by &lsquo;<samp><span class="samp">-l</span></samp>&rsquo;, so

<pre class="example">     --with-blas="foo"
</pre>
   <p class="noindent">is an instruction to link against &lsquo;<samp><span class="samp">-lfoo</span></samp>&rsquo; to find an external BLAS
(which needs to be found both at link time and run time).

   <p>The configure code checks that the external BLAS is complete (it must
include all double precision and double complex routines<a rel="footnote" href="#fn-17" name="fnd-17"><sup>17</sup></a>, as well as
<code>LSAME</code>), and appears to be usable.  However, an external BLAS has
to be usable from a shared object (so must contain position-independent
code), and that is not checked.

   <p>Some enhanced BLASes are compiler-system-specific (<code>libsunperf</code> on
Sun Sparc<a rel="footnote" href="#fn-18" name="fnd-18"><sup>18</sup></a>, <code>libessl</code> on IBM, <code>vecLib</code> on Mac OS X).  The
correct incantation for these is usually found <em>via</em>
<samp><span class="option">--with-blas</span></samp> with no value on the appropriate platforms.

   <p>Some of the external BLASes are multi-threaded.  One issue is that R
profiling (which uses the <code>SIGPROF</code> signal) may cause problems, and
you may want to disable profiling if you use a multi-threaded BLAS. 
Note that using a multi-threaded BLAS can result in taking more CPU time
and even more elapsed time (occasionally dramatically so) than using a
similar single-threaded BLAS.

   <p>Note that under Unix (but not under Windows) if R is compiled against
a non-default BLAS and <samp><span class="option">--enable-BLAS-shlib</span></samp> is <strong>not</strong>
used, then all BLAS-using packages must also be.  So if R is re-built
to use an enhanced BLAS then packages such as <strong>quantreg</strong> will need
to be re-installed.

<p><a name="ATLAS"></a>

<h5 class="subsubsection">A.3.1.1 ATLAS</h5>

<p>ATLAS (<a href="http://math-atlas.sourceforge.net/">http://math-atlas.sourceforge.net/</a>) is a &ldquo;tuned&rdquo; BLAS
that runs on a wide range of Unix-alike platforms.  Unfortunately it is
usually built as a static library that on some platforms cannot be used
with shared libraries such as are used in R packages.  Be careful
when using pre-built versions of ATLAS (they seem to work on
&lsquo;<samp><span class="samp">ix86</span></samp>&rsquo; platforms, but not on &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; ones).

   <p>The usual way to specify ATLAS will be via

<pre class="example">     --with-blas="-lf77blas -latlas"
</pre>
   <p class="noindent">if the libraries are in the library path, otherwise by

<pre class="example">     --with-blas="-L/path/to/ATLAS/libs -lf77blas -latlas"
</pre>
   <p class="noindent">For systems with multiple processors it is possible to use a
multi-threaded version of ATLAS, by specifying

<pre class="example">     --with-blas="-lptf77blas -lpthread -latlas"
</pre>
   <p>Consult its file <samp><span class="file">INSTALL.txt</span></samp> for how to build ATLAS with
position-independent code (at least on version 3.8.0): this also
describes how to build ATLAS as a shared library.

   <p>ATLAS can also be used on Windows: see see <a href="#Getting-the-source-files">Getting the source files</a>
when building from source, and
<a href="http://CRAN.R-project.org/bin/windows/rw-FAQ.html">R Windows <acronym>FAQ</acronym></a> for adding pre-compiled support to binary versions.

<p><a name="ACML"></a>

<h5 class="subsubsection">A.3.1.2 ACML</h5>

<p>For &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; processors under Linux and Solaris 10 there is the
AMD Core Math Library (ACML) <a href="http://www.amd.com/acml">http://www.amd.com/acml</a>.  For the
<samp><span class="command">gcc</span></samp> version we could use

<pre class="example">     --with-blas="-lacml"
</pre>
   <p class="noindent">if the appropriate library directory (such as
<a name="index-LD_005fLIBRRARY_005fPATH-62"></a><samp><span class="file">/opt/acml4.2.0/gfortran64/lib</span></samp>) is in the <samp><span class="env">LD_LIBRRARY_PATH</span></samp>. 
For other compilers, see the ACML documentation.  There is a
multithreaded Linux version of ACML available for <samp><span class="command">gfortran</span></samp>
which needs <samp><span class="command">gcc</span></samp> &gt;= 4.2.0 (or some RedHat versions of 4.1.x). 
To make use of this you will need something like

<pre class="example">     --with-blas="-L/opt/acml4.2.0/gfortran64_mp/lib -lacml_mp"
</pre>
   <p>See see <a href="#Shared-BLAS">Shared BLAS</a> for an alternative (and in many ways preferable)
way to use ACML.

<p><a name="Goto-BLAS"></a>

<h5 class="subsubsection">A.3.1.3 Goto BLAS</h5>

<p>Dr Kazushige Goto has written another tuned BLAS which is available for
several processors and OSes.

   <p>This has been made available in several formats, but is currently
available only as source code.  For <em>academic use only</em> (after
registering) it can be obtained via
<a href="http://www.tacc.utexas.edu/resources/software/software.php">http://www.tacc.utexas.edu/resources/software/software.php</a>. 
Once this is built and installed, it can be used by configuring with

<pre class="example">     --with-blas="-lgoto"
</pre>
   <p>See see <a href="#Shared-BLAS">Shared BLAS</a> for an alternative (and in many ways preferable)
way to use recent versions of the Goto BLAS.

   <p>Note that currently a multi-threaded Goto BLAS will be built by default
if and only if the building is on a multi-processor system (counting
multiple cores and hyperthreading), and at run time the default number
of threads is the number of CPUs detected.

   <p>It has been reported that on some RedHat-based Linux systems it is
necessary to set <code>GOTO_NUM_THREADS=1</code> or <code>OMP_NUM_THREADS=1</code>
(to disable multiple threads) in the environment when using a
multi-threaded Goto BLAS, but ours run happily with multiple threads.

<p><a name="MKL"></a>

<h5 class="subsubsection">A.3.1.4 Intel MKL</h5>

<p>For Intel processors under Linux, there is Intel's Math Kernel Library
(<a href="http://www.intel.com/software/products/mkl/">http://www.intel.com/software/products/mkl/</a>).  You are
strongly encouraged to read the MKL User's Guide, which is installed
with the library, before attempting to link to MKL.

   <p>Version 10 of MKL supports two linking models: the default model,
which is backward compatible with version 9 (see below),  and the pure
layered model.  The layered model gives the user fine-grained control
over four different library layers: interface, threading, computation,
and run-time library support. Some examples of linking to MKL using this
layered model are given below. These examples are for GCC compilers on
&lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo;.  The choice of interface layer is important on
&lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; since the Intel Fortran compiler returns complex
values differently from the GNU fortran compiler. You must therefore
use the interface layer that matches your compiler (<code>mkl_intel*</code>
or <code>mkl_gf*</code>).

   <p>R can be linked to a sequential version of MKL by

<pre class="example">     MKL_LIB_PATH=/opt/intel/mkl/10.0.3.020/lib/em64t/
     export LD_LIBRARY_PATH=$MKL_LIB_PATH
     MKL="-L${MKL_LIB_PATH} -lmkl_gf_lp64 -lmkl_sequential -lmkl_lapack -lmkl_core"
     ./configure --with-blas="$MKL" --with-lapack
</pre>
   <p class="noindent">The order of the libraries is important.  The option
<samp><span class="option">--with-lapack</span></samp> is used since MKL contains a copy of LAPACK as
well as BLAS (see <a href="#LAPACK">LAPACK</a>).

   <p>Threaded MKL may be used by replacing the line defining the variable <code>MKL</code>
with

<pre class="example">     MKL="-L${MKL_LIB_PATH} -lmkl_gf_lp64 -lmkl_gnu_thread \
          -lmkl_lapack -lmkl_core -liomp5 -lpthread"
</pre>
   <p class="noindent">The default number of threads will be chosen by the OpenMP* software,
but can be controlled by setting <code>OMP_NUM_THREADS</code> or
<code>MKL_NUM_THREADS</code>.

   <p>Static MKL may be used with

<pre class="example">     MKL="   -L${MKL_LIB_PATH}                               \
             -Wl,--start-group                               \
                     ${MKL_LIB_PATH}/libmkl_gf_lp64.a        \
                     ${MKL_LIB_PATH}/libmkl_gnu_thread.a     \
                     ${MKL_LIB_PATH}/libmkl_core.a           \
             -Wl,--end-group                                 \
             -lgomp -lpthread"
</pre>
   <p class="noindent">(Thanks to Ei-Ji Nakama).

   <p>The default linking model, which is also used by version 9 of MKL, can
be used by

<pre class="example">     --with-blas="-lmkl -lguide -lpthread"
</pre>
   <p class="noindent">This is multi-threaded, but in version 9 the number of threads defaults
to 1.  It can be increased by setting <code>OMP_NUM_THREADS</code>.  (Thanks to
Andy Liaw for the information.)

<p><a name="Shared-BLAS"></a>

<h5 class="subsubsection">A.3.1.5 Shared BLAS</h5>

<p>Note that the BLAS library will be used for many of the add-on packages
as well as for R itself.  This means that it is better to use a
shared/dynamic BLAS library, as most of a static library will be
compiled into the R executable and each BLAS-using package.

   <p>R offers the option of compiling the BLAS into a dynamic library
<code>libRblas</code> stored in <samp><var>R_HOME</var><span class="file">/lib</span></samp> and linking both R
itself and all the add-on packages against that library.

   <p>This is the default on all platforms except AIX unless an external BLAS
is specified and found: for the latter it can be used by specifying the
option <samp><span class="option">--enable-BLAS-shlib</span></samp>, and it can always be disabled via
<samp><span class="option">--disable-BLAS-shlib</span></samp>.

   <p>This has both advantages and disadvantages.

     <ul>
<li>It saves space by having only a single copy of the BLAS routines, which
is helpful if there is an external static BLAS such as is standard for
ATLAS.

     <li>There may be performance disadvantages in using a shared BLAS.  Probably
the most likely is when R's internal BLAS is used and R is
<em>not</em> built as a shared library, when it is possible to build the
BLAS into <samp><span class="file">R.bin</span></samp> (and <samp><span class="file">libR.a</span></samp>) without using
position-independent code.  However, experiments showed that in many
cases using a shared BLAS was as fast, provided high levels (e.g.,
<samp><span class="option">-O3</span></samp>) of compiler optimization are used.

     <li>It is easy to change the BLAS without making to re-install R and all
the add-on packages, since all references to the BLAS go through
<code>libRblas</code>, and that can be replaced.  Note though that any dynamic
libraries the replacement links to will need to be found by the linker:
this may need the library path to be changed in <samp><span class="file">etc/ldpaths</span></samp>. 
</ul>

   <p>Another option to change the BLAS in use is to symlink a dynamic BLAS
library (such as ACML or Goto's) to <samp><var>R_HOME</var><span class="file">/lib/libRblas.so</span></samp>. 
For example, just

<pre class="example">     mv <var>R_HOME</var>/lib/libRblas.so <var>R_HOME</var>/lib/libRblas.so.keep
     ln -s /opt/acml4.0.1/gfortran64_mp/lib/libacml_mp.so <var>R_HOME</var>/lib/libRblas.so
</pre>
   <p>will change the BLAS in use to multithreaded ACML.  A similar link
works for recent versions of the Goto BLAS and for MKL (provided the
appropriate <samp><span class="file">lib</span></samp> directory is in the run-time library path or
<samp><span class="command">ld.so</span></samp> cache).

<p><a name="LAPACK"></a>

<h4 class="subsection">A.3.2 LAPACK</h4>

<p><a name="index-LAPACK-library-63"></a>Provision is made for using an external LAPACK library, principally to
cope with BLAS libraries which contain a copy of LAPACK (such as
<code>libsunperf</code> on Solaris, <code>vecLib</code> on Mac OS X and ACML on
&lsquo;<samp><span class="samp">ix86</span></samp>&rsquo;/&lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Linux and Solaris).  However, the likely
performance gains are thought to be small (and may be negative), and the
default is not to search for a suitable LAPACK library, and this is
definitely <strong>not</strong> recommended.  You can specify a specific LAPACK
library or a search for a generic library by the configuration option
<samp><span class="option">--with-lapack</span></samp>.  The default for <samp><span class="option">--with-lapack</span></samp> is to
check the BLAS library and then look for an external library
&lsquo;<samp><span class="samp">-llapack</span></samp>&rsquo;.  Sites searching for the fastest possible linear
algebra may want to build a LAPACK library using the ATLAS-optimized
subset of LAPACK.  To do so specify something like

<pre class="example">     --with-lapack="-L/path/to/libs -llapack -lcblas"
</pre>
   <p class="noindent">since the ATLAS subset of LAPACK depends on <code>libcblas</code>.  A value
for <samp><span class="option">--with-lapack</span></samp> can be set <em>via</em> the environment
variable
<a name="index-LAPACK_005fLIBS-64"></a><samp><span class="env">LAPACK_LIBS</span></samp>, but this will only be used if <samp><span class="option">--with-lapack</span></samp>
is specified (as the default value is <code>no</code>) and the BLAS library
does not contain LAPACK.

   <p>Since ACML contains a full LAPACK, if selected as the BLAS it can be
used as the LAPACK <em>via</em> <samp><span class="option">--with-lapack</span></samp>.

   <p>If you do use <samp><span class="option">--with-lapack</span></samp>, be aware of potential problems
with bugs in the LAPACK 3.0 sources (or in the posted corrections to those
sources).  In particular, bugs in <code>DGEEV</code> and <code>DGESDD</code> have
resulted in error messages such as

<pre class="example">     DGEBRD gave error code -10
</pre>
   <p class="noindent">(seen with the Debian &lsquo;<samp><span class="samp">-llapack</span></samp>&rsquo; which was current in late 2002,
Fedora Core 4 Extras &lsquo;<samp><span class="samp">-llapack</span></samp>&rsquo; in September 2005 and 64-bit
<code>libsunperf</code> in Forte 7).  Other potential problems are incomplete
versions of the libraries: for example <code>libsunperf</code> from Sun Forte
6.x was missing the entry point for <code>DLANGE</code> and <code>vecLib</code> has
omitted the BLAS routine <code>LSAME</code>.  For problems compiling LAPACK
using recent versions of <code>gcc</code> on &lsquo;<samp><span class="samp">ix86</span></samp>&rsquo; Linux, see
<a href="#New-platforms">New platforms</a>.

   <p>Please <strong>do</strong> bear in mind that using <samp><span class="option">--with-lapack</span></samp> is
`definitely <strong>not</strong> recommended': it is provided <strong>only</strong>
because it is necessary on some platforms.

<p><a name="Caveats"></a>

<h4 class="subsection">A.3.3 Caveats</h4>

<p>As with all libraries, you need to ensure that they and R were
compiled with compatible compilers and flags.  For example, this has
meant that on Sun Sparc using the native compilers the flag
<samp><span class="option">-dalign</span></samp> is needed so <code>libsunperf</code> can be used.

   <p>On some systems it is necessary that an external BLAS/LAPACK was built
with the same FORTRAN compiler used to build R: known problems are
with R built with <samp><span class="command">gfortran</span></samp>, see <a href="#Using-gfortran">Using gfortran</a>.

<p><a name="Configuration-on-Unix"></a>

<h2 class="appendix">Appendix B Configuration on Unix</h2>

<p><a name="Configuration-options"></a>

<h3 class="section">B.1 Configuration options</h3>

<p><samp><span class="command">configure</span></samp> has many options: running

<pre class="example">     ./configure --help
</pre>
   <p class="noindent">will give a list.  Probably the most important ones not covered
elsewhere are (defaults in brackets)

     <dl>
<dt><samp><span class="option">--with-x</span></samp><dd>use the X Window System [yes]
<br><dt><samp><span class="option">--x-includes=</span><var>DIR</var></samp><dd>X include files are in <var>DIR</var>
<br><dt><samp><span class="option">--x-libraries=</span><var>DIR</var></samp><dd>X library files are in <var>DIR</var>
<br><dt><samp><span class="option">--with-readline</span></samp><dd>use readline library (if available) [yes]
<br><dt><samp><span class="option">--enable-R-profiling</span></samp><dd>attempt to compile support for <code>Rprof()</code> [yes]
<br><dt><samp><span class="option">--enable-R-shlib</span></samp><dd>build R as a shared/dynamic library [no]
<br><dt><samp><span class="option">--enable-BLAS-shlib</span></samp><dd>build the BLAS as a shared/dynamic library [no]
</dl>

<p class="noindent">You can use <samp><span class="option">--without-foo</span></samp> or <samp><span class="option">--disable-foo</span></samp> for the
negatives.

   <p>You will want to use <samp><span class="option">--disable-R-profiling</span></samp> if you are building
a profiled executable of R (e.g. with &lsquo;<samp><span class="samp">-pg)</span></samp>&rsquo;.

   <p>Flag <samp><span class="option">--enable-R-shlib</span></samp> causes the make process to build R as
a dynamic (shared) library, typically called <samp><span class="file">libR.so</span></samp>, and link
the main R executable <samp><span class="file">R.bin</span></samp> against that library.  This can
only be done if all the code (including system libraries) can be
compiled into a dynamic library, and there may be a
performance<a rel="footnote" href="#fn-19" name="fnd-19"><sup>19</sup></a> penalty.  So you probably only want this
if you will be using an application which embeds R.  Note that C code
in packages installed on an R system linked with
<samp><span class="option">--enable-R-shlib</span></samp> is linked against the dynamic library and so
such packages cannot be used from an R system built in the default
way.  Also, because packages are linked against R they are on some
OSes also linked against the dynamic libraries R itself is linked
against, and this can lead to symbol conflicts.

   <p>If you need to re-configure R with different options you may need to run
<code>make clean</code> or even <code>make distclean</code> before doing so.

<p><a name="Internationalization-support"></a>

<h3 class="section">B.2 Internationalization support</h3>

<p>R can be compiled with support for multi-byte character sets
(<acronym>MBCS</acronym>), in particular for UTF-8 locales (which are usually
identified by suffix &lsquo;<samp><span class="samp">.utf8</span></samp>&rsquo; or &lsquo;<samp><span class="samp">UTF-8</span></samp>&rsquo;, something like
&lsquo;<samp><span class="samp">en_GB.utf8</span></samp>&rsquo;).  UTF-8 is an encoding of Unicode and in principle
covers all human languages simultaneously: however, a given system may
not have fonts capable of displaying more than a few of these languages.

   <p>Support for MBCS is selected if possible at <samp><span class="command">configure</span></samp> time
(unless disabled with <samp><span class="option">--disable-mbcs</span></samp>).  This will check for a
large number of features, notably support for the C99/UNIX98 wide
character functions, for UTF-8 or MBCS support in X11 and for
<samp><span class="command">iconv</span></samp> with a rich enough functionality.  If enough of these
are found, <code>MBCS</code> will be listed as one of the &ldquo;Additional
capabilities&rdquo;.  Then if R is started in a UTF-8 locale it assumes
that the terminal will supply and display UTF-8-encoded
characters<a rel="footnote" href="#fn-20" name="fnd-20"><sup>20</sup></a>. 
If run in a single-byte locale, R behaves almost exactly as if it was
configured with <samp><span class="option">--disable-mbcs</span></samp>.

   <p>A version of R built with MBCS support can also be run in other
multi-byte locales, for example those using the EUC-JP, EUC-KR and
EUC-TW encodings on Unix-alikes and the code pages for Chinese, Japanese
and Korean on Windows.

   <p>Translation of messages is supported via GNU <code>gettext</code> unless
disabled by the configure option <samp><span class="option">--disable-nls</span></samp> or the
underlying OS has insufficiently standard C functions to support it. 
The <code>configure</code> report will show <code>NLS</code> as one of the
`Additional capabilities' if support has been compiled in, and running
in an English locale (but not the <code>C</code> locale) will include

<pre class="example">       Natural language support but running in an English locale
</pre>
   <p class="noindent">in the greeting on starting R.

<p><a name="Configuration-variables"></a>

<h3 class="section">B.3 Configuration variables</h3>

<p><a name="index-configure-65"></a>If you need or want to set certain configure variables to something
other than their default, you can do that by either editing the file
<samp><span class="file">config.site</span></samp> (which documents all the variables you might want to
set) or on the command line as

<pre class="example">     ./configure <var>VAR</var>=<var>value</var>
</pre>
   <p class="noindent">If you are building in a directory different from the sources, there can
be copies of <samp><span class="file">config.site</span></samp> in the source and the build directories,
and both will be read (in that order).  To force a single file to be
<a name="index-CONFIG_005fSITE-66"></a>read, set the environment variable <samp><span class="env">CONFIG_SITE</span></samp> to the location of
the file.

   <p>These variables are <em>precious</em>, implying that they do not have to
be exported to the environment, are kept in the cache even if not
specified on the command line and checked for consistency between two
configure runs (provided that caching is used), and are kept during
automatic reconfiguration as if having been passed as command line
arguments, even if no cache is used.

   <p>See the variable output section of <code>configure --help</code> for a list of
all these variables.

   <p>If you find you need to alter configure variables, it is worth noting
that some settings may be cached in the file <samp><span class="file">config.cache</span></samp>, and it
is a good idea to remove that file (if it exists) before re-configuring. 
Note that caching is turned <em>off</em> by default: use the command line
option <samp><span class="option">--config-cache</span></samp> (or <samp><span class="option">-C</span></samp>) to enable caching.

<p><a name="Setting-paper-size"></a>

<h4 class="subsection">B.3.1 Setting paper size</h4>

<p><a name="index-R_005fPAPERSIZE-67"></a>One common variable to change is <samp><span class="env">R_PAPERSIZE</span></samp>, which defaults to
&lsquo;<samp><span class="samp">a4</span></samp>&rsquo;, not &lsquo;<samp><span class="samp">letter</span></samp>&rsquo;.  (Valid values are &lsquo;<samp><span class="samp">a4</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">letter</span></samp>&rsquo;, &lsquo;<samp><span class="samp">legal</span></samp>&rsquo; and &lsquo;<samp><span class="samp">executive</span></samp>&rsquo;.)

   <p>This is used both when configuring R to set the default, and when
running R to override the default.  It is also used to set the
papersize when making DVI and PDF manuals.

   <p>The configure default will most often be &lsquo;<samp><span class="samp">a4</span></samp>&rsquo; if <samp><span class="env">R_PAPERSIZE</span></samp>
is unset.  (If the (Debian Linux) program <samp><span class="command">paperconf</span></samp> is found
<a name="index-PAPERSIZE-68"></a>or the environment variable <samp><span class="env">PAPERSIZE</span></samp> is set, these are used to
produce the default.)

<p><a name="Setting-the-browser"></a>

<h4 class="subsection">B.3.2 Setting the browser</h4>

<p><a name="index-R_005fBROWSER-69"></a>Another precious variable is <samp><span class="env">R_BROWSER</span></samp>, the default browser, which
should take a value of an executable in the user's path or specify
a full path.

<p><a name="Compilation-flags"></a>

<h4 class="subsection">B.3.3 Compilation flags</h4>

<p>If you have libraries and header files, e.g., for <acronym>GNU</acronym>
readline, in non-system directories, use the variables <code>LDFLAGS</code>
(for libraries, using &lsquo;<samp><span class="samp">-L</span></samp>&rsquo; flags to be passed to the linker) and
<code>CPPFLAGS</code> (for header files, using &lsquo;<samp><span class="samp">-I</span></samp>&rsquo; flags to be passed to
the C/C++ preprocessors), respectively, to specify these locations. 
These default to &lsquo;<samp><span class="samp">-L/usr/local/lib</span></samp>&rsquo; (<code>LDFLAGS</code>,
&lsquo;<samp><span class="samp">-L/usr/local/lib64</span></samp>&rsquo; on most 64-bit Linux OSes) and
&lsquo;<samp><span class="samp">-I/usr/local/include</span></samp>&rsquo; (<code>CPPFLAGS</code>) to catch the most common
cases.  If libraries are still not found, then maybe your
compiler/linker does not support re-ordering of <samp><span class="option">-L</span></samp> and
<samp><span class="option">-l</span></samp> flags (this has been reported to be a problem on HP-UX with
the native <samp><span class="command">cc</span></samp>).  In this case, use a different compiler (or a
front end shell script which does the re-ordering).

   <p>These flags can also be used to build a faster-running version of R. 
On most platforms using <samp><span class="command">gcc</span></samp>, having &lsquo;<samp><span class="samp">-O3</span></samp>&rsquo; in
<code>CFLAGS</code> produces worthwhile performance gains.  On systems using
the GNU linker (especially those using R as a shared library), it is
likely that including &lsquo;<samp><span class="samp">-Wl,-O1</span></samp>&rsquo; in <code>LDFLAGS</code> is worthwhile,
and on recent systems<a rel="footnote" href="#fn-21" name="fnd-21"><sup>21</sup></a>
&lsquo;<samp><span class="samp">'-Bdirect,--hash-style=both,-Wl,-O1'</span></samp>&rsquo; is recommended at
<a href="http://lwn.net/Articles/192624/">http://lwn.net/Articles/192624/</a>.  Tuning compilation to a
specific CPU family (e.g. &lsquo;<samp><span class="samp">-mtune=core2</span></samp>&rsquo; for <samp><span class="command">gcc</span></samp>) can
give worthwhile performance gains, especially on older architectures
such as &lsquo;<samp><span class="samp">ix86</span></samp>&rsquo;.

<p><a name="Making-manuals"></a>

<h4 class="subsection">B.3.4 Making manuals</h4>

<p><a name="index-R_005fRD4DVI-70"></a><a name="index-R_005fRD4PDF-71"></a><a name="index-R_005fPAPERSIZE-72"></a>The default settings for making the manuals are controlled by
<samp><span class="env">R_RD4PDF</span></samp>, <samp><span class="env">R_RD4DVI</span></samp> and <samp><span class="env">R_PAPERSIZE</span></samp>.

<p><a name="Setting-the-shell"></a>

<h3 class="section">B.4 Setting the shell</h3>

<p>By default the shell scripts such as <samp><span class="file">R</span></samp> will be &lsquo;<samp><span class="samp">#!/bin/sh</span></samp>&rsquo;
scripts (or using the <samp><span class="env">SHELL</span></samp> chosen by <samp><span class="file">configure</span></samp>).  This is
almost always satisfactory, but on a few systems <samp><span class="file">/bin/sh</span></samp> is not a
Bourne shell or clone, and the shell to be used can be changed by
setting the configure variable <samp><span class="env">R_SHELL</span></samp> to a suitable value (a full
path to a shell, e.g. <samp><span class="file">/usr/local/bin/bash</span></samp>).

<p><a name="Using-make"></a>

<h3 class="section">B.5 Using make</h3>

<p><a name="index-make-73"></a>
To compile R, you will most likely find it easiest to use GNU
<samp><span class="command">make</span></samp>.  On Solaris 2.6/7/8 in particular, you need a version of
<acronym>GNU</acronym> <samp><span class="command">make</span></samp> different from 3.77; 3.79.1 and later work
fine, as does the Sun <samp><span class="command">make</span></samp>.  The native <samp><span class="command">make</span></samp> is
reported to fail on SGI Irix 6.5 and Alpha/OSF1 (aka Tru64).

   <p>To build in a separate directory you need a <samp><span class="command">make</span></samp> that uses the
<code>VPATH</code> variable, for example <acronym>GNU</acronym> <samp><span class="command">make</span></samp>, or Sun
<samp><span class="command">make</span></samp> on Solaris 2.7 or later.

   <p><samp><span class="command">dmake</span></samp> has also been used. e.g, on Solaris 10.

   <p>If you want to use a <samp><span class="command">make</span></samp> by another name, for example if your
<acronym>GNU</acronym> <samp><span class="command">make</span></samp> is called &lsquo;<samp><span class="samp">gmake</span></samp>&rsquo;, you need to set the
variable <code>MAKE</code> at configure time, for example

   <p><a name="index-configure-74"></a>
<pre class="example">     ./configure MAKE=gmake
</pre>
   <p>Note the comment in <a href="#Installation">Installation</a> about using a parallel
<samp><span class="command">make</span></samp>.

<p><a name="Using-FORTRAN"></a>

<h3 class="section">B.6 Using FORTRAN</h3>

<p><a name="index-FORTRAN-75"></a>

   <p>To compile R, you need a FORTRAN compiler.  The default
is to search for
<!-- F95_compilers in m4/R.m4: -->
<samp><span class="command">f95</span></samp>, <samp><span class="command">fort</span></samp>, <samp><span class="command">xlf95</span></samp>,
<samp><span class="command">ifort</span></samp>, <samp><span class="command">ifc</span></samp>, <samp><span class="command">efc</span></samp>, <samp><span class="command">pgf95</span></samp>
<samp><span class="command">lf95</span></samp>, <samp><span class="command">gfortran</span></samp>, <samp><span class="command">ftn</span></samp>, <samp><span class="command">g95</span></samp>,
<!-- F90 compilers in m4/R.m4: -->
<samp><span class="command">f90</span></samp>, <samp><span class="command">xlf90</span></samp>, <samp><span class="command">pghpf</span></samp>, <samp><span class="command">pgf90</span></samp>,
<samp><span class="command">epcf90</span></samp>,
<!-- F77 compilers in m4/R.m4: -->
<samp><span class="command">g77</span></samp>, <samp><span class="command">f77</span></samp>, <samp><span class="command">xlf</span></samp>, <samp><span class="command">frt</span></samp>,
<samp><span class="command">pgf77</span></samp>, <samp><span class="command">cf77</span></samp>, <samp><span class="command">fort77</span></samp>, <samp><span class="command">fl32</span></samp>,
<samp><span class="command">af77</span></samp> (in that order)<a rel="footnote" href="#fn-22" name="fnd-22"><sup>22</sup></a>, and use whichever is found first; if none is found,
R cannot be compiled. 
<!-- GCC_Fortran_compiler in m4/R.m4: -->
However, if <samp><span class="command">CC</span></samp> is <samp><span class="command">gcc</span></samp>, the matching FORTRAN compiler
(<samp><span class="command">g77</span></samp> for <samp><span class="command">gcc</span></samp>&nbsp;3 and <code>gfortran</code> for
<samp><span class="command">gcc</span></samp>&nbsp;4) is used if available.

   <p>The search mechanism can be changed using the configure variable
<code>F77</code> which specifies the command that runs the FORTRAN 77
compiler.  If your FORTRAN compiler is in a non-standard location, you
should set the environment variable <samp><span class="env">PATH</span></samp> accordingly before
running <samp><span class="command">configure</span></samp>, or use the configure variable <code>F77</code> to
specify its full path.

   <p>If your FORTRAN libraries are in slightly peculiar places, you should
<a name="index-LD_005fLIBRARY_005fPATH-76"></a>also look at <samp><span class="env">LD_LIBRARY_PATH</span></samp> or your system's equivalent to make
sure that all libraries are on this path.

   <p>Note that only FORTRAN compilers which convert identifiers to lower case
are supported.

   <p>You must set whatever compilation flags (if any) are needed to ensure
that FORTRAN <code>integer</code> is equivalent to a C <code>int</code> pointer and
FORTRAN <code>double precision</code> is equivalent to a C <code>double</code>
pointer.  This is checked during the configuration process.

   <p>Some of the FORTRAN code makes use of <code>COMPLEX*16</code> variables, which
is a Fortran 90 extension.  This is checked for at configure
time<a rel="footnote" href="#fn-23" name="fnd-23"><sup>23</sup></a>, but you may need to avoid
compiler flags<a rel="footnote" href="#fn-24" name="fnd-24"><sup>24</sup></a> asserting
FORTRAN 77 compliance.

   <p><a name="index-BLAS-library-77"></a>For performance reasons<a rel="footnote" href="#fn-25" name="fnd-25"><sup>25</sup></a> you may want to choose a FORTRAN 90/95 compiler.

   <p>It is possible to use <samp><span class="command">f2c</span></samp>, the FORTRAN-to-C converter
(<a href="http://www.netlib.org/f2c">http://www.netlib.org/f2c</a>), via a script.  (An example script
is given in <samp><span class="file">scripts/f77_f2c</span></samp>: this can be customized by setting
the environment variables <samp><span class="env">F2C</span></samp>, <samp><span class="env">F2CLIBS</span></samp>, <samp><span class="env">CC</span></samp> and
<samp><span class="env">CPP</span></samp>.)  You may need to ensure that the FORTRAN type <code>integer</code>
is translated to the C type <code>int</code>.  Normally <samp><span class="file">f2c.h</span></samp> contains
&lsquo;<samp><span class="samp">typedef long int integer;</span></samp>&rsquo;, which will work on a 32-bit platform
but not on a 64-bit platform.  If your compiler is not <samp><span class="command">gcc</span></samp> you
will need to set <samp><span class="env">FPICFLAGS</span></samp> appropriately.

<p><a name="Using-gfortran"></a>

<h4 class="subsection">B.6.1 Using gfortran</h4>

<p><samp><span class="command">gfortran</span></samp> is the F95 compiler that is part of
<samp><span class="command">gcc</span></samp>&nbsp;4.<var>x</var>.<var>y</var>.  There were problems compiling
R with the first release (<samp><span class="command">gcc</span></samp>&nbsp;4.0.0) and more with
pre-releases, but these are resolved in later versions.

   <p>On Linux &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; systems there is an incompatibility in the
return conventions for double-complex functions between
<samp><span class="command">gfortran</span></samp> and <samp><span class="command">g77</span></samp> which results in the final example
in <code>example(eigen)</code> hanging or segfaulting under external BLASs
built under <samp><span class="command">g77</span></samp>.  This should be detected by a
<samp><span class="command">configure</span></samp> test.

   <p>The default <code>FFLAGS</code> chosen (by <samp><span class="command">autoconf</span></samp>) for a GNU
FORTRAN compiler is &lsquo;<samp><span class="samp">-g -O2</span></samp>&rsquo;.  This seems not to be documented for
<samp><span class="command">gfortran</span></samp>, and has caused problems (segfaults and infinite
loops) on &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Linux (and the optimizer will be shared with
other platforms on that CPU type).  A maximum optimization of &lsquo;<samp><span class="samp">-O</span></samp>&rsquo;
is recommended there.

<p><a name="Compile-and-load-flags"></a>

<h3 class="section">B.7 Compile and load flags</h3>

<p>A wide range of flags can be set in the file <samp><span class="file">config.site</span></samp> or as
configure variables on the command line.  We have already mentioned

     <dl>
<dt><code>CPPFLAGS</code><dd>header file search directory (<samp><span class="option">-I</span></samp>) and any other miscellaneous
options for the C and C++ preprocessors and compilers
<br><dt><code>LDFLAGS</code><dd>path (<samp><span class="option">-L</span></samp>), stripping (<samp><span class="option">-s</span></samp>) and any other miscellaneous
options for the linker
</dl>

<p class="noindent">and others include

     <dl>
<dt><code>CFLAGS</code><dd>debugging and optimization flags, C
<br><dt><code>MAIN_CFLAGS</code><dd>ditto, for compiling the main program
<br><dt><code>SHLIB_CFLAGS</code><dd>for shared libraries
<br><dt><code>FFLAGS</code><dd>debugging and optimization flags, FORTRAN
<br><dt><code>SAFE_FFLAGS</code><dd>ditto for source files which need exact floating point behaviour
<br><dt><code>MAIN_FFLAGS</code><dd>ditto, for compiling the main program
<br><dt><code>SHLIB_FFLAGS</code><dd>for shared libraries
<br><dt><code>MAIN_LDFLAGS</code><dd>additional flags for the main link
<br><dt><code>SHLIB_LDFLAGS</code><dd>additional flags for linking the shared libraries
<br><dt><code>LIBnn</code><dd>the primary library directory, <samp><span class="file">lib</span></samp> or <samp><span class="file">lib64</span></samp>
<br><dt><code>CPICFLAGS</code><dd>special flags for compiling C code to be turned into a shared library
<br><dt><code>FPICFLAGS</code><dd>special flags for compiling Fortran code to be turned into a shared library
<br><dt><code>CXXPICFLAGS</code><dd>special flags for compiling C++ code to be turned into a shared library
<br><dt><code>FCPICFLAGS</code><dd>special flags for compiling Fortran 95 code to be turned into a shared library
<br><dt><code>DEFS</code><dd>defines to be used when compiling C code in R itself
</dl>

<p class="noindent">Library paths specified as <samp><span class="option">-L/lib/path</span></samp> in <code>LDFLAGS</code> are
<a name="index-LD_005fLIBRARY_005fPATH-78"></a>collected together and prepended to <samp><span class="env">LD_LIBRARY_PATH</span></samp> (or your
system's equivalent), so there should be no need for <samp><span class="option">-R</span></samp> or
<samp><span class="option">-rpath</span></samp> flags.

   <p>Variables such as <samp><span class="env">CPICFLAGS</span></samp> are determined where possible by
<samp><span class="command">configure</span></samp>.  Some systems allows two types of PIC flags, for
example &lsquo;<samp><span class="samp">-fpic</span></samp>&rsquo; and &lsquo;<samp><span class="samp">-fPIC</span></samp>&rsquo;, and if they differ the first
allows only a limited number of symbols in a shared library.  Since R
as a shared library has about 6200 symbols, if in doubt use the larger
version.

   <p>To compile a profiling version of R, one might for example want to
use &lsquo;<samp><span class="samp">MAIN_CFLAGS=-pg</span></samp>&rsquo;, &lsquo;<samp><span class="samp">MAIN_FFLAGS=-pg</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">MAIN_LDFLAGS=-pg</span></samp>&rsquo; on platforms where &lsquo;<samp><span class="samp">-pg</span></samp>&rsquo; cannot be used
with position-independent code.

   <p><strong>Beware</strong>: it may be necessary to set <code>CFLAGS</code> and
<code>FFLAGS</code> in ways compatible with the libraries to be used: one
possible issue is the alignment of doubles, another is the way
structures are passed.

   <p>On some platforms <samp><span class="command">configure</span></samp> will select additional flags for
<code>CFLAGS</code>, <code>CPPFLAGS</code>, <code>FFLAGS</code>, <code>CXXFLAGS</code> and
<code>LIBS</code> in <code>R_XTRA_CFLAGS</code> (and so on).  These are for options
which are always required, for example to force <acronym>IEC</acronym>&nbsp;60559
compliance.

<p><a name="Platform-notes"></a>

<h2 class="appendix">Appendix C Platform notes</h2>

<p>This section provides some notes on building R on different Unix-like
platforms.  These notes are based on tests run on one or two systems in
each case with particular sets of compilers and support libraries. 
Success in building R depends on the proper installation and functioning
of support software; your results may differ if you have other versions
of compilers and support libraries.

<p><a name="X11-issues"></a>

<h3 class="section">C.1 X11 issues</h3>

<p>The &lsquo;<samp><span class="samp">X11()</span></samp>&rsquo; graphics device is the one started automatically on
Unix-alikes when plotting.  As its name implies, it displays on a (local
or remote) X server, and relies on the services and in particular the
fonts provided by the X server.  So if you sometimes use R at a
console and sometimes remotely from an X11 session running on a Windows
machine, you may have to setup the fonts differently for the two usages.

   <p>The `modern' version of the &lsquo;<samp><span class="samp">X11()</span></samp>&rsquo; device is based on &lsquo;<samp><span class="samp">cairo</span></samp>&rsquo;
graphics and uses &lsquo;<samp><span class="samp">fontconfig</span></samp>&rsquo; to pick and render fonts.  This is
done on the server, and although there can be selection issues, they are
more amenable than the issues with &lsquo;<samp><span class="samp">X11()</span></samp>&rsquo; discussed in the rest of
this section.

   <p>When X11 was designed, most displays were around 75dpi, whereas today
they are of the order of 100dpi or even higher.  If you find that X11()
is reporting<a rel="footnote" href="#fn-26" name="fnd-26"><sup>26</sup></a> missing font sizes, especially larger ones, it is likely
that you are not using scalable fonts and have not installed the 100dpi
versions of the X11 fonts.  The names and details differ by system, but
will likely have something like Fedora's
<pre class="example">     xorg-x11-fonts-75dpi
     xorg-x11-fonts-100dpi
     xorg-x11-fonts-truetype
     xorg-x11-fonts-Type1
     xorg-x11-fonts-cyrillic
</pre>
   <p class="noindent">and you need to ensure that the &lsquo;<samp><span class="samp">-100dpi</span></samp>&rsquo; versions are installed
and on the X11 font path (check via <samp><span class="command">xset -q</span></samp>).  The
&lsquo;<samp><span class="samp">X11()</span></samp>&rsquo; device does try to set a pointsize and not a pixel size:
laptop users may find the default setting of 12 too large (although very
frequently laptop screens are set to a fictitious dpi to appear like a
scaled-down desktop screen).

   <p>More complicated problems can occur in non-Western-European locales, so
if you are using one, the first thing to check is that things work in
the <code>C</code> locale.  The likely issues are a failure to find any fonts
or glyphs being rendered incorrectly (often as a pair of ASCII
characters).  X11 works by being asked for a font specification and
coming up with its idea of a close match.  For text (as distinct from
the symbols used by plotmath), the specification is the first element of
the option <code>"X11fonts"</code> which defaults to

<pre class="example">     "-adobe-helvetica-%s-%s-*-*-%d-*-*-*-*-*-*-*"
</pre>
   <p>If you are using a single-byte encoding, for example ISO 8859-2 in
Eastern Europe or KOI8-R in Russian, use <samp><span class="command">xlsfonts</span></samp> to find an
appropriate family of fonts in your encoding (the last field in the
listing).  If you find none, it is likely that you need to install
further font packages, such as &lsquo;<samp><span class="samp">xorg-x11-fonts-cyrillic</span></samp>&rsquo; shown in
the listing above.

   <p>Multi-byte encodings (most commonly UTF-8) are even more complicated. 
There are few fonts in &lsquo;<samp><span class="samp">iso10646-1</span></samp>&rsquo;, the Unicode encoding, and they
only contain a subset of the available glyphs (and are often fixed-width
designed for use in terminals).  In such locales <em>fontsets</em> are
used, made up of fonts encoded in other encodings.  If the locale you
are using has an entry in the &lsquo;<samp><span class="samp">XLC_LOCALE</span></samp>&rsquo; directory (typically
<samp><span class="file">/usr/X11R6/lib/X11/locale</span></samp>, it is likely that all you need to do
is to pick a suitable font specification that has fonts in the encodings
specified there.  If not, you may have to get hold of a suitable locale
entry for X11.  This may mean that, for example, Japanese text can be
displayed when running in &lsquo;<samp><span class="samp">ja_JP.utf8</span></samp>&rsquo; but not when running in
&lsquo;<samp><span class="samp">en_GB.utf8</span></samp>&rsquo; on the same machine (although on some systems many
UTF-8 X11 locales are aliased to &lsquo;<samp><span class="samp">en_US.utf8</span></samp>&rsquo; which covers several
character sets, e.g. ISO 8859-1 (Western European), JISX0208 (Kanji),
KSC5601 (Korean), GB2312 (Chinese Han) and JISX0201 (Kana)).

   <p>On some systems scalable fonts are available covering a wide range of
glyphs.  One source is TrueType fonts, and these can provide high
coverage.  Another is Type 1 fonts: the URW set of Type 1 fonts provides
standard typefaces such as Helvetica with a larger coverage of Unicode
glyphs than the standard X11 bitmaps, including Cyrillic.  These are
generally not part of the default install, and the X server may need to
be configured to use them.  They might be under the X11 <samp><span class="file">fonts</span></samp>
directory or elsewhere, for example,

<pre class="example">     /usr/share/fonts/default/Type1
     /usr/share/fonts/ja/TrueType
</pre>
   <p><a name="Linux"></a>

<h3 class="section">C.2 Linux</h3>

<p><a name="index-Linux-79"></a>
Linux is the main development platform for R, so compilation from the
sources is normally straightforward with the standard compilers.

   <p>Remember that some package management systems (such as <acronym>RPM</acronym> and
deb) make a distinction between the user version of a package and the
developer version.  The latter usually has the same name but with the
extension &lsquo;<samp><span class="samp">-devel</span></samp>&rsquo; or &lsquo;<samp><span class="samp">-dev</span></samp>&rsquo;: you need both versions
installed.  So please check the <code>configure</code> output to see if the
expected features are detected: if for example &lsquo;<samp><span class="samp">readline</span></samp>&rsquo; is
missing add the developer package.  (On most systems you will also need
&lsquo;<samp><span class="samp">ncurses</span></samp>&rsquo; and its developer package, although these should be
dependencies of the &lsquo;<samp><span class="samp">readline</span></samp>&rsquo; package(s).)

   <p>When R has been installed from a binary distribution there are
sometimes problems with missing components such as the FORTRAN
compiler.  Searching the &lsquo;<samp><span class="samp">R-help</span></samp>&rsquo; archives will normally reveal
what is needed.

   <p>It seems that &lsquo;<samp><span class="samp">ix86</span></samp>&rsquo; Linux accepts non-PIC code in shared
libraries, but this is not necessarily so on other platforms, in
particular for 64-bit CPUs such as &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo;.  So care can be
needed with BLAS libraries and when building R as a shared library to
ensure that position-independent code is used in any static libraries
(such as the Tcl/Tk libraries, <code>libpng</code>, <code>libjpeg</code> and
<code>zlib</code>) which might be linked against.  Fortunately these are
normally built as shared libraries with the exception of the ATLAS BLAS
libraries.

   <p>For platforms with both 64- and 32-bit support, it is likely that

<pre class="example">     LDFLAGS="-L/usr/local/lib64 -L/usr/local/lib"
</pre>
   <p class="noindent">is appropriate since most (but not all) software installs its 64-bit
libraries in <samp><span class="file">/usr/local/lib64</span></samp>.  To build a 32-bit version of R
on &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; with Fedora 8 we used

<pre class="example">     CC="gcc -m32"
     CXX="g++ -m32"
     F77="gfortran -m32"
     FC=${F77}
     OBJC=${CC}
     LDFLAGS="-L/usr/local/lib"
     LIBnn=lib
</pre>
   <p>64-bit versions of Linux are built with support for files &gt; 2Gb, and
32-bit versions will be if possible unless <samp><span class="option">--disable-largefile</span></samp>
is specified.

   <p>R used to include the compiler flag <samp><span class="option">-mieee-fp</span></samp>, but it seems
this was really an alias for the linker flag <samp><span class="option">-lieee</span></samp>.  Neither
are needed for a modern Linux (e.g. using <code>glibc</code> 2.2/3/4) but
could conceivably be needed on an older version.  <code>glibc</code> 2.1
required <samp><span class="option">-D__NO_MATH_INLINES</span></samp> to achieve
<acronym>IEC</acronym>&nbsp;60059-compliance for <code>exp</code>, and this is included
in <code>R_XTRA_CFLAGS</code> if required.

   <p>There are known problems with several early versions of
<samp><span class="command">gcc</span></samp>&nbsp;4, but <samp><span class="command">gcc</span></samp>&nbsp;4.1.0 and later seem to
cause no special difficulties.

<!-- It has been reported that using @command{gcc}@tie{}4.0.3 on -->
<!-- @cputype{ppc64} needed the compiler flag @option{-mminimal-toc} to avoid -->
<!-- errors when linking @R{} as a shared library. -->
   <p>To build a 64-bit version of R on &lsquo;<samp><span class="samp">ppc64</span></samp>&rsquo; (also known as
&lsquo;<samp><span class="samp">powerpc64</span></samp>&rsquo;) with <samp><span class="command">gcc</span></samp>&nbsp;4.1.1, Ei-Ji Nakama used

<pre class="example">     CC="gcc -m64"
     CXX="gxx -m64"
     F77="gfortran -m64"
     FC="gfortran -m64"
     CFLAGS="-mminimal-toc -fno-optimize-sibling-calls -g -O2"
     FFLAGS="-mminimal-toc -fno-optimize-sibling-calls -g -O2"
</pre>
   <p class="noindent">the additional flags being needed to problems linking against
<samp><span class="file">libnmath.a</span></samp> and when linking R as a shared library.

   <p>On some earlier<a rel="footnote" href="#fn-27" name="fnd-27"><sup>27</sup></a> <code>glibc</code> systems,
&lsquo;<samp><span class="samp">-fgnu89-inline</span></samp>&rsquo; needs to be added to <samp><span class="option">CFLAGS</span></samp> when using
<samp><span class="command">gcc</span></samp>&nbsp;4.3.x, since <samp><span class="file">wchar.h</span></samp> is not set up properly
for C99-style inlines.

<p><a name="Intel-compilers"></a>

<h4 class="subsection">C.2.1 Intel compilers</h4>

<p>Intel compilers have been used under &lsquo;<samp><span class="samp">ix86</span></samp>&rsquo; and &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo;
Linux and R contains code to set the FPU options suitably.  Brian
Ripley tried version 9.0 of the compilers for &lsquo;<samp><span class="samp">ix86</span></samp>&rsquo; on
Fedora Core 3 <em>via</em>

<pre class="example">     CC=icc
     F77=ifort
     CXX=icpc
     ICC_LIBS=/opt/compilers/intel/cc/9.0/lib
     IFC_LIBS=/opt/compilers/intel/fc/9.0/lib
     LDFLAGS="-L$ICC_LIBS -L$IFC_LIBS -L/usr/local/lib"
     SHLIB_CXXLD=icpc
</pre>
   <p class="noindent">and adding optimization flags failed: at least <samp><span class="file">src/main/regex.c</span></samp>
and <samp><span class="file">src/modules/lapack/dlamc.f</span></samp> needed to be compiled without
optimization.  For &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; on Fedora Core 5 he used

<pre class="example">     CC=icc
     CFLAGS="-g -O3 -wd188 -ip"
     F77=ifort
     FLAGS="-g -O3"
     CXX=icpc
     CXXFLAGS="-g -O3"
     FC=ifort
     FCFLAGS="-g -O3 -mp"
     ICC_LIBS=/opt/compilers/intel/cce/9.1.039/lib
     IFC_LIBS=/opt/compilers/intel/fce/9.1.033/lib
     LDFLAGS="-L$ICC_LIBS -L$IFC_LIBS -L/usr/local/lib64"
     SHLIB_CXXLD=icpc
</pre>
   <p class="noindent"><samp><span class="command">configure</span></samp> will add &lsquo;<samp><span class="samp">-c99</span></samp>&rsquo; to <code>CC</code> for
C99-compliance.  This causes warnings with <code>icc</code> 10, so use
<code>CC="icc -std=c99"</code> there.  R will add &lsquo;<samp><span class="samp">-mp</span></samp>&rsquo; in
<code>R_XTRA_{C,F,CXX}FLAGS</code> to maintain correct
<acronym>IEC</acronym>&nbsp;60559 arithmetic.  The flag <samp><span class="option">-wd188</span></samp>
suppresses a large number of warnings about the enumeration type
&lsquo;<samp><span class="samp">Rboolean</span></samp>&rsquo;.  Because the Intel C compiler sets &lsquo;<samp><span class="samp">__GNUC__</span></samp>&rsquo;
without complete emulation of <samp><span class="command">gcc</span></samp>, we suggest adding
<code>CPPFLAGS=-no-gcc</code>.

   <p>For some comments on building on an Itanium (&lsquo;<samp><span class="samp">ia64</span></samp>&rsquo;) Linux
system with <samp><span class="command">gcc</span></samp> or the Intel compilers see
<a href="http://www.nakama.ne.jp/memo/ia64_linux/">http://www.nakama.ne.jp/memo/ia64_linux/</a>.

<p><a name="PGI-compilers"></a>

<h4 class="subsection">C.2.2 PGI compilers</h4>

<p>Jennifer Lai used the Portland Group compilers on &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; to
build pre-2.2.0.  Updated versions of the settings she used are

<pre class="example">     PG_HOME=/usr/pgi/linux86-64/6.0
     CC=pgcc
     CFLAGS="-g -O2 -Kieee"
     CPPFLAGS="-I$PG_HOME/include -I$PG_HOME/include/CC"
     F77=pgf77
     FFLAGS="-g -O2 -Kieee"
     CXX=pgCC
     CXXFLAGS="-g -O2 -Kieee"
     FC=pgf95
     FCFLAGS="-g -O2 -Kieee"
     SHLIB_CXXLDFLAGS=-shared
     SHLIB_LDFLAGS=-shared
     LDFLAGS="-L$PG_HOME/libso -L/usr/lib64"
</pre>
   <p class="noindent">Note particularly the last, which is needed to ensure that a shared
version of <code>libc</code> is found.  The flag <samp><span class="option">-Kieee</span></samp> ensures strict
compliance to IEC60659.  Also,
<a href="http://www.amd.com/us-en/assets/content_type/DownloadableAssets/dwamd_PGI_nov603.pdf">http://www.amd.com/us-en/assets/content_type/DownloadableAssets/dwamd_PGI_nov603.pdf</a>
suggests that <samp><span class="option">-pc64</span></samp> may be desirable.

<p><a name="SunStudio-compilers"></a>

<h4 class="subsection">C.2.3 SunStudio compilers</h4>

<p>Brian Ripley tested the SunStudio 12 (aka Sun Ceres) compilers
(<a href="http://developers.sun.com/sunstudio/index.jsp">http://developers.sun.com/sunstudio/index.jsp</a>) on
&lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Linux with

<pre class="example">     CC=suncc
     CFLAGS="-xO5 -xc99 -xlibmil -nofstore"
     CPICFLAGS=-Kpic
     F77=sunf95
     FFLAGS="-O5 -libmil -nofstore"
     FPICFLAGS=-Kpic
     CXX=sunCC
     CXXFLAGS="-xO5 -xlibmil -nofstore"
     CXXPICFLAGS=-Kpic
     FC=sunf95
     FCFLAGS=$FFLAGS
     FCPICFLAGS=-Kpic
     LDFLAGS=-L/opt/sunstudio12/lib/amd64
     SHLIB_LDFLAGS=-shared
     SHLIB_CXXLDFLAGS="-G -lCstd"
     SHLIB_FCLDFLAGS=-G
     SAFE_FFLAGS="-O5 -libmil"
</pre>
   <p class="noindent"><samp><span class="option">-m64</span></samp> could be added, but was the default.  Do not use
<samp><span class="option">-fast</span></samp>: see the warnings under Solaris.

   <p>The resulting build of R was not quite as fast as that built with
<samp><span class="command">gcc</span></samp>&nbsp;4.3.2 at &lsquo;<samp><span class="samp">-O3</span></samp>&rsquo;.

<p><a name="Mac-OS-X"></a>

<h3 class="section">C.3 Mac OS X</h3>

<p><a name="index-Mac-OS-X-80"></a>
You can build R as a Unix application on Mac OS X using the Apple
Developer Tools (`Xcode') and <samp><span class="command">g77</span></samp> or <samp><span class="command">gfortran</span></samp>.  You
will also need to install an X sub-system or configure with
<samp><span class="option">--without-x</span></samp>.  The X window manager is part of the standard Mac
OS X distribution since Mac OS X version 10.3 (Panther), but it is
typically not pre-installed prior to 10.5 (Leopard).

   <p>For more information on how to find these tools please read the
<a href="http://CRAN.R-project.org/bin/macosx/RMacOSX-FAQ.html">R for Mac OS X <acronym>FAQ</acronym></a>.

   <p>If you use the X window manager and prefer <code>Terminal.app</code> to
<code>xterm</code>, you should be aware that R, like many Unix tools, uses
<a name="index-DISPLAY-81"></a>the existence of a <samp><span class="env">DISPLAY</span></samp> environment variable to determine
whether an X system is running.  This affects the default graphics
device for the command-line version of R and the behaviour of the
<code>png</code> and <code>jpeg</code> devices.

   <p><a name="index-BLAS-library-82"></a><a name="index-LAPACK-library-83"></a>The <code>vecLib</code> library can be used <em>via</em> the (default)
configuration options

<pre class="example">     --with-blas="-framework vecLib" --with-lapack
</pre>
   <p class="noindent">to provide higher-performance versions of the BLAS and LAPACK
routines.  Building R without these options <em>via</em>

<pre class="example">     --without-blas --without-lapack
</pre>
   <p class="noindent">can be done (and is provided as an alternative in the binary
distribution).

<p><a name="64-bit-builds"></a>
<a name="g_t64_002dbit-builds"></a>

<h4 class="subsection">C.3.1 64-bit builds</h4>

<p>64-bit builds are supported on 10.5.x (Leopard) only.  All
that is needed is to select suitable compiler options, e.g. for recent
Intel Macs

<pre class="example">     CC='gcc -arch x86_64'
     CXX='g++ -arch x86_64'
     F77='gfortran -arch x86_64'
     FC='gfortran -arch x86_64'
     OBJC='gcc -arch x86_64'
</pre>
   <p class="noindent">in <samp><span class="file">config.site</span></samp> or on the <samp><span class="command">configure</span></samp> command line.

<p><a name="Solaris"></a>

<h3 class="section">C.4 Solaris</h3>

<p><a name="index-Solaris-84"></a>

<p><a name="Solaris-10-and-Open-Solaris"></a>

<h4 class="subsection">C.4.1 Solaris 10 and Open Solaris</h4>

<p>R has been built successfully on Solaris 10 (both Sparc and
&lsquo;<samp><span class="samp">x86</span></samp>&rsquo;) using <samp><span class="command">gcc</span></samp>&nbsp;3/<samp><span class="command">g77</span></samp>,
<samp><span class="command">gcc</span></samp>&nbsp;4/<samp><span class="command">gfortran</span></samp> and the (zero cost) Sun Studio
(aka Ceres) 11/12 compilers.  Sun packages for R are available from
<a href="http://www.sunfreeware.com/">http://www.sunfreeware.com/</a> for both architectures.  (Recent Sun
machines are Opterons (&lsquo;<samp><span class="samp">x86-64</span></samp>&rsquo;) rather than &lsquo;<samp><span class="samp">x86</span></samp>&rsquo;, but
32-bit &lsquo;<samp><span class="samp">x86</span></samp>&rsquo; executables are the default.)

   <p>There are also reports of success on OpenSolaris (aka Solaris Express
Community Edition, and sometimes as Solaris 11) on &lsquo;<samp><span class="samp">x86</span></samp>&rsquo;.

   <p>The Solaris versions of several of the tools needed to build R
(e.g. <samp><span class="command">make</span></samp>, <samp><span class="command">ar</span></samp> and <samp><span class="command">ld</span></samp>) are in
<samp><span class="file">/usr/ccs/bin</span></samp>, so if using those tools ensure this is in your
path.

   <p>Modern Solaris systems allow a large selection of Open Source software
to be installed from <a href="http://www.opencsw.org">http://www.opencsw.org</a> (formerly
<a href="http://www.blastwave.org">http://www.blastwave.org</a>) via <samp><span class="command">pkg-get</span></samp>: a Sparc Solaris 10
system came with <code>libreadline</code> and <code>libiconv</code> and a choice of
<code>gcc3</code> and <code>gcc4</code> compilers, installed under <samp><span class="file">/opt/csw</span></samp>. 
(You will need GNU <code>libiconv</code>: the Solaris version of <code>iconv</code>
is not sufficiently powerful.)

   <p>If using <samp><span class="command">gcc</span></samp>, do ensure that the compiler was compiled for the
version of Solaris in use.  (This can be ascertained from <samp><span class="command">gcc
-v</span></samp>.)  <samp><span class="command">gcc</span></samp> makes modified versions of some header files, and
several reports of problems were due to using <samp><span class="command">gcc</span></samp> compiled on
one version of Solaris on a later version.  A version of <samp><span class="command">gcc</span></samp>
optimized for Sparc (using technology from Sun's compilers) is available
from Sun.<a rel="footnote" href="#fn-28" name="fnd-28"><sup>28</sup></a>

   <p>When using the Sun compilers<a rel="footnote" href="#fn-29" name="fnd-29"><sup>29</sup></a> do <em>not</em> specify <samp><span class="option">-fast</span></samp>, as this disables
<acronym>IEEE</acronym> arithmetic and <samp><span class="command">make check</span></samp> will fail.

<!-- https://stat.ethz.ch/pipermail/r-devel/2009-March/052454.html -->
<!-- and followups -->
   <p>Jeff Long reported problems if R is built as a shared library and
&lsquo;<samp><span class="samp">libintl</span></samp>&rsquo; was installed via <samp><span class="command">pkg-get</span></samp>: in particular
segfaults using <code>read.spss</code> from package <strong>foreign</strong>: this can be
avoided by not building R as a shared library or configuring with
<samp><span class="option">--with-included-gettext</span></samp>.

   <p>To compile for a 64-bit Sparc target with <samp><span class="command">gcc</span></samp>&nbsp;4 we used

<pre class="example">     CC="gcc -m64"
     F77="gfortran -m64"
     CXX="g++ -m64"
     FC="gfortran -m64"
     LDFLAGS="-L/opt/csw/gcc4/lib/sparcv9 -L/opt/csw/lib/sparcv9"
</pre>
   <p class="noindent">replacing &lsquo;<samp><span class="samp">gfortran</span></samp>&rsquo; with &lsquo;<samp><span class="samp">g77</span></samp>&rsquo; for <samp><span class="command">gcc</span></samp> 3.x.y. 
Note that paths such as <samp><span class="file">/opt/csw/gcc4/lib/sparcv9</span></samp> may need to
be in the
<a name="index-LD_005fLIBRARY_005fPATH-85"></a><samp><span class="env">LD_LIBRARY_PATH</span></samp> during configuration.

   <p>For the Sun Studio compilers a little juggling of paths was needed to
ensure GNU <code>libiconv</code> is used rather than the Solaris <code>iconv</code>:
we used

<pre class="example">     CC="cc -xc99"
     CPPFLAGS=-I/opt/csw/include
     CFLAGS="-O -xlibmieee"
     F77=f95
     FFLAGS=-O4
     CXX=CC
     CXXFLAGS=-O
     FC=f95
     FCFLAGS=$FFLAGS
     LDFLAGS=-L/opt/csw/lib
     SHLIB_CXXLDFLAGS="-G -lCstd"
</pre>
   <p class="noindent">to ensure that the <code>libiconv</code> version of <samp><span class="file">iconv.h</span></samp> was found. 
For a 64-bit target add <samp><span class="option">-xarch=v9</span></samp> (or <code>v9b</code>, or
<code>amd64</code>) to each of the compiler commands, or for Sun Studio 12 add
<samp><span class="option">-m64</span></samp>.  You can target specific Sparc architectures for (slightly)
higher performance: Sun recommend

<pre class="example">     <span class="roman">32-bit:</span> -xtarget=ultra3 -xarch=v8plusa
     <span class="roman">64-bit:</span> -xtarget=ultra3 -xarch=v9a
</pre>
   <p class="noindent">(in <code>CFLAGS</code> etc.) as a good compromise for recent Sparc chipsets.

   <p>By default the Sun Studio compilers do not conform to the C99 standard
(appendix F 8.9) on the return values of functions such as <code>log</code>:
use <samp><span class="option">-xlibmieee</span></samp> to ensure this.  Also, errors have been reported
on &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; if <samp><span class="option">-xc99</span></samp> is omitted.

   <p>On &lsquo;<samp><span class="samp">x86</span></samp>&rsquo; you will get marginally higher performance <em>via</em>

<pre class="example">     CFLAGS="-xO5 -xc99 -xlibmieee -xlibmil -nofstore"
     FFLAGS="-O5 -libmil -nofstore"
     CXXFLAGS="-xO5 -xlibmil -nofstore"
     SAFE_FFLAGS="-O5 -libmil -fstore"
</pre>
   <p>Building on &lsquo;<samp><span class="samp">x86</span></samp>&rsquo; with <samp><span class="command">gcc</span></samp>&nbsp;4 failed <samp><span class="command">make
check</span></samp> in the complex LAPACK tests: using Sun Studio 11 worked
correctly.

   <p>There is limited support for &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; builds in the pre-built
GNU software repositories, with 64-bit libraries (which are installed in
<samp><span class="file">/opt/csw/lib/amd64</span></samp> and so on) being scarce (and not including the
<samp><span class="command">gcc</span></samp> support libraries).  The Sun Studio compilers do support
64-bit builds via <samp><span class="option">-xarch=amd64</span></samp> (or, for version 12,
<samp><span class="option">-m64</span></samp>).

   <p><a name="index-BLAS-library-86"></a><a name="index-LAPACK-library-87"></a>
The Sun performance library <code>libsunperf</code> is available with the Sun
Studio compilers.  If selected as a BLAS, it must also be selected as
LAPACK via

<pre class="example">     ./configure --with-blas=sunperf --with-lapack
</pre>
   <p class="noindent">However, our tests were none too successful: Sparc 64-bit builds
crashed.

<p><a name="Sparc-Solaris-9-and-earlier"></a>

<h4 class="subsection">C.4.2 Sparc Solaris 9 and earlier</h4>

<p>These are now obsolete operating systems, so this subsection refers to
equally old compiler versions.

   <p>Sun packages for R are available from
<a href="http://www.sunfreeware.com/">http://www.sunfreeware.com/</a> for both Sparc and &lsquo;<samp><span class="samp">x86</span></samp>&rsquo;.

   <p>R 2.6.2 was built successfully on Sparc Solaris 8 (aka Solaris 2.8
aka SunOS 5.8) using <samp><span class="command">gcc</span></samp>&nbsp;3/<samp><span class="command">g77</span></samp>,
<samp><span class="command">gcc</span></samp>&nbsp;4/<samp><span class="command">gfortran</span></samp> and the `Sun ONE Studio 7
Compiler Suite' (aka Forte&nbsp;7).

   <p>The Solaris versions of several of the tools needed to build R
(e.g. <samp><span class="command">make</span></samp>, <samp><span class="command">ar</span></samp> and <samp><span class="command">ld</span></samp>) are in
<samp><span class="file">/usr/ccs/bin</span></samp>, so if using those tools ensure this is in your
path.

   <p><samp><span class="command">gcc</span></samp> 3.2.1 and 3.2.2 generate incorrect code on 32-bit Solaris
builds with optimization, but versions 3.2.3 and later work correctly. 
(The symptom was that <code>make check</code> failed at the first attempt to
plot.)

   <p>If using <samp><span class="command">gcc</span></samp>, do ensure that the compiler was compiled for the
version of Solaris in use.  (This can be ascertained from <samp><span class="command">gcc
-v</span></samp>.)  <samp><span class="command">gcc</span></samp> makes modified versions of some header files, and
so (for example) <samp><span class="command">gcc</span></samp> compiled under Solaris 2.6 will not
compile R under Solaris 2.7.  Also, do ensure that it was compiled
for the assembler/loader in use: if you download <samp><span class="command">gcc</span></samp> from
<a href="http://www.sunfreeware.com/">http://www.sunfreeware.com/</a> then you need to download
<code>binutils</code> too.  To avoid all these pitfalls we recommended you
compile <samp><span class="command">gcc</span></samp> from the sources yourself.

   <p>It was reported by Mike Pacey that Sun Forte 9 requires
&lsquo;<samp><span class="samp">-xopenmp=stubs</span></samp>&rsquo; added to <code>LDFLAGS</code>.

   <p>When using the Sun compilers do <em>not</em> specify <samp><span class="option">-fast</span></samp>, as
this disables <acronym>IEEE</acronym> arithmetic and <samp><span class="command">make check</span></samp> will
fail.  The maximal set of optimization options known to work on Sparc
Solaris 8 is

<pre class="example">     -xlibmil -xO5 -dalign
</pre>
   <p class="noindent">(&lsquo;<samp><span class="samp">x86</span></samp>&rsquo; versions do not need &lsquo;<samp><span class="samp">-dalign</span></samp>&rsquo;, and some do not
support it.)  To get correct results for <code>log</code> requires
<samp><span class="option">-xlibmieee</span></samp>, but R works around that.

   <p>We have found little performance difference between <samp><span class="command">gcc</span></samp> and
<samp><span class="command">cc</span></samp> but considerable benefit from using a SunPro Fortran
compiler: the <samp><span class="command">gcc</span></samp>/<samp><span class="command">f77</span></samp> combination worked well.  For
many C++ applications Forte 7 requires &lsquo;<samp><span class="samp">-lCstd</span></samp>&rsquo;, which the
configure script will add to <code>SHLIB_CXXLDFLAGS</code> if it identifies
the compiler correctly.

   <p>To compile for a 64-bit target on Sparc Solaris (which needs an
UltraSparc chip and for support to be enabled in the OS) with the Forte
7 compilers we used

<pre class="example">     CC="cc -xarch=v9 -xc99"
     CFLAGS="-xO5 -xlibmil -dalign"
     F77="f95 -xarch=v9"
     FFLAGS="-xO5 -xlibmil -dalign"
     CXX="CC -xarch=v9"
     CXXFLAGS="-xO5 -xlibmil -dalign"
     FC="f95 -xarch=v9"
     FCFLAGS="-xO5 -xlibmil -dalign"
</pre>
   <p class="noindent">in <samp><span class="file">config.site</span></samp>.

   <p>For 64-bit compilation with <samp><span class="command">gcc</span></samp> 3.4.x we used

<pre class="example">     CC="gcc -m64"
     F77="g77 -m64"
     CXX="g++ -m64"
     FC="gfortran -m64"
     LDFLAGS="-L/usr/local/lib/sparcv9 -L/usr/local/lib"
</pre>
   <p class="noindent">replacing &lsquo;<samp><span class="samp">g77</span></samp>&rsquo; with &lsquo;<samp><span class="samp">gfortran</span></samp>&rsquo; for <samp><span class="command">gcc</span></samp> 4.x.y.  Note
that <samp><span class="file">/usr/local/lib/sparcv9</span></samp> may need to be in the
<a name="index-LD_005fLIBRARY_005fPATH-88"></a><samp><span class="env">LD_LIBRARY_PATH</span></samp> during configuration.  (<samp><span class="command">configure</span></samp> will
append <samp><span class="option">-std=gnu99</span></samp> to <code>CC</code>.)

   <p>Solaris on Sparc CPUs need &lsquo;<samp><span class="samp">PIC</span></samp>&rsquo; and not &lsquo;<samp><span class="samp">pic</span></samp>&rsquo; versions of
<samp><span class="env">CPICFLAGS</span></samp> and <samp><span class="env">FPICFLAGS</span></samp> since the &lsquo;<samp><span class="samp">pic</span></samp>&rsquo; version only
allows 1024 symbols on a 64-bit build (and 2048 on a 32-bit build).

   <p><a name="index-BLAS-library-89"></a><a name="index-LAPACK-library-90"></a>
Note that using <samp><span class="command">f95</span></samp> allows the Sun performance library
<code>libsunperf</code> to be selected: it may not work<a rel="footnote" href="#fn-30" name="fnd-30"><sup>30</sup></a> with <samp><span class="command">f77</span></samp>, and will not with <samp><span class="command">g77</span></samp>. 
<code>libsunperf</code> contains both BLAS and LAPACK code, and
<samp><span class="option">--with-lapack</span></samp> may be required if you use it.  On our test
system using <code>libsunperf</code> failed for 64-bit builds with both Forte
7 and Sun Studio 11, albeit in different ways.  Our experience has been
that ATLAS's BLAS is faster than <code>libsunperf</code>, especially for
complex numbers.

   <p>For a 64-bit build, 64-bit libraries must be used.  As the configuration
process by default sets <code>LDFLAGS</code> to &lsquo;<samp><span class="samp">-L/usr/local/lib</span></samp>&rsquo;, you
may need to set it to avoid finding 32-bit addons (as in the
<samp><span class="command">gcc -m64</span></samp> example above).  It is possible to build Tcl/Tk as
64-bit libraries with the configure option <samp><span class="command">--enable-64bit</span></samp>, but
only with the Sun compilers (and not with <samp><span class="command">gcc</span></samp>) as of
Tcl/Tk&nbsp;8.4.5.

   <p>There have been alignment issues, with Sun libraries requiring 8-byte
alignment of doubles (which <samp><span class="command">gcc</span></samp> generated by default, but
<samp><span class="command">cc</span></samp> did not).

<p><a name="HP-UX"></a>
<a name="HP_002dUX"></a>

<h3 class="section">C.5 HP-UX</h3>

<p><a name="index-HP_002dUX-91"></a>
<!-- R-help 2007 Nov 1/2, and follow up to BDR Nov 6. -->
Fan Long built R 2.6.0 on HP-UX 11.23 on &lsquo;<samp><span class="samp">ia64</span></samp>&rsquo; using the
native compilers via

<pre class="example">     CC=cc
     CFLAGS="+z +DD64"
     CXX=aCC
     CXXFLAGS="-b -lxnet +z +DD64"
     FC=f90
     FCFLAGS=+DD64
     F77=f90
     FFLAGS=+DD64
     LDFLAGS="-L/usr/lib/hpux64 -L/opt/fortran90/lib"
</pre>
   <p class="noindent">Here &lsquo;<samp><span class="samp">+z</span></samp>&rsquo; selects PIC code and <code>+DD64</code> a 64-bit build.

   <p>He found that <samp><span class="file">stdbool.h</span></samp> was detected but was non-standard, so
&lsquo;<samp><span class="samp">HAVE_STDBOOL_H</span></samp>&rsquo; had to be undefined in
<samp><span class="file">src/include/config.h</span></samp>.  In addition, the compiler objected to

<pre class="example">       static const pthread_once_t fresh_once = {PTHREAD_ONCE_INIT};
</pre>
   <p class="noindent">(line 362 of <samp><span class="file">src/extra/intl/lock.c</span></samp>) and needed the braces removed.

   <p>The remaining reports on HP-UX here predate R 2.0.0.

   <p>R has been built successfully on HP-UX 11.0 using both native
compilers and <samp><span class="command">gcc</span></samp>. By default, R is configured to use
<samp><span class="command">gcc</span></samp> and <samp><span class="command">g77</span></samp> on HP-UX (if available).  Some
installations of <samp><span class="command">g77</span></samp> only install a static version of the
<samp><span class="command">g2c</span></samp> library that cannot be linked into a shared library since
its files have not been compiled with the appropriate flag for producing
position independent code (<acronym>PIC</acronym>).  This will result in
<samp><span class="command">make</span></samp> failing with a linker error similar to

<pre class="example">     ld: CODE_ONE_SYM fixup to non-code subspace in file foo.o -
     shared library must be position independent. Use +z or +Z to recompile.
</pre>
   <p class="noindent">(<samp><span class="option">+z</span></samp> and <samp><span class="option">+Z</span></samp> are the <acronym>PIC</acronym> flags for the native
compiler <samp><span class="command">cc</span></samp>.)  If this is the case you either need to modify
your <samp><span class="command">g77</span></samp> installation or configure with

<pre class="example">     F77=fort77
</pre>
   <p class="noindent">to specify use of the native <acronym>POSIX</acronym>-compliant FORTRAN 77
compiler.

   <p>You may find that <samp><span class="command">configure</span></samp> detects other libraries that R
needs to use as shared libraries but are only available as static
libraries.  If you cannot install shared versions you will need to tell
<samp><span class="command">configure</span></samp> not to use these libraries, or make sure they are
not in the library path.  The symptom will be the linker error shown in
the last paragraph.  Static libraries that might be found and would
cause problems are

<pre class="example">     BLAS                   <span class="roman">use </span><samp><span class="option">--without-blas</span></samp>
     Tcl/Tk                 <span class="roman">use </span><samp><span class="option">--without-tcltk</span></samp>
     libpng                 <span class="roman">use </span><samp><span class="option">--without-libpng</span></samp>
     jpeg                   <span class="roman">use </span><samp><span class="option">--without-jpeglib</span></samp>
     zlib                   <span class="roman">use </span><samp><span class="option">--without-system-zlib</span></samp>
</pre>
   <p class="noindent">and <code>bzip2</code> and <code>pcre</code> are problematic when building
<samp><span class="file">libR.so</span></samp>, only.  These can be avoided by
<samp><span class="option">--without-system-bzlib</span></samp> and <samp><span class="option">--without-system-pcre</span></samp>
respectively, but these are the defaults.

   <p>Some versions of <samp><span class="command">gcc</span></samp> may contain what appears to be a bug at
the <samp><span class="option">-O2</span></samp> optimization level that causes

<pre class="example">     &gt; 2 %/% 2
     [1] 1
     &gt; 1:2 %/% 2
     [1] 0 0     # <span class="roman">wrong!!</span>
</pre>
   <p class="noindent">which will cause <samp><span class="command">make check</span></samp> to fail.  If this is the case, you
should use <code>CFLAGS</code> to specify <samp><span class="option">-O</span></samp> as the optimization
level to use.

   <p>You can configure R to use both the native <samp><span class="command">cc</span></samp> and
<samp><span class="command">fort77</span></samp> with

<pre class="example">     ./configure CC=cc F77=fort77
</pre>
   <p><samp><span class="command">f90</span></samp> insists on linking against a static <samp><span class="file">libF90.a</span></samp> which
typically resides in a non-standard directory (e.g.,
<samp><span class="file">/opt/fortran90/lib</span></samp>).  Hence, to use <samp><span class="command">f90</span></samp> one needs to
add this directory to the linker path via the configure variable
<code>LDFLAGS</code> (e.g.,
<samp><span class="command">./configure F77=f90 LDFLAGS=/opt/fortran90/lib</span></samp>).

<p><a name="IRIX"></a>

<h3 class="section">C.6 IRIX</h3>

<p><a name="index-IRIX-92"></a>
R 2.1.0 has been successfully built on IRIX64 6.5 using both
<samp><span class="command">gcc</span></samp> and the native (MipsPro 7.4) compiler. However, neither
version has passed <samp><span class="command">make check</span></samp> due to a problem with time
zones (see below).  A 64-bit executable has not been successfully
built.

   <p>It appears that some (but not all) versions of IRIX have broken
wide-character header files and so may need <samp><span class="option">--disable-mbcs</span></samp>.

   <p>To build R with <samp><span class="command">gcc</span></samp> use something like the following
configuration flags

<pre class="example">     CPPFLAGS="-I/usr/freeware/include"
     LDFLAGS="-L/usr/freeware/lib32"
</pre>
   <p>To build the Tcl/Tk package you will most likely need to add

<pre class="example">     --with-tclconfig=/usr/freeware/lib/tclConfig.sh
     --with-tkconfig=/usr/freeware/lib/tkConfig.sh
</pre>
   <p class="noindent">since these configuration scripts are not on your path.

   <p>To build R with the native compilers, use something like the
following configuration flags

<pre class="example">     CC=cc F77=f77 CXX=CC
     CPPFLAGS="-I/usr/freeware/include" LDFLAGS="-L/usr/freeware/lib32"
     CFLAGS="-O2" FFLAGS="-O2" CXXFLAGS="-O2"
     --with-system-bzlib=yes
</pre>
   <p>The MipsPro compiler will not build the <code>bzlib</code> library, so you must use
the external one provided by SGI as a freeware package.

   <p>After configuration, it is necessary to use <samp><span class="command">gmake</span></samp> instead of
the native <samp><span class="command">make</span></samp> to build R.

   <p>There is a problem with the time zones on IRIX (originally reported by
George N. White III for 1.9.0) which will cause the <code>strptime</code>
tests to fail unless Arthur Olson's timezone data
<a href="ftp://elsie.nci.nih.gov/pub/">ftp://elsie.nci.nih.gov/pub/</a> has been installed (see also
<a href="http://cspry.co.uk/computing/Indy_admin/TIMEZONE.html">http://cspry.co.uk/computing/Indy_admin/TIMEZONE.html</a>) and
&lsquo;<samp><span class="samp">-ltz</span></samp>&rsquo; is added to the list of libraries (for example, in
<a name="index-LIBS-93"></a>environment variable <samp><span class="env">LIBS</span></samp>).

   <p>The flag <samp><span class="option">-OPT:IEEE_NaN_inf=ON</span></samp> is added for the native
compilers.

<p><a name="Alpha%2fOSF1"></a>
<a name="Alpha_002fOSF1"></a>

<h3 class="section">C.7 Alpha/OSF1</h3>

<p>R has been built successfully on an Alpha running OSF1 V4.0 / V5.1
using <samp><span class="command">gcc</span></samp>/<samp><span class="command">g77</span></samp> and <samp><span class="command">cc</span></samp>/<samp><span class="command">f77</span></samp>. 
Mixing <samp><span class="command">cc</span></samp> and <samp><span class="command">g77</span></samp> fails to configure.  The
<samp><span class="command">configure</span></samp> option <samp><span class="option">--without-blas</span></samp> was used since the
native blas seems not to have been built with the flags needed to
suppress <code>SIGFPE</code>'s.  Currently R does not set a signal handler
for <code>SIGFPE</code> on platforms that support <acronym>IEEE</acronym> arithmetic,
so these are fatal.

   <p>At some point in the past using <samp><span class="command">cc</span></samp> required <samp><span class="option">-std1</span></samp> to
be set so &lsquo;<samp><span class="samp">__STDC__</span></samp>&rsquo; was defined.  As far as we know this is no
longer needed, and <samp><span class="command">configure</span></samp> no longer sets it, but it does
set <samp><span class="option">-ieee_with_inexact</span></samp> for the C compiler and <samp><span class="option">-fpe3</span></samp>
for the FORTRAN compiler (and <samp><span class="option">-mieee-with-inexact</span></samp> and
<samp><span class="option">-mieee</span></samp> for <samp><span class="command">gcc</span></samp>/<samp><span class="command">g77</span></samp>) (in the appropriate
<code>R_XTRA_*</code> flags).

<p><a name="Alpha%2fFreeBSD"></a>
<a name="Alpha_002fFreeBSD"></a>

<h3 class="section">C.8 Alpha/FreeBSD</h3>

<p>Attempts to build R on an Alpha with FreeBSD 4.3 have been only
partly successful.  Configuring with <samp><span class="option">-mieee</span></samp> added to both
<code>CFLAGS</code> and <code>FFLAGS</code> builds successfully, but tests fail with
<code>SIGFPE</code>'s.  It would appear that <samp><span class="option">-mieee</span></samp> only defers these
rather than suppressing them entirely.  Advice on how to complete this
port would be greatly appreciated.

<p><a name="AIX"></a>

<h3 class="section">C.9 AIX</h3>

<p><a name="index-AIX-94"></a>
We no longer support AIX prior to 4.2, and <samp><span class="command">configure</span></samp> will
throw an error on such systems.

   <p>Ei-ji Nakama was able to build under AIX 5.2 on &lsquo;<samp><span class="samp">powerpc</span></samp>&rsquo; with
GCC 4.0.3 in several configurations.  32-bit bit versions could be
configured with <samp><span class="option">--without-iconv</span></samp> as well as
<samp><span class="option">--enable-R-shlib</span></samp>.  For 64-bit versions he used

<pre class="example">     OBJECT_MODE=64
     CC="gcc -maix64"
     CXX="g++ -maix64"
     F77="gfortran -maix64"
     FC="gfortran -maix64"
</pre>
   <p class="noindent">and was also able to build with the IBM <code>xlc</code> and Hitachi
<code>f90</code> compilers by

<pre class="example">     OBJECT_MODE=64
     CC="xlc -q64"
     CXX="g++ -maix64"
     F77="f90 -cpu=pwr4 -hf77 -parallel=0 -i,L -O3 -64"
     FC="f90 -cpu=pwr4 -hf77 -parallel=0 -i,L -O3 -64"
     FLIBS="-L/opt/ofort90/lib -lhf90vecmath -lhf90math -lf90"
</pre>
   <p>Some systems have <samp><span class="command">f95</span></samp> as an IBM compiler that does not by
default accept FORTRAN 77.  It needs the flag <samp><span class="option">-qfixed=72</span></samp>, or to
be invoked as <samp><span class="command">xlf_r</span></samp>. 
<!-- http://publib.boulder.ibm.com/infocenter/comphelp/v7v91/index.jsp?topic=/com.ibm.xlf91a.doc/xlfug/hu00465.htm -->

   <p>The AIX native <code>iconv</code> does not support encodings &lsquo;<samp><span class="samp">latin1</span></samp>&rsquo; nor
&lsquo;<samp><span class="samp">""</span></samp>&rsquo; and so cannot be used.  (As far as we know GNU <code>libiconv</code>
could be installed.)

   <p>Fan Long reports success on AIX 5.3 using
<!-- https://stat.ethz.ch/pipermail/r-devel/2008-August/050318.html -->

<pre class="example">     OBJECT_MODE=64
     LIBICONV=<var>/where/libiconv/installed</var>
     CC="xlc_r -q64"
     CFLAGS="-O -qstrict"
     CXX="xlC_r -q64"
     CXXFLAGS="-O -qstrict"
     F77="xlf_r -q64"
     AR="ar -X64"
     CPPFLAGS="-I$LIBICONV/include -I/usr/lpp/X11/include/X11"
     LDFLAGS="-L$LIBICONV/lib -L/usr/lib -L/usr/X11R6/lib"
</pre>
   <p>On one AIX 6.x system it was necessary to use <samp><span class="env">R_SHELL</span></samp> to set the
default shell to be Bash rather than Zsh.

   <p>Kurt Hornik and Stefan Theussl at WU (Wirtschaftsuniversit&auml;t Wien)
successfully built R on a &lsquo;<samp><span class="samp">powerpc</span></samp>&rsquo; (8-<acronym>CPU</acronym> Power6
system) on AIX 6.1, configuring with or without
<samp><span class="option">--enable-R-shlib</span></samp> (Ei-Ji Nakama's support is gratefully
acknowledged).

   <p>It helps to describe the WU build environment first.  A small part of
the software needed to build R and/or install packages is available
directly from the AIX Installation DVDs, e.g., Java 6, X11, or Perl. 
Additional open source software (OSS) is packaged for AIX in <samp><span class="file">.rpm</span></samp>
files and available from both IBM's &ldquo;AIX Toolbox for Linux
Applications&rdquo;
(<a href="http://www-03.ibm.com/systems/power/software/aix/linux/">http://www-03.ibm.com/systems/power/software/aix/linux/</a>) and
<a href="http://www.oss4aix.org/download/">http://www.oss4aix.org/download/</a>.  The latter website typically
offers more recent versions of the available OSS.  All tools needed and
libraries downloaded from these repositories (e.g., GCC, Make,
<code>libreadline</code>, etc.) are typically installed to
<samp><span class="file">/opt/freeware</span></samp>, hence corresponding executables are found in
<samp><span class="file">/opt/freeware/bin</span></samp> which thus needs to be in <samp><span class="env">PATH</span></samp> for using
these tools.  Like on other Unix systems one needs <acronym>GNU</acronym>
<code>libiconv</code> as the AIX version of iconv is not sufficiently
powerful.  Additionally, for proper Unicode compatibility one should
install the corresponding package from the ICU project
(<a href="http://www.icu-project.org/download/">http://www.icu-project.org/download/</a>), which offers pre-compiled
binaries for various platforms which in case of AIX can be installed via
unpacking the tarball to the root file system.  For full LaTeX
support one can install the TeX Live DVD distribution
(<a href="http://www.tug.org/texlive/">http://www.tug.org/texlive/</a>): it is recommended to update the
distribution using the <code>tlmgr</code> update manager.  For 64-bit R builds
supporting Tcl/Tk this needs to installed from the sources as available
pre-compiled binaries supply only 32-bit shared objects.

   <p>The recent WU testing was done using compilers from both the GNU
Compiler Collection (version 4.2.4) which is available from one of the
above OSS repositories, and the IBM C/C++ (XL C/C++ 10.01) as well as
FORTRAN (XL Fortran 12.01) compilers
(<a href="http://www14.software.ibm.com/webapp/download/byproduct.jsp#X">http://www14.software.ibm.com/webapp/download/byproduct.jsp#X</a>).

   <p>To compile for a 64-bit &lsquo;<samp><span class="samp">powerpc</span></samp>&rsquo; (Power6 CPU) target one can
use

<pre class="example">     CC ="gcc -maix64 -pthread"
     CXX="g++ -maix64 -pthread"
     FC="gfortran -maix64 -pthread"
     F77="gfortran -maix64 -pthread"
     CFLAGS="-O2 -g -mcpu=power6"
     FFLAGS="-O2 -g -mcpu=power6"
     FCFLAGS="-O2 -g -mcpu=power6"
</pre>
   <p class="noindent">for the GCC and

<pre class="example">     CC=xlc
     CXX=xlc++
     FC=xlf
     F77=xlf
     CFLAGS="-qarch=auto -qcache=auto -qtune=auto -O3 -qstrict -ma"
     FFLAGS="-qarch=auto -qcache=auto -qtune=auto -O3 -qstrict"
     FCFLAGS="-qarch=auto -qcache=auto -qtune=auto -O3 -qstrict"
     CXXFLAGS="-qarch=auto -qcache=auto -qtune=auto -O3 -qstrict"
</pre>
   <p class="noindent">for the IBM XL compilers.  For the latter, it is important to note that
the decision for generating 32-bit or 64-bit code is done by setting the
<samp><span class="env">OBJECT_MODE</span></samp> environment variable appropriately (recommended) or
using an additional compiler flag (<samp><span class="option">-q32</span></samp> or <samp><span class="option">-q64</span></samp>).  By
default the IBM XL compilers produce 32 bit code.  Thus, to build R with
64-bit support one needs to either export <samp><span class="env">OBJECT_MODE=64</span></samp> in the
environment or, alternatively, use the <samp><span class="option">-q64</span></samp> compiler options.

   <p>It is strongly recommended to install Bash and use it as the configure
shell, e.g., via setting <code>CONFIG_SHELL=/usr/bin/bash</code> in the
environment, and to use <acronym>GNU</acronym> Make (e.g., via
(<code>MAKE=/opt/freeware/bin/make</code>).

   <p>Further installation instructions to set up a proper R development
environment can be found in the &ldquo;R on AIX&rdquo; project on R-Forge
(<a href="http://R-Forge.R-project.org/projects/aix/">http://R-Forge.R-project.org/projects/aix/</a>).

<p><a name="Cygwin"></a>

<h3 class="section">C.10 Cygwin</h3>

<p>The Cygwin emulation layer on Windows can be treated as a Unix-alike OS. 
This is unsupported, but experiments have been conducted and a few
workarounds added for R 2.6.0.

   <p>Only building as a shared library works,<a rel="footnote" href="#fn-31" name="fnd-31"><sup>31</sup></a> so use

<pre class="example">     ./configure --disable-nls --disable-mbcs --enable-R-shlib
     make
</pre>
   <p class="noindent">MBCS does not work&mdash;<code>wcstod</code> is missing&mdash;but would only be of any
use in a CJK locale.  NLS does work, although
<samp><span class="option">--with-included-gettext</span></samp> is preferable.  You will see many
warnings about the use of auto-import.

<!-- It almost passes @command{make check}: FIFOs are supposedly supported -->
<!-- but hung in @samp{example(fifo)}. -->
   <p>Note that this gives you a command-line application using <code>readline</code>
for command editing.  The &lsquo;<samp><span class="samp">X11</span></samp>&rsquo; graphics device will work if a
suitable X server is running, and the standard Unix-alike ways of
installing source packages work.  There was a bug in the
<samp><span class="file">/usr/lib/tkConfig.sh</span></samp> script in the version we looked at, which
needs to have

<pre class="example">     TK_LIB_SPEC='-ltk84'
</pre>
   <p>The overhead of using shell scripts makes this noticeably slower than a
native build of R on Windows.

<p><a name="New-platforms"></a>

<h3 class="section">C.11 New platforms</h3>

<p>There are a number of sources of problems when installing R on a new
hardware/OS platform.  These include

   <p><strong>Floating Point Arithmetic</strong>: R requires arithmetic compliant
with <acronym>IEC</acronym>&nbsp;60559, also know as <acronym>IEEE</acronym>&nbsp;754. 
This mandates the use of plus and minus infinity and <code>NaN</code> (not a
number) as well as specific details of rounding.  Although almost all
current FPUs can support this, selecting such support can be a pain. 
The problem is that there is no agreement on how to set the signalling
behaviour; Sun/Sparc, SGI/IRIX and &lsquo;<samp><span class="samp">ix86</span></samp>&rsquo; Linux require no
special action, FreeBSD requires a call to (the macro)
<code>fpsetmask(0)</code> and OSF1 requires that computation be done with a
<samp><span class="option">-ieee_with_inexact</span></samp> flag etc.  On a new platform you must find
out the magic recipe and add some code to make it work.  This can often
be done via the file <samp><span class="file">config.site</span></samp> which resides in the top level
directory.

   <p>Beware of using high levels of optimization, at least initially.  On
many compilers these reduce the degree of compliance to the
<acronym>IEEE</acronym> model.  For example, using <samp><span class="option">-fast</span></samp> on the Solaris
SunPro compilers causes R's <code>NaN</code> to be set incorrectly.

   <p><strong>Shared Libraries</strong>: There seems to be very little agreement
across platforms on what needs to be done to build shared libraries. 
there are many different combinations of flags for the compilers and
loaders.  <acronym>GNU</acronym> libtool cannot be used (yet), as it currently
does not fully support FORTRAN: one would need a shell wrapper for
this).  The technique we use is to first interrogate the X window system
about what it does (using <samp><span class="command">xmkmf</span></samp>), and then override this in
situations where we know better (for tools from the <acronym>GNU</acronym>
Compiler Collection and/or platforms we know about).  This typically
works, but you may have to manually override the results.  Scanning the
manual entries for <samp><span class="command">cc</span></samp> and <samp><span class="command">ld</span></samp> usually reveals the
correct incantation.  Once you know the recipe you can modify the file
<samp><span class="file">config.site</span></samp> (following the instructions therein) so that the
build will use these options.

   <p>It seems that <samp><span class="command">gcc</span></samp>&nbsp;3.4.x and later on &lsquo;<samp><span class="samp">ix86</span></samp>&rsquo; Linux
defeat attempts by the LAPACK code to avoid computations entirely in
extended-precision registers, so file <samp><span class="file">src/modules/lapack/dlamc.f</span></samp>
may need to be compiled without optimization.  Set the configure
variable <samp><span class="env">SAFE_FFLAGS</span></samp> to the flags to be used for this file.  If
configure detects <acronym>GNU</acronym> FORTRAN it adds flag
<samp><span class="option">-ffloat-store</span></samp> to <samp><span class="env">FFLAGS</span></samp>.  (Other settings are needed when
using <samp><span class="command">icc</span></samp> on &lsquo;<samp><span class="samp">ix86</span></samp>&rsquo; Linux, for example.)

   <p>If you do manage to get R running on a new platform please let us
know about it so we can modify the configuration procedures to include
that platform.

   <p>If you are having trouble getting R to work on your platform please
feel free to use the &lsquo;<samp><span class="samp">R-devel</span></samp>&rsquo; mailing list to ask questions.  We
have had a fair amount of practice at porting R to new platforms
<small class="enddots">...</small>

<p><a name="Enabling-search-in-HTML-help"></a>

<h2 class="appendix">Appendix D Enabling search in <acronym>HTML</acronym> help</h2>

<p>There is a search engine available from the front page of the <acronym>HTML</acronym>
help system, the page that is displayed by <code>help.start()</code>.  The
search engine is written in Java and invoked by Javascript code, so the
first thing to do is to ensure that both are enabled in your favourite
browser.  Then try it and see: with most browsers you should see

<pre class="example">     Applet SearchEngine started
</pre>
   <p class="noindent">displayed in the status bar.  (Internet Explorer shows <code>Applet
started</code>.) Then click on one of the keywords and after a short delay
(several seconds) you should see a page of search results.

   <p>If this fails you should double-check that Java is enabled in your
browser by visiting a page such as
<a href="http://www.java.com/en/download/help/testvm.jsp">http://www.java.com/en/download/help/testvm.jsp</a>.  Java
1.4 or later is needed.

   <p>On Mozilla-based browsers the links on the results page will
become inactive if you return to it: to work around this you can open
a link in a new tab or window.

<!-- https://stat.ethz.ch/pipermail/r-help/2008-July/169521.html -->
   <p>There is a known issue with Firefox 3.0 up to 3.0.6 (it was fixed in
3.0.7).  The links in the results page may point to the wrong directory
level.  This is a bug in the way Firefox is interpreting relative URLs,
and can be circumvented by opening the HTML search page
(<samp><span class="file">.../doc/html/SearchEngine.html</span></samp>) directly rather than from
<samp><span class="file">.../doc/html/index.html</span></samp> as shown by <code>help.start()</code>.

   <p>Many thanks to Marc Schwartz in tracking down many of these issues with
enabling the Java search engine.

<p><a name="Java-Virtual-Machines-on-Linux"></a>

<h3 class="section">D.1 Java Virtual Machines on Linux</h3>

<p>We are aware of problems with certain older Java installations: Sun's
Java Run-time Environment version 1.5.0 or later is strongly recommended
for Mozilla-based browsers.  In particular, Sun's Java Run-time
Environment <code>j2re</code>&nbsp;1.4.2_02 to _05 do not work under
&lsquo;<samp><span class="samp">ix86</span></samp>&rsquo; Linux.

   <p>There is a Sun Java plugin (as of version <code>1.6.0_u12</code> for 64-bit
browsers on &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Linux: but 32-bit browsers are often used
on that platform.

   <p>Marc Schwartz reports that the `OpenJDK' (formerly called `IcedTea') JVM
that ships with Fedora 8, 9 and 10 does not work with the search applet. 
(The bug report is part of
<a href="https://bugzilla.redhat.com/show_bug.cgi?id=304021">https://bugzilla.redhat.com/show_bug.cgi?id=304021</a>.)  The Sun
JRE and plugin can be installed: see
<a href="http://www.fedorafaq.org/#java">http://www.fedorafaq.org/#java</a>.  (See also
<a href="http://www.mjmwired.net/resources/mjm-fedora-f8.html#java">http://www.mjmwired.net/resources/mjm-fedora-f8.html#java</a>,
<a href="http://www.mjmwired.net/resources/mjm-fedora-f9.html#java">http://www.mjmwired.net/resources/mjm-fedora-f9.html#java</a> and
<a href="http://www.mjmwired.net/resources/mjm-fedora-f10.html#java">http://www.mjmwired.net/resources/mjm-fedora-f10.html#java</a>.)

   <p>Older but still useful links are for Firefox/Mozilla,
<a href="http://plugindoc.mozdev.org/faqs/java.html">http://plugindoc.mozdev.org/faqs/java.html</a>, for Konqueror
<a href="http://www.konqueror.org/javahowto/">http://www.konqueror.org/javahowto/</a>, for Opera
<a href="http://www.opera.com/support/search/supsearch.dml?index=459">http://www.opera.com/support/search/supsearch.dml?index=459</a>
and for Debian GNU/Linux
<a href="http://www.debian.org/doc/manuals/debian-java-faq/">http://www.debian.org/doc/manuals/debian-java-faq/</a>.

<p><a name="Java-Virtual-Machines-on-Unix"></a>

<h3 class="section">D.2 Java Virtual Machines on Unix</h3>

<p>We have much less experience than under Linux, but we do know that Sun's
Run-time Environment <code>j2re</code>&nbsp;1.4.2_03 does not work under Sparc
Solaris 8, whereas <code>jre</code>&nbsp;1.5.0 and <code>j2re</code>&nbsp;1.4.2_01
(available from <a href="http://java.sun.com/products/archive/">http://java.sun.com/products/archive/</a>) do.

<p><a name="Java-Virtual-Machines-on-Windows"></a>

<h3 class="section">D.3 Java Virtual Machines on Windows</h3>

<p>We have not seen any problems on Windows provided a Java Virtual Machine
has been installed and is operational: Sun's current
<code>j2re</code>&nbsp;1.6.0 works in Internet Explorer, Mozilla&nbsp;1.7 and
Mozilla Firefox on Windows XP/Vista.  Note that a recent Windows system
may not have a JVM installed at all.  Visit
<a href="http://java.sun.com/getjava/manual.html">http://java.sun.com/getjava/manual.html</a> to install a Sun JVM. 
Which (if any) JVM is enabled can be set in `Set Program Access and
Defaults' in Windows XP (SP1 or later), and which JVM is used by browser
plugins may also be controlled by the Sun Java applet in the Control
Panel.

   <p>Recent versions of Internet Explorer may block the use of Java applets
and need the block removed <em>via</em> the <em>information bar</em>.  Also,
we have seen cases in which the search results come up as a blank page:
go back one page in the browser history to find the real results page.

   <p>Apple's Safari 3.0.4 also works.

<p><a name="Java-Virtual-Machines-on-Mac-OS-X"></a>

<h3 class="section">D.4 Java Virtual Machines on Mac OS X</h3>

<p>Java 1.5.0 ships with recent versions of Mac OS X, and the <acronym>HTML</acronym>
search engine works with Safari under Mac OS 10.5.

<p><a name="The-Windows-toolset"></a>

<h2 class="appendix">Appendix E The Windows toolset</h2>

<p>If you want to build R or add-on packages from source in Windows, you
will need to collect, install and test an extensive set of tools.  See
<a href="http://www.murdoch-sutherland.com/Rtools/">http://www.murdoch-sutherland.com/Rtools/</a> for the current
locations and other updates to these instructions.  (Most Windows users
will not need to build add-on packages from source; see <a href="#Add_002don-packages">Add-on packages</a> for details.)

   <p>Only building with <samp><span class="command">gcc 4.y.z</span></samp> is supported, and that compiler
set works out-of-the-box on Windows Vista.

   <p>We have found that the build process for R is quite sensitive to
the choice of tools: please follow our instructions <strong>exactly</strong>,
even to the choice of particular versions of the tools.<a rel="footnote" href="#fn-32" name="fnd-32"><sup>32</sup></a>  The build process for add-on packages is somewhat more
forgiving, but we recommend using the exact toolset at first, and only
substituting other tools once you are familiar with the process.

   <p><em>This section contains a lot of prescriptive comments.  They are
here as a result of bitter experience.  Please do not report problems
to R-help unless you have followed all the prescriptions.</em>

   <p>We have collected most of the necessary tools (unfortunately not all,
due to license or size limitations) into an executable installer named
<samp><span class="file">Rtools.exe</span></samp>, available from
<a href="http://www.murdoch-sutherland.com/Rtools/">http://www.murdoch-sutherland.com/Rtools/</a>. You should download
and run it, choosing the default &ldquo;Package authoring installation&rdquo; to
build add-on packages, or the &ldquo;full installation&rdquo; if you intend to
build R.

   <p>You will need the following items to build R and packages. 
See the subsections below for detailed descriptions.
     <ul>
<li>Perl (in <samp><span class="file">Rtools.exe</span></samp>)
<li>The command line tools (in <samp><span class="file">Rtools.exe</span></samp>)
<li>The MinGW compilers (in <samp><span class="file">Rtools.exe</span></samp>)
</ul>
   For building simple packages containing data or R source
but no compiled code, only the first two of these are needed.

   <p>A complete build of R including compiled <acronym>HTML</acronym> help files and
PDF manuals, and producing the standalone installer
<samp><span class="file">R-2.9.1-win32.exe</span></samp> will also need the following:
     <ul>
<li>The Microsoft <acronym>HTML</acronym> Help Workshop
<li>LaTeX
<li>The Inno Setup installer
</ul>

   <p>It is important to set your <samp><span class="env">PATH</span></samp> properly.  The <samp><span class="file">Rtools.exe</span></samp>
optionally sets the path to components that it installs.

   <p>Your <samp><span class="env">PATH</span></samp> may include <samp><span class="file">.</span></samp> first, then the <samp><span class="file">bin</span></samp>
directories of the tools, Perl, MinGW and LaTeX, as well as the Help
Workshop directory.  Do not use filepaths containing spaces: you can
always use the short forms (found by <code>dir /x</code> at the Windows
command line).  Network shares (with paths starting <code>\\</code>) are not
supported.  For example, all on one line,

<pre class="smallexample">     PATH=c:\Rtools\bin;c:\Rtools\perl\bin;c:\Rtools\MinGW\bin;c:\texmf\miktex\bin;
          c:\progra~1\htmhe~1;c:\R\bin;c:\windows;c:\windows\system32
</pre>
   <p>It is essential that the directory containing the command line tools
comes first or second in the path: there are typically like-named
tools in other directories, and they will <strong>not</strong> work.  The
ordering of the other directories is less important, but if in doubt,
use the order above.

   <p>Edit <samp><var>R_HOME</var><span class="file">/src/gnuwin32/MkRules</span></samp> to set the appropriate
paths as needed and to set the type(s) of help that you want built. 
<strong>Beware</strong>: <samp><span class="file">MkRules</span></samp> contains tabs and some editors
(e.g., WinEdt) silently remove them.

   <p>Set the appropriate environment variables.

   <p>Our toolset contains copies of Cygwin DLLs that may conflict with other
ones on your system if both are in the path at once.  The normal
recommendation is to delete the older ones; however, at one time we
found our tools did not work with a newer version of the Cygwin DLLs, so
it may be safest not to have any other version of the Cygwin DLLs in your
path.

<p><a name="Perl"></a>

<h3 class="section">E.1 Perl</h3>

<p>You will need a Windows port of <code>perl5</code> (but only the basic
functionality, not any of the third-party Win32 extensions).  The
Vanilla Perl package is included in <samp><span class="file">Rtools.exe</span></samp>. A more full-
featured distribution is available from
<a href="http://www.activestate.com/Products/ActivePerl/">http://www.activestate.com/Products/ActivePerl/</a>, and this was
used in releases of R up to R 2.5.1.  Alternatives are listed at
<a href="http://win32.perl.org/">http://win32.perl.org/</a>.

   <p><strong>Beware</strong>: you do need a <em>Windows</em> port and not the Cygwin
one.  Users of 64-bit Windows can use a Win64 Perl (such as that from
ActiveState) if they prefer.

<p><a name="The-Microsoft-HTML-Help-Workshop"></a>

<h3 class="section">E.2 The Microsoft <acronym>HTML</acronym> Help Workshop</h3>

<p>To make compiled html (<samp><span class="file">.chm</span></samp>) files you will need the Microsoft
<acronym>HTML</acronym> Help Workshop, currently available for download at
<a href="http://msdn.microsoft.com/library/en-us/htmlhelp/html/hwmicrosofthtmlhelpdownloads.asp">http://msdn.microsoft.com/library/en-us/htmlhelp/html/hwmicrosofthtmlhelpdownloads.asp</a>
and
<a href="http://www.microsoft.com/office/ork/xp/appndx/appa06.htm">http://www.microsoft.com/office/ork/xp/appndx/appa06.htm</a>. 
This is <em>not</em> included in <samp><span class="file">Rtools.exe</span></samp>.

   <p>If this is not installed, <samp><span class="command">Rcmd INSTALL</span></samp> will skip compiled HTML
help (with a message).  However, to build R itself without CHM help,
you need to set <code>USE_CHM = FALSE</code> in <samp><span class="file">src/gnuwin32/MkRules</span></samp>.

<p><a name="LaTeX"></a>

<h3 class="section">E.3 LaTeX</h3>

<p>The &lsquo;<samp><span class="samp">MiKTeX</span></samp>&rsquo; (<a href="http://www.miktex.org/">http://www.miktex.org/</a>) distribution of
LaTeX includes a suitable port of <code>pdftex</code>.  The `basic' version
of &lsquo;<samp><span class="samp">MiKTeX</span></samp>&rsquo; almost suffices (the <strong>grid</strong> vignettes need
<samp><span class="file">fancyvrb.sty</span></samp>), but it will install the 15Mb &lsquo;<samp><span class="samp">lm</span></samp>&rsquo; package if
allowed to (although that is not actually used).  The <samp><span class="file">Rtools.exe</span></samp>
installer does <em>not</em> include any version of LaTeX.

   <p><a name="index-R_005fRD4DVI-95"></a><a name="index-R_005fRD4PDF-96"></a>Please read <a href="#Making-the-manuals">Making the manuals</a> about how to make <samp><span class="file">refman.pdf</span></samp>
and set the environment variables <samp><span class="env">R_RD4DVI</span></samp> and <samp><span class="env">R_RD4PDF</span></samp>
suitably; ensure you have the required fonts installed.

<p><a name="The-Inno-Setup-installer"></a>

<h3 class="section">E.4 The Inno Setup installer</h3>

<p>To make the installer package (<samp><span class="file">R-2.9.1-win32.exe</span></samp>) we
require Inno Setup 5.1.7 or later (including 5.2.x) from
<a href="http://jrsoftware.org/">http://jrsoftware.org/</a>.  This is <em>not</em> included in
<samp><span class="file">Rtools.exe</span></samp>.

   <p>Edit file <samp><span class="file">src/gnuwin32/MkRules</span></samp> and change <code>ISDIR</code> to the
location where Inno Setup was installed.

<p><a name="The-command-line-tools"></a>

<h3 class="section">E.5 The command line tools</h3>

<p>This item and the next are installed by the <samp><span class="file">Rtools.exe</span></samp> installer.

   <p>If you choose to install these yourself, you will need suitable versions
of at least <code>basename</code>, <code>cat</code>, <code>cmp</code>, <code>comm</code>,
<code>cp</code>, <code>cut</code>, <code>diff</code>, <code>echo</code>, <code>egrep</code>,
<code>expr</code>, <code>find</code>, <code>gawk</code>, <code>grep</code>, <code>gzip</code>,
<code>head</code>, <code>ls</code>, <code>make</code>, <code>makeinfo</code>, <code>mkdir</code>,
<code>mv</code>, <code>rm</code>, <code>rsync</code>, <code>sed</code>, <code>sh</code>, <code>sort</code>,
<code>texindex</code> and <code>touch</code>; we use those from the Cygwin
distribution (<a href="http://www.cygwin.com/">http://www.cygwin.com/</a>) or compiled from the
sources.  You will also need <code>zip</code> and <code>unzip</code> from the
Info-ZIP project (<a href="http://www.info-zip.org/">http://www.info-zip.org/</a>).  All of these tools
are in <samp><span class="file">Rtools.exe</span></samp>.

   <p><strong>Beware</strong>: `Native' ports of make are <strong>not</strong> suitable
(including that at the mingw site).  There were also problems with
several earlier versions of the cygwin tools and DLLs.  To avoid
frustration, please use our tool set, and make sure it is at the front
of your path (including before the Windows system directories).  If you
are using a Windows shell, type <code>PATH</code> at the prompt to find out.

<p><a name="The-MinGW-compilers"></a>

<h3 class="section">E.6 The MinGW compilers</h3>

<p>This version of R is set up to use <samp><span class="command">gcc</span></samp> <code>4.2.1</code> for
which MinGW compilers were released in August 2007.  The
<samp><span class="file">Rtools.exe</span></samp> installer currently includes the <code>-sjlj</code> version
of <code>4.2.1</code> of the MinGW port of <samp><span class="command">gcc</span></samp> from
<a href="http://sourceforge.net/project/showfiles.php?group_id=2435">http://sourceforge.net/project/showfiles.php?group_id=2435</a>.

   <p>If you would like to install your own copy, we recommed downloading from
the URL above, as the download links from <a href="http://www.mingw.org/">http://www.mingw.org/</a>
have led to obsolete versions. See the notes on
<a href="http://www.murdoch-sutherland.com/Rtools/">http://www.murdoch-sutherland.com/Rtools/</a> for updates.

<!-- There may be an installer in the `Current' section, which can be used -->
<!-- if it gives the @samp{Candidate} compilers (@code{gcc-3.4.5}).  (If -->
<!-- using this, select the @samp{Candidate} package and add the @code{g++} -->
<!-- and @code{g77} compilers to the @samp{MinGW base tools}: components will -->
<!-- be downloaded from Sourceforge and unpacked.) -->
   <p>To download the components individually, currently you need

<pre class="example">     mingw-runtime-3.13.tar.gz
     w32api-3.10.tar.gz
     binutils-2.17.50-20060824-1.tar.gz
     gcc-core-4.2.1-sjlj-2.tar.gz
     gcc-g++-4.2.1-sjlj-2.tar.gz
     gcc-gfortran-4.2.1-sjlj-2.tar.gz
</pre>
   <p class="noindent">(and <code>gcc-objc-4.2.1-sjlj-2.tar.gz</code> if you want Objective C
support).  Unpack these into the same directory (using <samp><span class="command">tar zxf
tarball_name</span></samp>).  (You may need to copy <samp><span class="file">bin/gcc-sjlj.exe</span></samp> to
<samp><span class="file">bin/gcc.exe</span></samp> and a few badly-written packages need
<samp><span class="file">bin/g++-sjlj.exe</span></samp> copied to <samp><span class="file">bin/g++.exe</span></samp>.)  This compiler
should work on Windows Vista without any workarounds.

   <p>Note that <code>mingw-runtime-3.13.tar.gz</code> or later and <code>gcc-4.2.1</code>
or later are needed to get a correct build of R itself.  (The
`Snapshot' <code>binutils-2.17.50-20070129-1.tar.gz</code> has also be
tested.)  There are known problems with using other compiler sets on
Windows Vista
(<a href="http://www.nabble.com/environment-hosed-during-upgrade-tf3305745.html#a9195667">http://www.nabble.com/environment-hosed-during-upgrade-tf3305745.html#a9195667</a>)
and that a suitable <code>PATH</code> needs to be set to include the path to
<samp><span class="file">cc1</span></samp>.

   <p>Other builds of <samp><span class="command">gcc</span></samp> 4 are available from
<a href="http://gcc.gnu.org/wiki/GFortranBinaries/">http://gcc.gnu.org/wiki/GFortranBinaries/</a> and
<a href="http://www.tdragon.net/recentgcc/">http://www.tdragon.net/recentgcc/</a>: these need the <code>PATH</code>
workaround on Vista.

<p><a name="Function-and-variable-index"></a>

<h2 class="unnumbered">Function and variable index</h2>

<ul class="index-vr" compact>
<li><a href="#index-configure-74"><code>configure</code></a>: <a href="#Using-make">Using make</a></li>
<li><a href="#index-configure-65"><code>configure</code></a>: <a href="#Configuration-variables">Configuration variables</a></li>
<li><a href="#index-configure-19"><code>configure</code></a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-configure-9"><code>configure</code></a>: <a href="#Simple-compilation">Simple compilation</a></li>
<li><a href="#index-install_002epackages-42"><code>install.packages</code></a>: <a href="#Installing-packages">Installing packages</a></li>
<li><a href="#index-make-73"><code>make</code></a>: <a href="#Using-make">Using make</a></li>
<li><a href="#index-R_005fHOME-8"><code>R_HOME</code></a>: <a href="#Simple-compilation">Simple compilation</a></li>
<li><a href="#index-remove_002epackages-45"><code>remove.packages</code></a>: <a href="#Removing-packages">Removing packages</a></li>
<li><a href="#index-update_002epackages-43"><code>update.packages</code></a>: <a href="#Updating-packages">Updating packages</a></li>
   </ul><p><a name="Concept-index"></a>

<h2 class="unnumbered">Concept index</h2>



<ul class="index-cp" compact>
<li><a href="#index-AIX-94">AIX</a>: <a href="#AIX">AIX</a></li>
<li><a href="#index-BLAS-library-89">BLAS library</a>: <a href="#Sparc-Solaris-9-and-earlier">Sparc Solaris 9 and earlier</a></li>
<li><a href="#index-BLAS-library-86">BLAS library</a>: <a href="#Solaris-10-and-Open-Solaris">Solaris 10 and Open Solaris</a></li>
<li><a href="#index-BLAS-library-82">BLAS library</a>: <a href="#Mac-OS-X">Mac OS X</a></li>
<li><a href="#index-BLAS-library-77">BLAS library</a>: <a href="#Using-FORTRAN">Using FORTRAN</a></li>
<li><a href="#index-BLAS-library-60">BLAS library</a>: <a href="#Linear-algebra">Linear algebra</a></li>
<li><a href="#index-FORTRAN-75">FORTRAN</a>: <a href="#Using-FORTRAN">Using FORTRAN</a></li>
<li><a href="#index-Help-pages-11">Help pages</a>: <a href="#Simple-compilation">Simple compilation</a></li>
<li><a href="#index-HP_002dUX-91">HP-UX</a>: <a href="#HP_002dUX">HP-UX</a></li>
<li><a href="#index-Installation-18">Installation</a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-Installing-under-Unix_002dalikes-4">Installing under Unix-alikes</a>: <a href="#Installing-R-under-Unix_002dalikes">Installing R under Unix-alikes</a></li>
<li><a href="#index-Installing-under-Windows-22">Installing under Windows</a>: <a href="#Installing-R-under-Windows">Installing R under Windows</a></li>
<li><a href="#index-Internationalization-48">Internationalization</a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-IRIX-92">IRIX</a>: <a href="#IRIX">IRIX</a></li>
<li><a href="#index-LAPACK-library-90">LAPACK library</a>: <a href="#Sparc-Solaris-9-and-earlier">Sparc Solaris 9 and earlier</a></li>
<li><a href="#index-LAPACK-library-87">LAPACK library</a>: <a href="#Solaris-10-and-Open-Solaris">Solaris 10 and Open Solaris</a></li>
<li><a href="#index-LAPACK-library-83">LAPACK library</a>: <a href="#Mac-OS-X">Mac OS X</a></li>
<li><a href="#index-LAPACK-library-63">LAPACK library</a>: <a href="#LAPACK">LAPACK</a></li>
<li><a href="#index-Libraries-28">Libraries</a>: <a href="#Add_002don-packages">Add-on packages</a></li>
<li><a href="#index-Libraries_002c-managing-32">Libraries, managing</a>: <a href="#Managing-libraries">Managing libraries</a></li>
<li><a href="#index-Libraries_002c-site-33">Libraries, site</a>: <a href="#Managing-libraries">Managing libraries</a></li>
<li><a href="#index-Libraries_002c-user-36">Libraries, user</a>: <a href="#Managing-libraries">Managing libraries</a></li>
<li><a href="#index-Linux-79">Linux</a>: <a href="#Linux">Linux</a></li>
<li><a href="#index-Linux-5">Linux</a>: <a href="#Installing-R-under-Unix_002dalikes">Installing R under Unix-alikes</a></li>
<li><a href="#index-Locale-51">Locale</a>: <a href="#Locales">Locales</a></li>
<li><a href="#index-Locale-50">Locale</a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-Localization-49">Localization</a>: <a href="#Internationalization">Internationalization</a></li>
<li><a href="#index-Mac-OS-X-80">Mac OS X</a>: <a href="#Mac-OS-X">Mac OS X</a></li>
<li><a href="#index-Mac-OS-X-25">Mac OS X</a>: <a href="#Installing-R-under-Mac-OS-X">Installing R under Mac OS X</a></li>
<li><a href="#index-Mac-OS-X-6">Mac OS X</a>: <a href="#Installing-R-under-Unix_002dalikes">Installing R under Unix-alikes</a></li>
<li><a href="#index-Manuals-14">Manuals</a>: <a href="#Making-the-manuals">Making the manuals</a></li>
<li><a href="#index-Manuals_002c-installing-21">Manuals, installing</a>: <a href="#Installation">Installation</a></li>
<li><a href="#index-Obtaining-R-1">Obtaining R</a>: <a href="#Obtaining-R">Obtaining R</a></li>
<li><a href="#index-Packages-27">Packages</a>: <a href="#Add_002don-packages">Add-on packages</a></li>
<li><a href="#index-Packages_002c-default-30">Packages, default</a>: <a href="#Default-packages">Default packages</a></li>
<li><a href="#index-Packages_002c-installing-39">Packages, installing</a>: <a href="#Installing-packages">Installing packages</a></li>
<li><a href="#index-Packages_002c-removing-46">Packages, removing</a>: <a href="#Removing-packages">Removing packages</a></li>
<li><a href="#index-Packages_002c-updating-44">Packages, updating</a>: <a href="#Updating-packages">Updating packages</a></li>
<li><a href="#index-Rbitmap_002edll-23">Rbitmap.dll</a>: <a href="#Building-the-bitmap-files">Building the bitmap files</a></li>
<li><a href="#index-Repositories-47">Repositories</a>: <a href="#Setting-up-a-package-repository">Setting up a package repository</a></li>
<li><a href="#index-Site-libraries-34">Site libraries</a>: <a href="#Managing-libraries">Managing libraries</a></li>
<li><a href="#index-Solaris-84">Solaris</a>: <a href="#Solaris">Solaris</a></li>
<li><a href="#index-Sources-for-R-2">Sources for R</a>: <a href="#Getting-and-unpacking-the-sources">Getting and unpacking the sources</a></li>
<li><a href="#index-Subversion-57">Subversion</a>: <a href="#Essential-programs">Essential programs</a></li>
<li><a href="#index-Subversion-13">Subversion</a>: <a href="#Simple-compilation">Simple compilation</a></li>
<li><a href="#index-Subversion-3">Subversion</a>: <a href="#Using-Subversion-and-rsync">Using Subversion and rsync</a></li>
<li><a href="#index-User-libraries-37">User libraries</a>: <a href="#Managing-libraries">Managing libraries</a></li>
<li><a href="#index-Vignettes-56">Vignettes</a>: <a href="#Essential-programs">Essential programs</a></li>
<li><a href="#index-Vignettes-12">Vignettes</a>: <a href="#Simple-compilation">Simple compilation</a></li>
   </ul><p><a name="Environment-variable-index"></a>

<h2 class="unnumbered">Environment variable index</h2>



<ul class="index-en" compact>
<li><a href="#index-BLAS_005fLIBS-61"><code>BLAS_LIBS</code></a>: <a href="#BLAS">BLAS</a></li>
<li><a href="#index-CONFIG_005fSITE-66"><code>CONFIG_SITE</code></a>: <a href="#Configuration-variables">Configuration variables</a></li>
<li><a href="#index-DISPLAY-81"><code>DISPLAY</code></a>: <a href="#Mac-OS-X">Mac OS X</a></li>
<li><a href="#index-JAVA_005fHOME-58"><code>JAVA_HOME</code></a>: <a href="#Java-support">Java support</a></li>
<li><a href="#index-LANG-55"><code>LANG</code></a>: <a href="#Localization-of-messages">Localization of messages</a></li>
<li><a href="#index-LANGUAGE-52"><code>LANGUAGE</code></a>: <a href="#Localization-of-messages">Localization of messages</a></li>
<li><a href="#index-LAPACK_005fLIBS-64"><code>LAPACK_LIBS</code></a>: <a href="#LAPACK">LAPACK</a></li>
<li><a href="#index-LC_005fALL-53"><code>LC_ALL</code></a>: <a href="#Localization-of-messages">Localization of messages</a></li>
<li><a href="#index-LC_005fMESSAGES-54"><code>LC_MESSAGES</code></a>: <a href="#Localization-of-messages">Localization of messages</a></li>
<li><a href="#index-LD_005fLIBRARY_005fPATH-88"><code>LD_LIBRARY_PATH</code></a>: <a href="#Sparc-Solaris-9-and-earlier">Sparc Solaris 9 and earlier</a></li>
<li><a href="#index-LD_005fLIBRARY_005fPATH-85"><code>LD_LIBRARY_PATH</code></a>: <a href="#Solaris-10-and-Open-Solaris">Solaris 10 and Open Solaris</a></li>
<li><a href="#index-LD_005fLIBRARY_005fPATH-78"><code>LD_LIBRARY_PATH</code></a>: <a href="#Compile-and-load-flags">Compile and load flags</a></li>
<li><a href="#index-LD_005fLIBRARY_005fPATH-76"><code>LD_LIBRARY_PATH</code></a>: <a href="#Using-FORTRAN">Using FORTRAN</a></li>
<li><a href="#index-LD_005fLIBRRARY_005fPATH-62"><code>LD_LIBRRARY_PATH</code></a>: <a href="#ACML">ACML</a></li>
<li><a href="#index-LIBS-93"><code>LIBS</code></a>: <a href="#IRIX">IRIX</a></li>
<li><a href="#index-PAPERSIZE-68"><code>PAPERSIZE</code></a>: <a href="#Setting-paper-size">Setting paper size</a></li>
<li><a href="#index-R_005fBROWSER-69"><code>R_BROWSER</code></a>: <a href="#Setting-the-browser">Setting the browser</a></li>
<li><a href="#index-R_005fDEFAULT_005fPACKAGES-31"><code>R_DEFAULT_PACKAGES</code></a>: <a href="#Default-packages">Default packages</a></li>
<li><a href="#index-R_005fJAVA_005fLD_005fLIBRARY_005fPATH-59"><code>R_JAVA_LD_LIBRARY_PATH</code></a>: <a href="#Java-support">Java support</a></li>
<li><a href="#index-R_005fLIBS-40"><code>R_LIBS</code></a>: <a href="#Installing-packages">Installing packages</a></li>
<li><a href="#index-R_005fLIBS-29"><code>R_LIBS</code></a>: <a href="#Add_002don-packages">Add-on packages</a></li>
<li><a href="#index-R_005fLIBS_005fSITE-35"><code>R_LIBS_SITE</code></a>: <a href="#Managing-libraries">Managing libraries</a></li>
<li><a href="#index-R_005fLIBS_005fUSER-38"><code>R_LIBS_USER</code></a>: <a href="#Managing-libraries">Managing libraries</a></li>
<li><a href="#index-R_005fPAPERSIZE-72"><code>R_PAPERSIZE</code></a>: <a href="#Making-manuals">Making manuals</a></li>
<li><a href="#index-R_005fPAPERSIZE-67"><code>R_PAPERSIZE</code></a>: <a href="#Setting-paper-size">Setting paper size</a></li>
<li><a href="#index-R_005fPAPERSIZE-15"><code>R_PAPERSIZE</code></a>: <a href="#Making-the-manuals">Making the manuals</a></li>
<li><a href="#index-R_005fRD4DVI-95"><code>R_RD4DVI</code></a>: <a href="#LaTeX">LaTeX</a></li>
<li><a href="#index-R_005fRD4DVI-70"><code>R_RD4DVI</code></a>: <a href="#Making-manuals">Making manuals</a></li>
<li><a href="#index-R_005fRD4DVI-16"><code>R_RD4DVI</code></a>: <a href="#Making-the-manuals">Making the manuals</a></li>
<li><a href="#index-R_005fRD4PDF-96"><code>R_RD4PDF</code></a>: <a href="#LaTeX">LaTeX</a></li>
<li><a href="#index-R_005fRD4PDF-71"><code>R_RD4PDF</code></a>: <a href="#Making-manuals">Making manuals</a></li>
<li><a href="#index-R_005fRD4PDF-17"><code>R_RD4PDF</code></a>: <a href="#Making-the-manuals">Making the manuals</a></li>
<li><a href="#index-TMPDIR-41"><code>TMPDIR</code></a>: <a href="#Installing-packages">Installing packages</a></li>
<li><a href="#index-TMPDIR-26"><code>TMPDIR</code></a>: <a href="#Running-R">Running R</a></li>
<li><a href="#index-TMPDIR-24"><code>TMPDIR</code></a>: <a href="#Checking-the-build">Checking the build</a></li>
<li><a href="#index-TMPDIR-7"><code>TMPDIR</code></a>: <a href="#Simple-compilation">Simple compilation</a></li>
   </ul><div class="footnote">
<hr>
<a name="texinfo-footnotes-in-document"></a><h4>Footnotes</h4><p class="footnote"><small>[<a name="fn-1" href="#fnd-1">1</a>]</small> for example, if you configured R with
<samp><span class="option">--without-iconv</span></samp> or <samp><span class="option">--without-recommended</span></samp>.</p>

   <p class="footnote"><small>[<a name="fn-2" href="#fnd-2">2</a>]</small> We do this using the Cygwin compilers, often with some
difficulty.</p>

   <p class="footnote"><small>[<a name="fn-3" href="#fnd-3">3</a>]</small> It makes use of an Apple-supplied modified ICU library, and
is known to work with Mac OS &gt;= 10.4.</p>

   <p class="footnote"><small>[<a name="fn-4" href="#fnd-4">4</a>]</small> unless they were excluded in the build.</p>

   <p class="footnote"><small>[<a name="fn-5" href="#fnd-5">5</a>]</small> its binding is looked once that files has been read, so
users cannot easily change it.</p>

   <p class="footnote"><small>[<a name="fn-6" href="#fnd-6">6</a>]</small> If a proxy needs to be set, see
<samp><span class="command">?download.file</span></samp>.</p>

   <p class="footnote"><small>[<a name="fn-7" href="#fnd-7">7</a>]</small> On some systems setting
<samp><span class="env">LC_ALL</span></samp> or <samp><span class="env">LC_MESSAGES</span></samp> to &lsquo;<samp><span class="samp">C</span></samp>&rsquo; disables <samp><span class="env">LANGUAGE</span></samp>.</p>

   <p class="footnote"><small>[<a name="fn-8" href="#fnd-8">8</a>]</small> If you try changing from French
to Russian except in a UTF-8 locale, you will find messages change to
English.</p>

   <p class="footnote"><small>[<a name="fn-9" href="#fnd-9">9</a>]</small> with
Americanisms.</p>

   <p class="footnote"><small>[<a name="fn-10" href="#fnd-10">10</a>]</small> also known as <acronym>IEC</acronym>&nbsp;559
and <acronym>IEEE</acronym>&nbsp;754</p>

   <p class="footnote"><small>[<a name="fn-11" href="#fnd-11">11</a>]</small> at least when storing quantities: the on-FPU
precision is allowed to vary</p>

   <p class="footnote"><small>[<a name="fn-12" href="#fnd-12">12</a>]</small> until recently this limit applied to all processes, not
just to one process</p>

   <p class="footnote"><small>[<a name="fn-13" href="#fnd-13">13</a>]</small> e.g. Bessel, beta and gamma function</p>

   <p class="footnote"><small>[<a name="fn-14" href="#fnd-14">14</a>]</small> also known as
<acronym>IEEE</acronym>&nbsp;754</p>

   <p class="footnote"><small>[<a name="fn-15" href="#fnd-15">15</a>]</small> <samp><span class="option">-std=c99</span></samp> excludes
POSIX functionality, but <samp><span class="file">config.h</span></samp> will turn on all GNU extensions
to include the POSIX functionality.</p>

   <p class="footnote"><small>[<a name="fn-16" href="#fnd-16">16</a>]</small> We recommend
that people with cairo 1.0.x, install 1.4.x or later from the sources,
which works well</p>

   <p class="footnote"><small>[<a name="fn-17" href="#fnd-17">17</a>]</small> unless
FORTRAN double complex is not supported on the platform</p>

   <p class="footnote"><small>[<a name="fn-18" href="#fnd-18">18</a>]</small> Using the Sun Ceres <samp><span class="command">cc</span></samp> and <samp><span class="command">f95</span></samp>
compilers</p>

   <p class="footnote"><small>[<a name="fn-19" href="#fnd-19">19</a>]</small> We have measured 15&ndash;20% on i686 Linux and around
10% on &lsquo;<samp><span class="samp">x86_64</span></samp>&rsquo; Linux.</p>

   <p class="footnote"><small>[<a name="fn-20" href="#fnd-20">20</a>]</small> You may have to set this with <code>luit</code>, but it
should be the default in a window manager session started in UTF-8.</p>

   <p class="footnote"><small>[<a name="fn-21" href="#fnd-21">21</a>]</small> e.g. Fedora Core 6 and later</p>

   <p class="footnote"><small>[<a name="fn-22" href="#fnd-22">22</a>]</small> On HP-UX <samp><span class="command">fort77</span></samp> is the
<acronym>POSIX</acronym> compliant FORTRAN compiler, and comes after
<samp><span class="command">g77</span></samp>.</p>

   <p class="footnote"><small>[<a name="fn-23" href="#fnd-23">23</a>]</small> as well as its equivalence to the <code>Rcomplex</code>
structure defined in <samp><span class="file">R_ext/Complex.h</span></samp>.</p>

   <p class="footnote"><small>[<a name="fn-24" href="#fnd-24">24</a>]</small> In particular, avoid <samp><span class="command">g77</span></samp>'s
<samp><span class="option">-pedantic</span></samp>, which gives confusing error messages.</p>

   <p class="footnote"><small>[<a name="fn-25" href="#fnd-25">25</a>]</small> e.g., to use an optimized BLAS on
Sun/Sparc</p>

   <p class="footnote"><small>[<a name="fn-26" href="#fnd-26">26</a>]</small> for example, <code>X11 font at size 14 could not
be loaded</code>.</p>

   <p class="footnote"><small>[<a name="fn-27" href="#fnd-27">27</a>]</small> e.g. Fedora Core 5</p>

   <p class="footnote"><small>[<a name="fn-28" href="#fnd-28">28</a>]</small> <a href="http://www.sun.com/download/index.jsp?cat=Application%20Development&amp;tab=3&amp;subcat=Development%20Tools">http://www.sun.com/download/index.jsp?cat=Application%20Development&amp;tab=3&amp;subcat=Development%20Tools</a></p>

   <p class="footnote"><small>[<a name="fn-29" href="#fnd-29">29</a>]</small> including <samp><span class="command">gcc</span></samp> for Sparc
from Sun.</p>

   <p class="footnote"><small>[<a name="fn-30" href="#fnd-30">30</a>]</small> recent
versions have <samp><span class="command">f77</span></samp> as a wrapper for <samp><span class="command">f95</span></samp>, and these do
work.</p>

   <p class="footnote"><small>[<a name="fn-31" href="#fnd-31">31</a>]</small> Windows DLLs need to
have all links resolved at build time and so cannot resolve against
<samp><span class="file">R.bin</span></samp>.</p>

   <p class="footnote"><small>[<a name="fn-32" href="#fnd-32">32</a>]</small> For
example, the Cygwin version of <code>make 3.81</code> fails to work
correctly.</p>

   <hr></div>

</body></html>

<!--

Local Variables:
coding: iso-8859-1
End:

-->
